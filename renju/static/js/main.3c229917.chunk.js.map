{"version":3,"sources":["analysis/bitboard.ts","analysis/symmetry.ts","analysis/encoding.ts","analysis/stats.ts","rule/game/game.ts","database/rif.ts","database/analyzed.ts","database/index.ts","state/common/game.ts","state/common/options.ts","state/common/points.ts","state/common/segments.ts","state/board.ts","state/confirm.ts","state/pager.ts","state/search.ts","state/tabs.ts","components/contexts/advanced.tsx","components/contexts/basic.tsx","components/contexts/preference.tsx","components/contexts/system.tsx","components/Advanced/common/index.tsx","components/Advanced/DetailTab/index.tsx","workers/gomocup.worker.ts","components/Advanced/EngineTab/index.tsx","components/Advanced/common/SearchController.tsx","components/Advanced/SearchTab/Selector.tsx","components/Advanced/SearchTab/index.tsx","components/Advanced/SetupTab/index.tsx","components/Advanced/StatsTab/Stats.tsx","components/Advanced/StatsTab/index.tsx","components/Advanced/index.tsx","components/common/Board/Base.tsx","components/common/Board/common/index.tsx","components/common/Board/Markers.tsx","components/common/Board/Properties.tsx","components/common/Board/Stones.tsx","components/common/Board/Evals.tsx","components/common/Board/index.tsx","components/Basic/Board.tsx","components/Basic/Controller/ConfirmBar.tsx","components/Basic/Controller/EditMenu.tsx","components/Basic/Controller/MainMenu/AboutModal.tsx","components/Basic/Controller/MainMenu/DownloadHidden.tsx","components/Basic/Controller/MainMenu/index.tsx","components/Basic/Controller/Navigator.tsx","components/Basic/Controller/SettingsMenu.tsx","components/Basic/Controller/UndoButton.tsx","components/Basic/Controller/index.tsx","components/Basic/index.tsx","components/theme.ts","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["Bitboard","vlines","Array","BOARD_SIZE","fill","black","x","y","this","blackFirst","moves","move","putMut","result","skip","vline","toString","variants","id","reversed","rotation","pointsVariants","ps","map","v","p","pointVariantRaw","pointVariant","N","toBitboardVariants","movesVariants","ret","emptyBitboardVariants","length","putMovesMut","canonicalBitboard","bvs","minString","b","ss","minI","minS","i","encodeAccumulatedMoves","boardVariants","point","calcStat","records","blackWon","whiteWon","draw","record","all","calcStatByNextMove","query","dataset","slice","groupByNextMove","subRecords","sort","a","queryLength","mapByPointCode","Map","nextMove","headMovesVariants","canonicalVariantId","canonicalNextMove","pointCode","encodeFast","item","get","undefined","set","push","queryVariantId","inversedVariantId","mapByBoardCode","from","entries","code","indices","decodeFast","boardCode","values","c","Game","init","inverted","Object","assign","fields","has","update","findIndex","q","pointEqual","r","filter","separator","wrapPoints","points","parsePoints","CHUNK_SIZE","tableNames","TableName","countries","cities","months","rules","openings","players","tournaments","games","indexedFields","RIFDatabase","DBNAME","version","stores","table","prefixes","limit","where","startsWithAnyOfIgnoreCase","or","sortBy","gameIds","bulkGet","Promise","g","white","publisher","tournament","rule","opening","blacks","whites","publishers","game","bresult","unknownRIFPlayer","btime","wtime","unknownRIFOpening","unknownRIFRule","alt","alts","swap","info","unknownRIFTournament","round","playerId","start","end","between","toArray","orderBy","last","maxGame","ts","t","m","match","yyyy","mm","dd","parseInt","rated","arr","file","progress","text","dom","DOMParser","parseFromString","querySelector","promises","addCountries","children","addCities","addMonths","addOpenings","addRules","addPlayers","addTournaments","addGames","elems","items","getElemWithId","e","name","getAttribute","abbr","transaction","bulkAdd","country","getElementsByTagName","innerHTML","surname","city","year","month","parseFloat","Math","floor","indexedDB","deleteDatabase","Dexie","isNaN","playerShortName","trim","ruleShortName","EXAMPLE_MOVES","MAX_SEARCH_HIT","AnalyzedDatabase","rif","getTournamentsStartDateNumberMap","getTournamentsRatedMap","getMaxGameId","dateMap","ratedMap","maxId","startId","getGamesByIdRange","decode","boardCodes","MIN_ENCODE_MOVES","date","board","player","offset","desc","condition","ids","hit","error","distinct","count","collection","reverse","example","first","console","log","ready","exists","bs","GameState","main","cursor","branch","gameid","size","cache","current","canMove","isBranching","moveBranch","isLast","forward","isReadOnly","moveMain","empty","canUndo","undoBranch","undoMain","canClearRest","cut","toLast","undo","canForward","navigate","isStart","canBackward","invert","isBlackTurn","codes","encode","join","split","find","s","startsWith","replace","gameCode","cursorCode","gidCode","invertedCode","includes","min","OptionsState","targets","on","PointsState","idx","wrapPoint","SegmentsState","segments","segment","valid","l","sx","sy","ex","ey","BoardMode","BoardState","mode","freeBlacks","freeWhites","markerPoints","markerLines","markerPath","pathTurn","evals","canEditMove","canEditFreeStone","canEdit","edit","unstart","makeBoard","wrapBoard","stones","Player","mainGameCode","freeBlacksCode","freeWhitesCode","markerPointsCode","markerLinesCode","ConfirmOption","colorScheme","onClick","ConfirmState","ok","cancel","PagerState","page","pageSize","lastPage","isFirst","SearchQueryState","useMoves","SearchResultState","TabName","TabsState","names","index","indexOf","AdvancedContext","createContext","tabsState","setTabsState","searchQueryState","setSearchQueryState","searchResultState","setSearchResultState","AdvancedContextProvider","useState","value","useEffect","setNames","setCurrent","Provider","BasicContext","boardState","setBoardState","confirmState","setConfirmState","BasicContextProvider","window","location","hash","setBoardStateState","history","replaceState","PreferenceOption","PreferenceContext","preference","setPreference","PreferenceContextProvider","localStorage","getItem","setPreferenceState","setItem","JSON","stringify","parse","System","windowInnerWidth","W","C","P","cx","cy","bx","by","adjust","_","SystemContext","SystemContextProvider","system","useMemo","innerWidth","n","max","WonIcon","won","justify","as","RiCheckboxCircleFill","boxSize","color","RiCloseLine","RiSubtractFill","countriesMap","useContext","variant","setPlayerId","Default","db","setCountriesMap","citiesMap","setCitiesMap","getCountriesMap","getCitiesMap","gid","gameView","setGameView","getGameViews","my","url","fontFamily","pl","width","minWidth","span","style","isNumeric","href","isExternal","Worker_fn","Worker","EngineTab","isAnalyzing","setIsAnalyzing","setResult","setError","autoAnalyze","setAutoAnalyze","lastKeyRef","useRef","mountedRef","lastEvalRef","workerRef","workerReadyRef","convertBoardToWasm","useCallback","forEach","Uint8Array","startAnalysis","w","GomocupWorker","onmessage","ev","msg","data","type","mDepth","exec","mNodes","mVal","pv","matchAll","score","bestFromPv","prev","bestMove","depth","nodes","eval","candidates","resp","response","engineResult","String","message","postMessage","payload","lines","Error","terminate","inv","key","applyMove","setEvals","formatScore","abs","spacing","align","borderWidth","borderRadius","fontSize","fontWeight","mb","isChecked","onChange","target","checked","status","toFixed","bg","fromCharCode","MovesInput","encodedMoves","placeholder","setUseMoves","PlayerInput","rifDB","setValue","setPlayers","popoverDisclosure","useDisclosure","getPlayer","playerName","playerInputRef","initialFocusRef","isOpen","ref","onOpen","keywords","searchPlayers","onClose","disabled","_hover","columns","minChildWidth","PagerController","pager","setPager","aria-label","icon","isDisabled","toFirst","next","GamesTable","setGames","isPreviewMode","hiddenGame","setHiddenGame","colSpan","mgid","pgid","originalGame","previewGame","setGame","setMode","toUpperCase","pageStart","pageEnd","SearchController","py","fileIsInvalid","setFileIsInvalid","parsingProgress","setParsingProgress","analyzingProgress","setAnalyzingProgress","completed","setCompleted","analyzingDisclosure","onLoadFile","elem","document","getElementById","files","reset","loadFromFile","analyzedDB","loadFromRIFDatabase","isInline","isInvalid","isCentered","closeOnOverlayClick","reload","StatsWithMovesAndPlayer","blackGames","whiteGames","blackStat","whiteStat","blackStats","whiteStats","denominator","total","label","lost","stats","isBlackRight","StatsWithMoves","stat","StatsWithPlayer","StatComponent","textAlign","textColor","StatByNextMoveTable","PercentileBar","backgroundColor","overflowWrap","Stats","AdvancedTabs","setIndex","upperFirst","px","SearchTab","StatsTab","DetailTab","SetupTab","charAt","boardMoves","setMoves","search","Base","height","rx","ry","stroke","Rulers","verticalLines","x1","y1","x2","y2","strokeLinecap","strokeWidth","rulerStrokeWidth","horizontalLines","Stars","Indices","xIndices","indexPadding","textAnchor","indexFontSize","pointXToString","yIndices","dominantBaseline","pointYToString","Overlay","opacity","showIndices","showOverlay","colorBase","Stone","stoneStrokeWidth","strokeOpacity","fontColor","orderFontSize","SegmentMarker","strokeDasharray","orthogonal","PointMarker","shape","figure","Circle","fillOpacity","Diamond","transform","Cross","Text","Segments","state","propertyRowStrokeWidth","propertyRowStrokeDasharray","Points","showLabel","markers","markerFontSize","Path","appearance","hide","pathPointColor","isStarter","path","showPointsLabel","pathAppearance","Rows","rows","row","Eyes","emphasized","gs","rects","wrapRow","eyes","Forbiddens","crosses","showRows","showEyes","showForbiddens","board_","RowKind","two","sword","three","four","forbiddens","Moves","showOrders","FreeStones","LastMove","showLastMove","lastMove","Evals","labels","onClickPoint","base","currentTarget","getBoundingClientRect","clientX","clientY","isPreview","Properties","Markers","Stones","Board","justifyContent","alignItems","buttonSize","ModeIcon","RiRadioButtonLine","RiAddCircleFill","RiAddCircleLine","RiEditCircleFill","RiEditLine","autoSelect","placement","closeOnSelect","IconButton","title","ml","invertMoves","gameState","RiContrastFill","confirm","RiDeleteBinFill","FiTwitter","FiGithub","hidden","AdvancedModeAlertDialog","leastDestructiveRef","toast","useToast","useClipboard","onCopy","downloadHiddenId","advancedModeDisclosure","isAdvanced","modeIcon","RiFolderForbidLine","RiFolderChartLine","aboutDisclosure","description","duration","isClosable","RiClipboardLine","svgElem","svgData","XMLSerializer","serializeToString","imageElem","Image","src","btoa","unescape","encodeURIComponent","canvasElem","createElement","baseVal","ctx","getContext","fillStyle","fillRect","onload","drawImage","toDataURL","setAttribute","dispatchEvent","MouseEvent","onDownload","RiDownload2Line","off","mr","RiFlaskFill","RiQuestionLine","DownloadHidden","AboutModal","BranchingMenu","useGameContext","clearBranch","RiDeleteBack2Line","newFromBranch","RiRefreshLine","toStart","backward","boardAndMovesPreferences","visualizationPreferences","defaultValue","change","RiMicrosoftFill","RiGridLine","RiInformationLine","RiFocus2Fill","RiStopMiniFill","RiGitCommitFill","UndoIcon","ClearRestOfMovesMenu","clearRest","ClearMainGameMenu","FiXSquare","canClearRestOfMoves","canClearMainGame","onTouchStart","preventDefault","DefaultBar","MainMenu","EditMenu","Navigator","UndoButton","SettingsMenu","ConfirmBar","Controller","theme","extendTheme","components","Table","parts","sizes","th","lineHeight","td","Main","Basic","Advanced","Boolean","hostname","fetch","then","json","catch","firebase","initializeApp","analytics","ReactDOM","render","navigator","serviceWorker","registration","unregister"],"mappings":"2UAEaA,EAAb,iDACmBC,OAAmB,IAAIC,MAAMC,KAAYC,KAAK,GADjE,0CAGE,SAAOC,EAAP,GAAuC,IAAD,mBAAdC,EAAc,KAAXC,EAAW,KACpCC,KAAKP,OAAOK,KAAOD,EAAQ,EAAO,IAAU,EAAIE,IAJpD,yBAOE,SAAYE,EAAqBC,GAC/B,IAD+C,EAC3CL,EAAQI,EADmC,cAE5BC,GAF4B,IAE/C,2BAA0B,CAAC,IAAhBC,EAAe,QACxBH,KAAKI,OAAOP,EAAOM,GACnBN,GAASA,GAJoC,iCAPnD,sBAeE,WACE,IADiB,EACbQ,EAAS,GACTC,EAAO,EAFM,cAGGN,KAAKP,QAHR,IAGjB,2BAAiC,CAAC,IAAvBc,EAAsB,QACjB,IAAVA,EACFD,KAEa,IAATA,IACFD,GAAUC,EAAKE,SAAS,IAAM,IAC9BF,EAAO,GAETD,GAAUE,EAAMC,SAAS,IAAM,IAC/BF,EAAO,IAZM,8BAejB,OAAOD,MA9BX,KCWaI,EAAqB,CAChC,CAAEC,GAAI,EAAGC,UAAU,EAAOC,SAAU,GACpC,CAAEF,GAAI,EAAGC,UAAU,EAAMC,SAAU,GACnC,CAAEF,GAAI,EAAGC,UAAU,EAAOC,SAAU,IACpC,CAAEF,GAAI,EAAGC,UAAU,EAAMC,SAAU,IACnC,CAAEF,GAAI,EAAGC,UAAU,EAAOC,SAAU,KACpC,CAAEF,GAAI,EAAGC,UAAU,EAAMC,SAAU,KACnC,CAAEF,GAAI,EAAGC,UAAU,EAAOC,SAAU,KACpC,CAAEF,GAAI,EAAGC,UAAU,EAAMC,SAAU,MAkBxBC,EAAiB,SAACC,GAC7B,OAAOL,EAASM,KAAI,SAAAC,GAAC,OACnBF,EAAGC,KAAI,SAAAE,GAAC,OAAIC,EAAgBD,EAAGD,EAAEL,SAAUK,EAAEJ,iBAIpCO,EAAe,SAACF,EAAUD,GACrC,MAA+BP,EAASO,GAAhCL,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,SAClB,OAAOM,EAAgBD,EAAGN,EAAUC,IAGhCM,EAAkB,SAACD,EAAUN,EAAoBC,GACrD,IAAMQ,EAAIzB,IAAa,EACvB,EAAegB,EAAW,CAACM,EAAE,GAAIA,EAAE,IAAMA,EAAzC,mBAAOnB,EAAP,KAAUC,EAAV,KACA,OAAQa,GACN,KAAK,EACH,MAAO,CAACd,EAAGC,GACb,KAAK,GACH,MAAO,CAACA,EAAGqB,EAAItB,GACjB,KAAK,IACH,MAAO,CAACsB,EAAItB,EAAGsB,EAAIrB,GACrB,KAAK,IACH,MAAO,CAACqB,EAAIrB,EAAGD,GACjB,QACE,MAAO,CAACA,EAAGC,KAeJsB,EAAqB,SAACC,GAEjC,IADA,IAAMC,EAAMC,IACHR,EAAI,EAAGA,EAAIM,EAAcG,OAAQT,IACxCO,EAAIP,GAAGU,aAAY,EAAMJ,EAAcN,IAEzC,OAAOO,GAGIC,EAAwB,WACnC,MAAO,CACL,IAAIhC,EACJ,IAAIA,EACJ,IAAIA,EACJ,IAAIA,EACJ,IAAIA,EACJ,IAAIA,EACJ,IAAIA,EACJ,IAAIA,IAIKmC,EAAoB,SAACC,GAChC,IAAMZ,EAAIa,EAAUD,EAAIb,KAAI,SAAAe,GAAC,OAAIA,EAAEtB,eAAa,GAChD,MAAO,CAACQ,EAAGY,EAAIZ,KAOXa,EAAY,SAACE,GAGjB,IAFA,IAAIC,EAAO,EACPC,EAAOF,EAAG,GACLG,EAAI,EAAGA,EAAIH,EAAGN,OAAQS,IACzBH,EAAGG,GAAKD,IACVD,EAAOE,EACPD,EAAOF,EAAGG,IAGd,MAAO,CAACF,EAAMC,IClHHE,EAAyB,SAACjC,GAIrC,IAHA,IDoGsC0B,ECpGhCQ,EAAgBZ,IAChBF,EAAgBT,EAAeX,GAC/BG,EAAmB,GAChB6B,EAAI,EAAGA,EAAIhC,EAAMuB,OAAQS,IAAK,CAErC,IADA,IAAMrC,EAAQqC,EAAI,IAAM,EACflB,EAAI,EAAGA,EAAIM,EAAcG,OAAQT,IAAK,CAC7C,IAAMqB,EAAQf,EAAcN,GAAGkB,GAC/BE,EAAcpB,GAAGZ,OAAOP,EAAOwC,GAEjChC,EAAO6B,ID2F6BN,EC3FAQ,ED4F/BP,EAAUD,EAAIb,KAAI,SAAAe,GAAC,OAAIA,EAAEtB,gBC5FqB,GAErD,OAAOH,G,QCOIiC,EAAW,SAACC,GACvB,IAD4D,EACxDC,EAAW,EACXC,EAAW,EACXC,EAAO,EAHiD,cAIvCH,GAJuC,IAI5D,2BAA8B,CAAC,IAApBI,EAAmB,QACxBA,EAAOH,SACTA,GAAY,EACHG,EAAOF,SAChBA,GAAY,EAEZC,GAAQ,GAVgD,8BAa5D,MAAO,CAAEE,IAAKL,EAAQd,OAAQe,WAAUC,WAAUC,SAGvCG,EAAqB,SAACN,EAAuBO,GACxD,IAAMC,EAAUR,EAAQxB,KAAI,SAAA4B,GAAM,OAAIA,EAAOzC,MAAM8C,MAAM,EAAGF,EAAMrB,OAAS,MAO3E,OANewB,EAAgBH,EAAOC,GACKhC,KAAI,YAAuB,IAAD,mBAApBsB,EAAoB,KAC7Da,EAD6D,KACxCnC,KAAI,SAAAmB,GAAC,OAAIK,EAAQL,MAE5C,MAAO,CAACG,EADKC,EAASY,OAGXC,MAAK,SAACC,EAAGtB,GAAJ,OAAUA,EAAE,GAAGc,IAAMQ,EAAE,GAAGR,QAGxCK,EAAkB,SAACH,EAAgBC,GAGvC,IAFA,IAAMM,EAAcP,EAAMrB,OACpB6B,EAAiB,IAAIC,IAClBrB,EAAI,EAAGA,EAAIa,EAAQtB,OAAQS,IAAK,CACvC,IAAMhC,EAAQ6C,EAAQb,GACtB,KAAIhC,EAAMuB,QAAU4B,GAApB,CACA,MAA8B,CAACnD,EAAM8C,MAAM,EAAGK,GAAcnD,EAAMmD,IAAhDG,EAAlB,KACMC,EAAoB5C,EAD1B,MAEM6C,EAAqB/B,EAAkBN,EAAmBoC,IAAoB,GAC9EE,EAAoBxC,EAAaqC,EAAUE,GAC3CE,EAAYC,EAAWF,GACvBG,EAAOR,EAAeS,IAAIH,QACnBI,IAATF,EACFR,EAAeW,IAAIL,EAAW,CAAC1B,IAE/B4B,EAAKI,KAAKhC,IAOd,IAHA,IAAMiC,EAAiBxC,EAAkBN,EAAmBR,EAAeiC,KAAS,GAC9EsB,EF5CC,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GE4CcD,GACrCE,EAAiB,IAAId,IAC3B,MAA8B7D,MAAM4E,KAAKhB,EAAeiB,WAAxD,eAAoE,CAA/D,IAOI,EAPJ,sBAAOC,EAAP,KAAaC,EAAb,KACGjB,EAAWrC,EAAauD,EAAWF,GAAOJ,GAC1ClE,EAAK,sBAAO4C,GAAP,CAAcU,IACnBmB,EAAYhD,EAAkBN,EAAmBR,EAAeX,KAAS,GAAGM,WAC5EsD,EAAOO,EAAeN,IAAIY,GAChC,QAAaX,IAATF,EACFO,EAAeJ,IAAIU,EAAW,CAACnB,EAAUiB,SAErCZ,EAAWL,GAAYK,EAAWC,EAAK,MAAKA,EAAK,GAAKN,IAC1D,EAAAM,EAAK,IAAGI,KAAR,oBAAgBO,IAIpB,OAAO/E,MAAM4E,KAAKD,EAAeO,WAG7Bf,EAAa,SAAC5C,GAAD,OAAsBA,EAAE,GAAKtB,IAAasB,EAAE,IAEzDyD,EAAa,SAACG,GAAD,MAAsB,IAAIA,EAAIlF,KAAakF,EAAIlF,M,QCvFrDmF,EAAb,WAIE,WAAYC,GAAmC,yBAHtC7E,MAAiB,GAGoB,KAFrC8E,UAAoB,OAGdhB,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GALhD,0CAQE,SAAeI,GACb,OAAO,IAAIL,EAAJ,2BAAc9E,MAASmF,MATlC,kBAYE,SAAKlE,GACH,OAAIjB,KAAKoF,IAAInE,GAAWjB,KACjBA,KAAKqF,OAAO,CACjBnF,MAAM,GAAD,mBAAMF,KAAKE,OAAX,CAAkBe,QAf7B,kBAmBE,WACE,OAA0B,IAAtBjB,KAAKE,MAAMuB,OAAqBzB,KAC7BA,KAAKqF,OAAO,CACjBnF,MAAOF,KAAKE,MAAM8C,MAAM,EAAGhD,KAAKE,MAAMuB,OAAS,OAtBrD,iBA0BE,SAAIR,GACF,OAAOjB,KAAKE,MAAMoF,WAAU,SAAAC,GAAC,OAAIC,YAAWvE,EAAGsE,OAAO,IA3B1D,iBA8BE,SAAI9D,GACF,OAAOzB,KAAKqF,OAAO,CAAEnF,MAAOF,KAAKE,MAAM8C,MAAM,EAAGvB,OA/BpD,oBAkCE,SAAOuD,GACL,OAAOhF,KAAKqF,OAAO,CAAEL,eAnCzB,mBAsCE,WACE,OAAOhF,KAAKE,MAAMuB,OAAS,IAvC/B,kBA0CE,WACE,IAAMgE,EAAIzF,KAAKgF,SAAW,EAAI,EAC9B,OAAOhF,KAAKE,MAAMwF,QAAO,SAACzE,EAAGiB,GAAJ,OAAUA,EAAI,IAAMuD,OA5CjD,kBA+CE,WACE,IAAMA,EAAIzF,KAAKgF,SAAW,EAAI,EAC9B,OAAOhF,KAAKE,MAAMwF,QAAO,SAACzE,EAAGiB,GAAJ,OAAUA,EAAI,IAAMuD,OAjDjD,oBAoDE,WACE,OAAOzF,KAAKE,MAAMF,KAAKE,MAAMuB,OAAS,KArD1C,uBAwDE,WACE,IAAMgE,EAAIzF,KAAKgF,SAAW,EAAI,EAC9B,OAAOhF,KAAKE,MAAMuB,OAAS,IAAMgE,IA1DrC,gBA6DE,WACE,OAAOzF,KAAKE,MAAMuB,SA9DtB,iBAiEE,WACE,OAA6B,IAAtBzB,KAAKE,MAAMuB,SAlEtB,oBAqEE,WAAwC,IAAjCkE,EAAgC,uDAAZ,GACzB,OAAOC,YAAW5F,KAAKE,OAAOM,SAASmF,MAtE3C,qBAyEE,SAAcnB,GACZ,IAAMqB,EAASC,YAAYtB,GAC3B,OAAOqB,GAAU,IAAIf,EAAK,CAAE5E,MAAO2F,QA3EvC,KCCME,EAAa,IAEbC,EAAa,CACjB,YACA,SACA,SACA,QACA,WACA,UACA,cACA,SAGIC,EAA0C,CAC9CC,UAAWF,EAAW,GACtBG,OAAQH,EAAW,GACnBI,OAAQJ,EAAW,GACnBK,MAAOL,EAAW,GAClBM,SAAUN,EAAW,GACrBO,QAASP,EAAW,GACpBQ,YAAaR,EAAW,GACxBS,MAAOT,EAAW,IA+DdU,EAA2C,CAC/CR,UAAW,KACXC,OAAQ,KACRC,OAAQ,KACRC,MAAO,KACPC,SAAU,KACVC,QAAS,0BACTC,YAAa,uBACbC,MAAO,qCAuBIE,EAAb,kDAeE,aAAe,IAAD,8BACZ,cAAMA,EAAYC,SAdHV,eAaH,IAZGC,YAYH,IAXGC,YAWH,IAVGC,WAUH,IATGC,cASH,IARGC,aAQH,IAPGC,iBAOH,IANGC,WAMH,EAEZ,EAAKI,QAAQ,GAAGC,OAAOJ,GACvB,EAAKR,UAAY,EAAKa,MAAMd,EAAUC,WACtC,EAAKC,OAAS,EAAKY,MAAMd,EAAUE,QACnC,EAAKC,OAAS,EAAKW,MAAMd,EAAUG,QACnC,EAAKC,MAAQ,EAAKU,MAAMd,EAAUI,OAClC,EAAKC,SAAW,EAAKS,MAAMd,EAAUK,UACrC,EAAKC,QAAU,EAAKQ,MAAMd,EAAUM,SACpC,EAAKC,YAAc,EAAKO,MAAMd,EAAUO,aACxC,EAAKC,MAAQ,EAAKM,MAAMd,EAAUQ,OAVtB,EAfhB,wFA4BE,WAAoBO,GAApB,2BAAA5D,EAAA,6DAAwC6D,EAAxC,+BAAwD,GAAxD,SACejH,KAAKuG,QACfW,MAAM,WACNC,0BAA0BH,GAC1BI,GAAG,QACHD,0BAA0BH,GAC1BC,MAAMA,GACNI,OAAO,WAPZ,wFA5BF,wHAsCE,WAAmBC,GAAnB,+BAAAlE,EAAA,yDACyB,IAAnBkE,EAAQ7F,OADd,yCACmC,IADnC,uBAEsBzB,KAAKyG,MAAMc,QAAQD,GAFzC,cAEQb,EAFR,gBAG2Ee,QAAQ5E,IAAI,CACnF5C,KAAKuG,QAAQgB,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAG5H,aAAP,QAAgB,MAChDG,KAAKuG,QAAQgB,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGC,aAAP,QAAgB,MAChD1H,KAAKuG,QAAQgB,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGE,iBAAP,QAAoB,MACpD3H,KAAKwG,YAAYe,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGG,kBAAP,QAAqB,MACzD5H,KAAKqG,MAAMkB,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGI,YAAP,QAAe,MAC7C7H,KAAKsG,SAASiB,QAAQd,EAAM1F,KAAI,SAAA0G,GAAC,8BAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAGK,eAAP,QAAkB,QATvD,0CAGSC,EAHT,KAGiBC,EAHjB,KAGyBC,EAHzB,KAGqCzB,EAHrC,KAGkDH,EAHlD,KAGyDC,EAHzD,uBAWSG,EAAM1F,KAAI,SAACmH,EAAMhG,GAAO,IAAD,gCACtBuD,EAAC,iBAAGyC,QAAH,IAAGA,OAAH,EAAGA,EAAMC,eAAT,QAAoB,KACrB3F,EAAiB,IAANiD,GAAuB,IAANA,GAAkB,KAC9ChD,EAAiB,IAANgD,GAAuB,IAANA,GAAkB,KACpD,MAAO,CACL/E,GAAE,iBAAEwH,QAAF,IAAEA,OAAF,EAAEA,EAAMxH,UAAR,QAAc,EAChBb,MAAK,UAAEkI,EAAO7F,UAAT,QAAekG,IACpBV,MAAK,UAAEM,EAAO9F,UAAT,QAAekG,IACpB5F,WACAC,WACAvC,MAAK,UAAE4F,YAAW,iBAACoC,QAAD,IAACA,OAAD,EAACA,EAAM/H,YAAP,QAAe,WAA5B,QAAmC,GACxCkI,MAAK,iBAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAMG,aAAR,QAAiB,EACtBC,MAAK,iBAAEJ,QAAF,IAAEA,OAAF,EAAEA,EAAMI,aAAR,QAAiB,EACtBR,QAAO,UAAExB,EAASpE,UAAX,QAAiBqG,IACxBV,KAAI,UAAExB,EAAMnE,UAAR,QAAcsG,IAClBC,IAAG,iBAAEP,QAAF,IAAEA,OAAF,EAAEA,EAAMO,WAAR,QAAe,GAClBC,KAAM,GACNC,KAAI,iBAAET,QAAF,IAAEA,OAAF,EAAEA,EAAMS,YAAR,QAAgB,GACpBC,KAAI,iBAAEV,QAAF,IAAEA,OAAF,EAAEA,EAAMU,YAAR,QAAgB,GACpBjB,UAAS,UAAEM,EAAW/F,UAAb,QAAmBkG,IAC5BR,WAAU,UAAEpB,EAAYtE,UAAd,QAAoB2G,IAC9BC,MAAK,iBAAEZ,QAAF,IAAEA,OAAF,EAAEA,EAAMY,aAAR,QAAiB,QAhC5B,iDAtCF,qHA2EE,WAAgBC,GAAhB,SAAA3F,EAAA,sEACepD,KAAKuG,QAAQxC,IAAIgF,GADhC,wFA3EF,6HA+EE,WAAwBC,EAAsBC,GAA9C,SAAA7F,EAAA,sEACepD,KAAKyG,MAAMS,MAAM,MAAMgC,QAAQF,EAAOC,GAAKE,UAD1D,wFA/EF,0HAmFE,8BAAA/F,EAAA,sEACwBpD,KAAKyG,MAAM2C,QAAQ,MAAMC,OADjD,cACQC,EADR,0CAESA,QAFT,IAESA,OAFT,EAESA,EAAS5I,UAFlB,QAEwB,GAFxB,gDAnFF,2IAwFE,4CAAA0C,EAAA,sEACmBpD,KAAKwG,YAAY2C,UADpC,OAGE,IAFMI,EADR,OAEQlJ,EAAS,IAAIkD,IACVrB,EAAI,EAAGA,EAAIqH,EAAG9H,OAAQS,IACvBsH,EAAID,EAAGrH,IACPuH,EAAID,EAAER,MAAMU,MAAM,wCAChB,EACiB,CAACD,EAAE,GAAIA,EAAE,GAAIA,EAAE,IAA/BE,EADF,KACQC,EADR,KACYC,EADZ,KAELxJ,EAAO4D,IAAIuF,EAAE9I,GAAIoJ,SAASH,EAAOC,EAAKC,KAEtCxJ,EAAO4D,IAAIuF,EAAE9I,GAAI,GAVvB,yBAaSL,GAbT,gDAxFF,iIAwGE,kCAAA+C,EAAA,sEACmBpD,KAAKwG,YAAY2C,UADpC,OAGE,IAFMI,EADR,OAEQlJ,EAAS,IAAIkD,IACVrB,EAAI,EAAGA,EAAIqH,EAAG9H,OAAQS,IACvBsH,EAAID,EAAGrH,GACb7B,EAAO4D,IAAIuF,EAAE9I,GAAI8I,EAAEO,OALvB,yBAOS1J,GAPT,gDAxGF,0HAkHE,kCAAA+C,EAAA,sEACoBpD,KAAKkG,UAAUiD,UADnC,OAGE,IAFMa,EADR,OAEQ3J,EAAS,IAAIkD,IACVrB,EAAI,EAAGA,EAAI8H,EAAIvI,OAAQS,IACxBpC,EAAIkK,EAAI9H,GACd7B,EAAO4D,IAAInE,EAAEY,GAAIZ,GALrB,yBAOSO,GAPT,gDAlHF,uHA4HE,kCAAA+C,EAAA,sEACoBpD,KAAKmG,OAAOgD,UADhC,OAGE,IAFMa,EADR,OAEQ3J,EAAS,IAAIkD,IACVrB,EAAI,EAAGA,EAAI8H,EAAIvI,OAAQS,IACxBpC,EAAIkK,EAAI9H,GACd7B,EAAO4D,IAAInE,EAAEY,GAAIZ,GALrB,yBAOSO,GAPT,gDA5HF,uHAsIE,WAAmB4J,GAAnB,iDAAA7G,EAAA,6DAA+B8G,EAA/B,+BAAwE,aAAxE,SACqBD,EAAKE,OAD1B,cACQA,EADR,OAEQC,GAAM,IAAIC,WAAYC,gBAAgBH,EAAM,mBAE5CjE,EAAYkE,EAAIG,cAActE,EAAUC,WACxCsE,EAAW,GACC,OAAdtE,GACFsE,EAAStG,KAAKlE,KAAKyK,aAAavE,EAAUwE,WAG7B,QADTvE,EAASiE,EAAIG,cAActE,EAAUE,UAEzCqE,EAAStG,KAAKlE,KAAK2K,UAAUxE,EAAOuE,WAGvB,QADTtE,EAASgE,EAAIG,cAActE,EAAUG,UAEzCoE,EAAStG,KAAKlE,KAAK4K,UAAUxE,EAAOsE,WAGrB,QADXpE,EAAW8D,EAAIG,cAActE,EAAUK,YAE3CkE,EAAStG,KAAKlE,KAAK6K,YAAYvE,EAASoE,WAG5B,QADRrE,EAAQ+D,EAAIG,cAActE,EAAUI,SAExCmE,EAAStG,KAAKlE,KAAK8K,SAASzE,EAAMqE,WAGpB,QADVnE,EAAU6D,EAAIG,cAActE,EAAUM,WAE1CiE,EAAStG,KAAKlE,KAAK+K,WAAWxE,EAAQmE,WAGpB,QADdlE,EAAc4D,EAAIG,cAActE,EAAUO,eAE9CgE,EAAStG,KAAKlE,KAAKgL,eAAexE,EAAYkE,WAGlC,QADRjE,EAAQ2D,EAAIG,cAActE,EAAUQ,SAExC+D,EAAStG,KAAKlE,KAAKiL,SAASxE,EAAMiE,SAAUR,IAnChD,UAqCQ1C,QAAQ5E,IAAI4H,GArCpB,iDAtIF,wHA8KE,WAA2BU,GAA3B,8FACQC,EAAsB,GACnBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChCC,KAAI,UAAEH,EAAEE,aAAa,eAAjB,QAA4B,KARtC,OAEoCrJ,IAFpC,wCAWQlC,KAAKyL,YAAY,KAAMzL,KAAKkG,UAA5B,sBAAuC,sBAAA9C,EAAA,sEACrC,EAAK8C,UAAUwF,QAAQP,GADc,4CAX/C,iDA9KF,qHA8LE,WAAwBD,GAAxB,8FACQC,EAAmB,GAChBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChCI,QAAS7B,SAAQ,UAACuB,EAAEE,aAAa,kBAAhB,QAA8B,MARrD,OAEoCrJ,IAFpC,wCAWQlC,KAAKyL,YAAY,KAAMzL,KAAKmG,OAA5B,sBAAoC,sBAAA/C,EAAA,sEAClC,EAAK+C,OAAOuF,QAAQP,GADc,4CAX5C,iDA9LF,qHA8ME,WAAwBD,GAAxB,4FACQC,EAAoB,GACjBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,KAPtC,OAEoCrJ,IAFpC,wCAUQlC,KAAKyL,YAAY,KAAMzL,KAAKoG,OAA5B,sBAAoC,sBAAAhD,EAAA,sEAClC,EAAKgD,OAAOsF,QAAQP,GADc,4CAV5C,iDA9MF,oHA6NE,WAAuBD,GAAvB,gGACQC,EAAmB,GAChBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChC3C,KAAI,oBAAEyC,EAAEO,qBAAqB,QAAQ9H,KAAK,UAAtC,aAAE,EAAwC+H,iBAA1C,QAAuD,KARjE,OAEoC3J,IAFpC,wCAWQlC,KAAKyL,YAAY,KAAMzL,KAAKqG,MAA5B,sBAAmC,sBAAAjD,EAAA,sEACjC,EAAKiD,MAAMqF,QAAQP,GADc,4CAX3C,iDA7NF,uHA6OE,WAA0BD,GAA1B,8FACQC,EAAsB,GACnBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChCC,KAAI,UAAEH,EAAEE,aAAa,eAAjB,QAA4B,KARtC,OAEoCrJ,IAFpC,wCAWQlC,KAAKyL,YAAY,KAAMzL,KAAKsG,SAA5B,sBAAsC,sBAAAlD,EAAA,sEACpC,EAAKkD,SAASoF,QAAQP,GADc,4CAX9C,iDA7OF,sHA6PE,WAAyBD,GAAzB,kGACQC,EAAqB,GAClBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChCO,QAAO,UAAET,EAAEE,aAAa,kBAAjB,QAA+B,GACtCI,QAAS7B,SAAQ,UAACuB,EAAEE,aAAa,kBAAhB,QAA8B,IAC/CQ,KAAMjC,SAAQ,UAACuB,EAAEE,aAAa,eAAhB,QAA2B,MAV/C,OAEoCrJ,IAFpC,wCAaQlC,KAAKyL,YAAY,KAAMzL,KAAKuG,QAA5B,sBAAqC,sBAAAnD,EAAA,sEACnC,EAAKmD,QAAQmF,QAAQP,GADc,4CAb7C,iDA7PF,0HA+QE,WAA6BD,GAA7B,4GACQC,EAAyB,GACtBjJ,EAAI,EAFf,YAEkBA,EAAIgJ,EAAMzJ,QAF5B,gCAGoB2J,EAAcF,EAAOhJ,UAHzC,QAG+C,GAH/C,mBAGWmJ,EAHX,KAGc3K,EAHd,KAIS2K,GAAM3K,EAJf,qDAKIyK,EAAMjH,KAAK,CACTxD,GAAIA,EACJ4K,KAAI,UAAED,EAAEE,aAAa,eAAjB,QAA4B,GAChCI,QAAS7B,SAAQ,UAACuB,EAAEE,aAAa,kBAAhB,QAA8B,IAC/CQ,KAAMjC,SAAQ,UAACuB,EAAEE,aAAa,eAAhB,QAA2B,IACzCS,KAAMlC,SAAQ,UAACuB,EAAEE,aAAa,eAAhB,QAA2B,IACzCU,MAAOnC,SAAQ,UAACuB,EAAEE,aAAa,gBAAhB,QAA4B,IAC3CvC,MAAK,UAAEqC,EAAEE,aAAa,gBAAjB,QAA6B,GAClCtC,IAAG,UAAEoC,EAAEE,aAAa,cAAjB,QAA2B,GAC9B1D,KAAMiC,SAAQ,UAACuB,EAAEE,aAAa,eAAhB,QAA2B,IACzCxB,MAA2C,OAApC,UAACsB,EAAEE,aAAa,gBAAhB,QAA4B,MAfzC,OAEoCrJ,IAFpC,wCAkBQlC,KAAKyL,YAAY,KAAMzL,KAAKwG,YAA5B,sBAAyC,sBAAApD,EAAA,sEACvC,EAAKoD,YAAYkF,QAAQP,GADc,4CAlBjD,iDA/QF,oHAsSE,WAAuBD,GAAvB,8FAA8ChB,EAA9C,+BAAuF,aAAvF,uBACWrF,GADX,mHAEUsG,EAAmB,GAChBjJ,EAAI,EAHjB,YAGoBA,EAAI6D,GAHxB,gCAIsBqF,EAAcF,EAAOrG,EAAI3C,UAJ/C,QAIqD,GAJrD,mBAIamJ,EAJb,KAIgB3K,EAJhB,KAKW2K,GAAM3K,EALjB,qDAMMyK,EAAMjJ,GAAK,CACTxB,GAAIA,EACJiH,UAAWmC,SAAQ,UAACuB,EAAEE,aAAa,oBAAhB,QAAgC,IACnD3D,WAAYkC,SAAQ,UAACuB,EAAEE,aAAa,qBAAhB,QAAiC,IACrDzC,MAAK,UAAEuC,EAAEE,aAAa,gBAAjB,QAA6B,GAClC1D,KAAMiC,SAAQ,UAACuB,EAAEE,aAAa,eAAhB,QAA2B,IACzC1L,MAAOiK,SAAQ,UAACuB,EAAEE,aAAa,gBAAhB,QAA4B,IAC3C7D,MAAOoC,SAAQ,UAACuB,EAAEE,aAAa,gBAAhB,QAA4B,IAC3CpD,QAAS+D,WAAU,UAACb,EAAEE,aAAa,kBAAhB,QAA8B,IACjDlD,MAAOyB,SAAQ,UAACuB,EAAEE,aAAa,gBAAhB,QAA4B,IAC3CjD,MAAOwB,SAAQ,UAACuB,EAAEE,aAAa,gBAAhB,QAA4B,IAC3CzD,QAASgC,SAAQ,UAACuB,EAAEE,aAAa,kBAAhB,QAA8B,IAC/C9C,IAAG,UAAE4C,EAAEE,aAAa,cAAjB,QAA2B,GAC9B5C,KAAI,UAAE0C,EAAEE,aAAa,eAAjB,QAA4B,GAChCpL,KAAI,oBAAEkL,EAAEO,qBAAqB,QAAQ9H,KAAK,UAAtC,aAAE,EAAwC+H,iBAA1C,QAAuD,GAC3DjD,KAAI,oBAAEyC,EAAEO,qBAAqB,QAAQ9H,KAAK,UAAtC,aAAE,EAAwC+H,iBAA1C,QAAuD,IArBnE,OAGoC3J,IAHpC,wCAwBU,EAAKuJ,YAAY,KAAM,EAAKhF,MAA5B,sBAAmC,sBAAArD,EAAA,sEACjC,EAAKqD,MAAMiF,QAAQP,GADc,4CAxB7C,QA2BIjB,EAASiC,KAAKC,MAA0B,KAAlBvH,EAAIkB,GAAqBmF,EAAMzJ,SA3BzD,2CACWoD,EAAI,EADf,YACkBA,EAAIqG,EAAMzJ,QAD5B,yCACWoD,GADX,eACoCA,GAAKkB,EADzC,sBA6BEmE,EAAS,KA7BX,2CAtSF,4EAWE,WACEmC,UAAUC,eAAe3F,EAAYC,YAZzC,GAAiC2F,KAApB5F,EACKC,OAAS,MAsU3B,IAAMwE,EAAgB,SAACF,EAAuBhJ,GAC5C,IAAMmJ,EAAIH,EAAMpH,KAAK5B,GACrB,GAAKmJ,EAAL,CACA,IAAM3K,EAAKoJ,SAASuB,EAAE3K,IACtB,IAAI8L,MAAM9L,GACV,MAAO,CAAC2K,EAAG3K,KAGP0H,EAAmB,iBAAkB,CACzC1H,GAAI,EACJ4K,KAAM,GACNQ,QAAS,GACTH,QAAS,EACTI,KAAM,IAGFxD,EAAoB,iBAAmB,CAC3C7H,GAAI,EACJ4K,KAAM,GACNE,KAAM,KAGFhD,EAAiB,iBAAgB,CACrC9H,GAAI,EACJ4K,KAAM,GACN1C,KAAM,KAGFC,EAAuB,iBAAsB,CACjDnI,GAAI,EACJ4K,KAAM,GACNK,QAAS,EACTI,KAAM,EACNC,KAAM,EACNC,MAAO,EACPjD,MAAO,GACPC,IAAK,GACLpB,KAAM,EACNkC,OAAO,IAGI0C,EAAkB,SAACxL,GAAD,gCAC1BA,EAAEqK,KAAKoB,OAAO,UADY,QACN,IADM,aACEzL,EAAE6K,QAAQY,SAE9BC,EAAgB,SAACrB,GAC5B,GAAa,QAATA,EACF,MAAO,MAET,IACO,EAIA,EAIA,EATH7B,EAAI6B,EAAK5B,MAAM,uBACnB,OAAID,EACI,KAAN,iBAAYA,EAAE,UAAd,QAAoB,KAEtBA,EAAI6B,EAAK5B,MAAM,0BAEP,KAAN,iBAAYD,EAAE,UAAd,QAAoB,KAEtBA,EAAI6B,EAAK5B,MAAM,yBAEP,KAAN,iBAAYD,EAAE,UAAd,QAAoB,KAEtBA,EAAI6B,EAAK5B,MAAM,gBAEN,MAETD,EAAI6B,EAAK5B,MAAM,iBAEN,MAETD,EAAI6B,EAAK5B,MAAM,aAEN,MAETD,EAAI6B,EAAK5B,MAAM,cAEN,KAEF,SClgBHkD,EAAyB,CAC7B,CAAC,EAAG,GACJ,CAAC,EAAG,GACJ,CAAC,EAAG,IAGA7G,EAAa,IAIb8G,GAAiB,IAIjB5G,GAA0C,CAC9CQ,MAHkB,SAcdC,GAA2C,CAC/CD,MAAO,0BAsBIqG,GAAb,kDAQE,aAAe,IAAD,8BACZ,cAAMA,EAAiBlG,SAPRH,WAMH,EAEZ,EAAKI,QA5DO,GA4DUC,OAAOJ,IAC7B,EAAKD,MAAQ,EAAKM,MAAMd,GAAUQ,OAHtB,EARhB,8FAcE,0DAAArD,EAAA,6DAA0B8G,EAA1B,+BAAmE,aAC3D6C,EAAM,IAAIpG,EADlB,SAE2Ca,QAAQ5E,IAAI,CACnDmK,EAAIC,mCACJD,EAAIE,yBACJF,EAAIG,iBALR,mCAESC,EAFT,KAEkBC,EAFlB,KAE4BC,EAF5B,KAOEnD,EAAS,GACAoD,EAAU,EARrB,aAQwBA,GAAWD,GARnC,kCASwBN,EAAIQ,kBAAkBD,EAASA,EAAUvH,GATjE,eASUoF,EATV,OAUU1E,EAAQ0E,EAAMpK,KAAI,SAAA+C,GAAS,IAAD,MACxBoE,EAAI,UAAGpD,EAAK0I,OAAO1J,EAAK3D,aAApB,QAA6B,IAAI2E,EAAK,IAC1C2I,EAAatL,EAAuB+F,EAAKhI,MAAM8C,MAAM,EAlE1C,KAkEgEA,MAC/E0K,GAEF,MAAO,CACLhN,GAAIoD,EAAKpD,GACTiN,KAAI,UAAER,EAAQpJ,IAAID,EAAK8D,mBAAnB,QAAkC,EACtCgG,MAAOH,EACPI,OAAQ,CAAC/J,EAAKjE,MAAOiE,EAAK4D,OAC1BqC,MAAK,UAAEqD,EAASrJ,IAAID,EAAK8D,mBAApB,aApBb,UAuBU5H,KAAKyG,MAAMiF,QAAQjF,GAvB7B,QAwBIyD,EAASiC,KAAKC,MAAgC,KAAxBkB,EAAUvH,GAAqBsH,IAxBzD,QAQ0CC,GAAWvH,EARrD,wBA0BEmE,EAAS,KA1BX,iDAdF,iHA2CE,qDAAA9G,EAAA,yDACElD,EADF,EACEA,MACA6I,EAFF,EAEEA,SAFF,IAGE9B,aAHF,MAGU4F,GAHV,MAIEiB,cAJF,MAIW,EAJX,MAKEC,YALF,SAOQC,EAA6B,QACrBhK,IAAV9D,EARN,qBASQA,EAAMuB,OA7FS,GAoFvB,yCAUa,CACLwM,IAAK,GACLC,IAAK,EACLC,MAAM,4BAAD,OAA8BjO,EAAMuB,OAApC,cAjGU,EAiGV,OAbb,YAgBQvB,EAAMuB,OAnGS,IAmFvB,yCAiBa,CACLwM,IAAK,GACLC,IAAK,EACLC,MAAM,6BAAD,OAA+BjO,EAAMuB,OAArC,cAvGU,GAuGV,OApBb,OAuBUkD,EAAYxC,EAAuBjC,GAAOA,EAAMuB,OAAS,GAC/DuM,EAAUJ,MAAQjJ,EAxBtB,eA2BmBX,IAAb+E,IACFiF,EAAUH,OAAS9E,QAGI/E,IAArBgK,EAAUH,aAA4C7J,IAApBgK,EAAUJ,MA/BlD,0CAgCW,CACLK,IAAK,GACLC,IAAK,EACLC,MAAO,4BAnCb,yBAuCoBnO,KAAKyG,MAAMS,MAAM8G,GAAWI,WAAWC,QAvC3D,cAuCQH,EAvCR,SAwCa,GAxCb,0CAyCW,CACLD,IAAK,GACLC,MACAC,MAAO,kBA5Cb,aA+CMD,EAAMrB,IA/CZ,0CAgDW,CACLoB,IAAK,GACLC,MACAC,MAAM,mBAAD,OAAqBD,EAArB,cAA8BrB,GAA9B,OAnDX,eAuDMyB,EAAatO,KAAKyG,MAAMS,MAAM8G,GAAWI,WACzCL,IAAMO,EAAaA,EAAWC,WAxDpC,UAyDqBD,EAAWjH,OAAO,QAzDvC,eAyDQ4G,EAzDR,OAyDgDjL,MAAM8K,EAAQA,EAAS7G,GAAOlG,KAAI,SAAA0G,GAAC,OAAIA,EAAE/G,MAzDzF,kBA0DS,CAAEuN,MAAKC,QA1DhB,iDA3CF,iHAwGE,4BAAA9K,EAAA,sEAEUoL,EAAUrM,EAAuByK,GAAeA,EAAcnL,OAAS,GAFjF,SAGkBzB,KAAKyG,MAAMS,MAAM,CAAE0G,MAAOY,IAAWC,QAHvD,oCAGoEzK,EAHpE,sEAKI0K,QAAQC,IAAR,MALJ,mBAMW,GANX,yDAxGF,2EAIE,WACEtC,UAAUC,eAAeQ,EAAiBlG,YAL9C,GAAsC2F,KAAzBO,GACKlG,OAAS,WClDpB,IAAMgI,GAAK,uCAAG,4BAAAxL,EAAA,sEACFoE,QAAQ5E,IAAI,CAC3B2J,IAAMsC,OAAOlI,EAAYC,QACzB2F,IAAMsC,OAAO/B,GAAiBlG,UAHb,cACbkI,EADa,yBAKZA,EAAG,IAAMA,EAAG,IALA,2CAAH,qDCJLC,GAAb,WAME,WAAYhK,GAAwC,yBAL3CiK,KAAa,IAAIlK,EAKyB,KAJ1CmK,OAAiB,EAIyB,KAH1CC,OAAkB,GAGwB,KAF1CC,YAE0C,OACpCnL,IAATe,IACFE,OAAOC,OAAOlF,KAAM+E,GACd,WAAYA,IAAO/E,KAAKiP,OAASjP,KAAKgP,KAAKI,OATvD,0CAaE,SAAejK,GACb,OAAO,IAAI4J,EAAJ,uCAAmB/O,MAASmF,GAA5B,IAAoCkK,WAAOrL,OAdtD,qBAiBE,SAAQ/C,GACN,OAAQjB,KAAKsP,QAAQlK,IAAInE,KAlB7B,kBAqBE,SAAKA,GACH,OAAKjB,KAAKuP,QAAQtO,GACdjB,KAAKwP,YACAxP,KAAKyP,WAAWxO,IACbjB,KAAK0P,QAAUlK,YAAWvE,EAAGjB,KAAKgP,KAAK9O,MAAMF,KAAKiP,SACrDjP,KAAK2P,WACF3P,KAAK0P,QAAU1P,KAAK4P,WACvB5P,KAAKyP,WAAWxO,GAEhBjB,KAAK6P,SAAS5O,GARMjB,OAtBjC,mBAkCE,WACE,OAAOA,KAAKwP,cAAiBxP,KAAK4P,YAAc5P,KAAK0P,SAAW1P,KAAKgP,KAAKc,QAnC9E,kBAsCE,WACE,OAAK9P,KAAK+P,QACN/P,KAAKwP,YACAxP,KAAKgQ,aAELhQ,KAAKiQ,WAJYjQ,OAvC9B,wBA+CE,WACE,OAAQA,KAAKwP,cAAgBxP,KAAK4P,aAAe5P,KAAK0P,SAhD1D,uBAmDE,WACE,OAAK1P,KAAKkQ,aACHlQ,KAAKqF,OAAO,CAAE2J,KAAMhP,KAAKgP,KAAKmB,IAAInQ,KAAKiP,UAAWmB,SAD1BpQ,OApDnC,sBA0DE,SAAiBiB,GACf,OAAOjB,KAAKqF,OAAO,CAAE2J,KAAMhP,KAAKgP,KAAK7O,KAAKc,KAAMmP,WA3DpD,sBA8DE,WACE,OAAOpQ,KAAKqF,OAAO,CAAE2J,KAAMhP,KAAKgP,KAAKqB,SAAUD,WA/DnD,mBAoEE,WACE,OAAuB,IAAhBpQ,KAAKiP,SArEhB,kBAwEE,WACE,OAAOjP,KAAKiP,SAAWjP,KAAKgP,KAAKI,OAzErC,sBA4EE,WACE,OAAQpP,KAAKwP,cAAgBxP,KAAK0P,SA7EtC,qBAgFE,WACE,OAAK1P,KAAKsQ,WACHtQ,KAAKuQ,SAASvQ,KAAKiP,OAAS,GADNjP,OAjFjC,oBAqFE,WACE,OAAKA,KAAKsQ,WACHtQ,KAAKuQ,SAASvQ,KAAKgP,KAAKI,MADFpP,OAtFjC,uBA0FE,WACE,OAAQA,KAAKwP,cAAgBxP,KAAKwQ,UA3FtC,sBA8FE,WACE,OAAKxQ,KAAKyQ,YACHzQ,KAAKuQ,SAASvQ,KAAKiP,OAAS,GADLjP,OA/FlC,qBAmGE,WACE,OAAKA,KAAKyQ,YACHzQ,KAAKuQ,SAAS,GADSvQ,OApGlC,sBAwGE,SAAiBkC,GACf,OAAIA,EAAI,GAAKlC,KAAKgP,KAAKI,KAAOlN,EAAUlC,KACjCA,KAAKqF,OAAO,CAAE4J,OAAQ/M,MA1GjC,uBA+GE,WACE,OAAOlC,KAAKkP,OAAOzN,OAAS,IAhHhC,wBAmHE,SAAmBR,GACjB,OAAOjB,KAAKqF,OAAO,CAAE6J,OAAO,GAAD,mBAAMlP,KAAKkP,QAAX,CAAmBjO,QApHlD,wBAuHE,WACE,OAAOjB,KAAKqF,OAAO,CAAE6J,OAAQlP,KAAKkP,OAAOlM,MAAM,EAAGhD,KAAKkP,OAAOzN,OAAS,OAxH3E,yBA2HE,WACE,OAAOzB,KAAKqF,OAAO,CAAE6J,OAAQ,OA5HjC,2BA+HE,WACE,OAAO,IAAIH,EAAU,CAAEC,KAAMhP,KAAKsP,QAASL,OAAQjP,KAAKsP,QAAQF,SAhIpE,yBAmIE,SAAYpK,GACV,OAAOhF,KAAKqF,OAAO,CACjB2J,KAAMhP,KAAKgP,KAAK0B,OAAO1L,GACvBmK,YAAQnL,MAtId,mBA4IE,WACE,OAAO,IAAIc,EAAK,CACd5E,MAAM,GAAD,mBAAMF,KAAKgP,KAAKmB,IAAInQ,KAAKiP,QAAQ/O,OAAjC,YAA2CF,KAAKkP,SACrDlK,SAAUhF,KAAKgP,KAAKhK,aA/I1B,kBAmJE,WACE,OAAOhF,KAAKsP,QAAQvH,SApJxB,kBAuJE,WACE,OAAO/H,KAAKsP,QAAQtH,SAxJxB,uBA2JE,WACE,OAAOhI,KAAKsP,QAAQqB,cA5JxB,sBA+JE,WACE,YAAuB3M,IAAhBhE,KAAKmP,SAhKhB,oBAmKE,WACE,IAAMyB,EAAkB,GAKxB,YAJoB5M,IAAhBhE,KAAKmP,QAAsByB,EAAM1M,KAAN,cAAkBlE,KAAKmP,SACjDnP,KAAKgP,KAAKc,OAAOc,EAAM1M,KAAN,YAAgBlE,KAAKgP,KAAK6B,WAC5C7Q,KAAKgP,KAAKhK,UAAU4L,EAAM1M,KAAN,OACJ,IAAhBlE,KAAKiP,QAAc2B,EAAM1M,KAAN,YAAgBlE,KAAKiP,SACrC2B,EAAME,KAAK,QAzKtB,qBA4KE,SAActM,GAAsC,IAAD,EAC3CoM,EAAQpM,EAAKuM,MAAM,KACnBC,EAAO,SAACC,GAAD,mCAAeL,EAAMI,MAAK,SAAAnM,GAAC,OAAIA,EAAEqM,WAAWD,aAA5C,aAAe,EAAkCE,QAAQF,EAAG,WAA5D,QAAmE,IAC1EG,EAAWJ,EAAK,MAChBK,EAAaL,EAAK,MAClBM,EAAUN,EAAK,QACfO,EAAeP,EAAK,MACpBhC,GAAO,UAAClK,EAAK0I,OAAO4D,UAAb,QAA0B,IAAItM,GAAQ4L,OAAOa,EAAaC,SAAS,MAGhF,OAAO,IAAIzC,EAAU,CAAEC,OAAMC,OAFd9C,KAAKsF,IAAIzC,EAAKI,KAAMtF,SAASuH,IAAe,GAEtBlC,OADtBrF,SAASwH,SAAYtN,QArLxC,KCHa0N,GAAb,WAGE,WAAY3M,GAAqC,yBAFxChE,IAAmC,GAGtCgE,IAAM/E,KAAKe,IAAMgE,GAJzB,uCAOE,SAAI/D,GACF,QAAShB,KAAKe,IAAIC,KARtB,gBAWE,SAAG4D,GACD,IAD+B,EACzB7D,EAAmC,GADV,cAEf6D,GAFe,IAE/B,4BAAwB7D,EAAxB,UAAiC,GAFF,8BAG/B,OAAO,IAAI2Q,EAAJ,2BAAyB1R,KAAKe,KAAQA,MAdjD,iBAiBE,SAAI6D,GACF,IADgC,EAC1B7D,EAAmC,GADT,cAEhB6D,GAFgB,IAEhC,4BAAwB7D,EAAxB,UAAiC,GAFD,8BAGhC,OAAO,IAAI2Q,EAAJ,2BAAyB1R,KAAKe,KAAQA,MApBjD,oBAuBE,SAAO4Q,EAAcC,GACnB,IAD6C,EACvC7Q,EAAmC,GADI,cAE7B4Q,GAF6B,IAE7C,2BAAyB,CAAC,IAAf3Q,EAAc,QACvBD,EAAIC,GAAK4Q,EAAGJ,SAASxQ,IAHsB,8BAK7C,OAAO,IAAI0Q,EAAJ,2BAAyB1R,KAAKe,KAAQA,MA5BjD,iBA+BE,WACE,IAAK,IAAMC,KAAKhB,KAAKe,IACnB,GAAIf,KAAKe,IAAIC,GAAI,OAAO,EAE1B,OAAO,IAnCX,kBAsCE,WACE,IAAM4D,EAAc,GACpB,IAAK,IAAM5D,KAAKhB,KAAKe,KACC,IAAhBf,KAAKe,IAAIC,IAAa4D,EAAOV,KAAKlD,GAExC,OAAO4D,MA3CX,KCEaiN,GAAb,WAGE,WAAY9M,GAA0C,yBAF7Cc,OAAkB,QAGZ7B,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GAJhD,0CAOE,SAAeI,GACb,OAAO,IAAI0M,EAAJ,2BAAqB7R,MAASmF,MARzC,kBAWE,SAAKlE,GACH,IAAMH,EAAKd,KAAK6F,OACViM,EAAMhR,EAAGwE,WAAU,SAAAC,GAAC,OAAIC,YAAWvE,EAAGsE,MAC5C,OAAOvF,KAAKqF,OAAO,CACjBQ,OAAQiM,EAAM,EAAN,sBAAchR,GAAd,CAAkBG,IAAlB,sBAA2BH,EAAGkC,MAAM,EAAG8O,IAAvC,YAAgDhR,EAAGkC,MAAM8O,EAAM,SAf7E,kBAmBE,WACE,OAAO9R,KAAKqF,OAAO,CACjBQ,OAAQ7F,KAAK6F,OAAO7C,MAAM,EAAGhD,KAAK6F,OAAOpE,OAAS,OArBxD,iBAyBE,SAAIR,GACF,OAAOjB,KAAK6F,OAAOP,WAAU,SAAAC,GAAC,OAAIC,YAAWvE,EAAGsE,OAAO,IA1B3D,mBA6BE,WACE,OAAOvF,KAAK6F,OAAOpE,OAAS,IA9BhC,iBAiCE,WACE,OAA8B,IAAvBzB,KAAK6F,OAAOpE,SAlCvB,oBAqCE,WACE,OAAOzB,KAAK6F,OAAO9E,KAAI,SAAAE,GAAC,OAAI8Q,YAAU9Q,GAAGT,cAAYsQ,KAAK,OAtC9D,qBAyCE,SAActM,GACZ,IAAMqB,EAASC,YAAYtB,GAC3B,OAAOqB,GAAU,IAAIgM,EAAY,CAAEhM,OAAQA,QA3C/C,KCEamM,GAAb,WAIE,WAAYjN,GAA4C,yBAH/CkN,SAAsB,GAGwB,KAF9CjJ,WAA2BhF,OAGrBA,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GALhD,0CAQE,SAAeI,GACb,OAAO,IAAI6M,EAAJ,2BAAuBhS,MAASmF,MAT3C,kBAYE,SAAKlE,GACH,QAAmB+C,IAAfhE,KAAKgJ,MACP,OAAOhJ,KAAKqF,OAAO,CAAE2D,MAAO/H,IAG9B,IAAMiR,EAAmB,CAAClS,KAAKgJ,MAAO/H,GACtC,OAAIjB,KAAKoF,IAAI8M,KAAaC,GAAMD,GACvBlS,KAAKqF,OAAO,CAAE2D,WAAOhF,IAEvBhE,KAAKqF,OAAO,CACjB4M,SAAS,GAAD,mBAAMjS,KAAKiS,UAAX,CAAqBC,IAC7BlJ,WAAOhF,MAvBb,kBA2BE,WACE,YAAmBA,IAAfhE,KAAKgJ,MACAhJ,KAAKqF,OAAO,CAAE2D,WAAOhF,IAEvBhE,KAAKqF,OAAO,CACjB4M,SAAUjS,KAAKiS,SAASjP,MAAM,EAAGhD,KAAKiS,SAASxQ,OAAS,OAhC9D,qBAoCE,WACE,OAAOzB,KAAKqF,OAAO,CAAE2D,WAAOhF,MArChC,mBAwCE,WACE,YAAsBA,IAAfhE,KAAKgJ,OAAuBhJ,KAAKiS,SAASxQ,OAAS,IAzC9D,iBA4CE,WACE,OAAgC,IAAzBzB,KAAKiS,SAASxQ,SA7CzB,iBAgDE,SAAYyQ,GACV,OAAOV,GAASxR,KAAKiS,SAAUC,KAjDnC,oBAoDE,WACE,OAAOlS,KAAKiS,SAASlR,KAAI,SAAAkQ,GAAC,OAAIrL,YAAWqL,GAAGzQ,SAAS,OAAKsQ,KAAK,OArDnE,qBAwDE,SAActM,GACZ,IAAMqB,EAASC,YAAYtB,GAC3B,GAAKqB,GACDA,EAAOpE,OAAS,IAAM,EAA1B,CAEA,IADA,IAAMwQ,EAAsB,GACnB/P,EAAI,EAAGA,EAAI2D,EAAOpE,OAAS,EAAGS,IAAK,CAC1C,IAAMkQ,EAAa,CAACvM,EAAW,EAAJ3D,GAAQ2D,EAAW,EAAJ3D,EAAQ,IAC9CiQ,GAAMC,KAAOZ,GAASS,EAAUG,IAAIH,EAAS/N,KAAKkO,GAExD,OAAO,IAAIJ,EAAc,CAAEC,SAAUA,SAjEzC,KAqEMT,GAAW,SAACS,EAAD,0BAAuBjJ,EAAvB,KAA8BC,EAA9B,YACfgJ,EAAS3M,WACP,mCAAE2L,EAAF,KAAK5F,EAAL,YACG7F,YAAWwD,EAAOiI,IAAMzL,YAAWyD,EAAKoC,IAAQ7F,YAAWwD,EAAOqC,IAAM7F,YAAWyD,EAAKgI,OACxF,GAEDkB,GAAQ,SAAC,GAAoC,IAAD,mBAAlCnJ,EAAkC,KAA3BC,EAA2B,KAChD,GAAIzD,YAAWwD,EAAOC,GAAM,OAAO,EACnC,kBAAiBD,EAAjB,GAAOqJ,EAAP,KAAWC,EAAX,KACA,cAAiBrJ,EAAjB,GAAOsJ,EAAP,KAAWC,EAAX,KACA,OACEH,IAAOE,GACPD,IAAOE,GACPD,EAAKF,IAAOG,EAAKF,GACjBC,EAAKF,IAAOC,EAAKE,GC3ERC,GACL,OADKA,GAEC,aAFDA,GAGC,aAHDA,GAIG,eAJHA,GAKE,cALFA,GAMF,UAGEC,GAAb,WAYE,WAAY3N,GAAyC,yBAX5C4N,KAAkBF,GAWyB,KAV3CvK,KAAkB,IAAI6G,GAUqB,KAT3C6D,WAA0B,IAAIf,GASa,KAR3CgB,WAA0B,IAAIhB,GAQa,KAP3CiB,aAA4B,IAAIjB,GAOW,KAN3CkB,YAA6B,IAAIf,GAMU,KAL3CgB,WAA0B,IAAInB,GAKa,KAJ3CoB,UAAoB,EAIuB,KAH3CC,MAAmD,GAGR,KAF5C7D,WAE4C,OACrCrL,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GAbhD,0CAgBE,SAAeI,GACb,OAAO,IAAIuN,EAAJ,uCAAoB1S,MAASmF,GAA7B,IAAqCkK,WAAOrL,OAjBvD,qBAsBE,SAAgB/C,GACd,OAAQjB,KAAK2S,MACX,KAAKF,GACH,OAAOzS,KAAKmT,YAAYlS,GAC1B,KAAKwR,GACH,OAAOzS,KAAKoT,iBAAiBnS,KAAOjB,KAAK6S,WAAWzN,IAAInE,GAC1D,KAAKwR,GACH,OAAOzS,KAAKoT,iBAAiBnS,KAAOjB,KAAK4S,WAAWxN,IAAInE,GAC1D,KAAKwR,GAEL,KAAKA,GACH,OAAO,EACT,QACE,OAAO,KAnCf,yBAuCE,SAAoBxR,GAClB,OAAOjB,KAAKkI,KAAKqH,QAAQtO,KAAOjB,KAAK4S,WAAWxN,IAAInE,KAAOjB,KAAK6S,WAAWzN,IAAInE,KAxCnF,8BA2CE,SAAyBA,GACvB,OAAOjB,KAAKkI,KAAKwH,SAAW1P,KAAKkI,KAAKsH,cAAgBxP,KAAKkI,KAAK8G,KAAK5J,IAAInE,KA5C7E,kBA+CE,SAAKA,GACH,IAAKjB,KAAKqT,QAAQpS,GAAI,OAAOjB,KAC7B,OAAQA,KAAK2S,MACX,KAAKF,GACH,OAAOzS,KAAKqF,OAAO,CAAE6C,KAAMlI,KAAKkI,KAAK/H,KAAKc,KAC5C,KAAKwR,GACH,OAAOzS,KAAKqF,OAAO,CAAEuN,WAAY5S,KAAK4S,WAAWU,KAAKrS,KACxD,KAAKwR,GACH,OAAOzS,KAAKqF,OAAO,CAAEwN,WAAY7S,KAAK6S,WAAWS,KAAKrS,KACxD,KAAKwR,GACH,OAAOzS,KAAKqF,OAAO,CAAEyN,aAAc9S,KAAK8S,aAAaQ,KAAKrS,KAC5D,KAAKwR,GACH,OAAOzS,KAAKqF,OAAO,CAAE0N,YAAa/S,KAAK+S,YAAYrQ,KAAKzB,KAC1D,QACE,OAAOjB,QA7Df,qBAmEE,SAAQ2S,GACN,OAAO3S,KAAKqF,OAAO,CACjBsN,KAAMA,EACNI,YAAaJ,IAASF,GAAyBzS,KAAK+S,YAAc/S,KAAK+S,YAAYQ,cAtEzF,qBA0EE,SAAQrL,GACN,OAAOlI,KAAKqF,OAAO,CAAE6C,WA3EzB,mBAgFE,WACE,OAAQlI,KAAK2S,MACX,KAAKF,GACH,OAAOzS,KAAKkI,KAAK6H,QACnB,KAAK0C,GACH,OAAOzS,KAAK4S,WAAW7C,QACzB,KAAK0C,GACH,OAAOzS,KAAK6S,WAAW9C,QACzB,KAAK0C,GACH,OAAOzS,KAAK8S,aAAa/C,QAC3B,KAAK0C,GACH,OAAOzS,KAAK+S,YAAYhD,QAC1B,QACE,OAAO,KA7Ff,kBAiGE,WACE,IAAK/P,KAAK+P,QAAS,OAAO/P,KAC1B,OAAQA,KAAK2S,MACX,KAAKF,GACH,OAAOzS,KAAKqF,OAAO,CAAE6C,KAAMlI,KAAKkI,KAAKmI,SACvC,KAAKoC,GACH,OAAOzS,KAAKqF,OAAO,CAAEuN,WAAY5S,KAAK4S,WAAWvC,SACnD,KAAKoC,GACH,OAAOzS,KAAKqF,OAAO,CAAEwN,WAAY7S,KAAK6S,WAAWxC,SACnD,KAAKoC,GACH,OAAOzS,KAAKqF,OAAO,CAAEyN,aAAc9S,KAAK8S,aAAazC,SACvD,KAAKoC,GACH,OAAOzS,KAAKqF,OAAO,CAAE0N,YAAa/S,KAAK+S,YAAY1C,SACrD,QACE,OAAOrQ,QA/Gf,+BAmHE,WACE,OAAOA,KAAK2S,OAASF,KAAmBzS,KAAK+P,SAAW/P,KAAKkI,KAAKgI,eApHtE,4BAuHE,WACE,OAAOlQ,KAAK2S,OAASF,KAAmBzS,KAAK+P,SAAW/P,KAAKkI,KAAK0H,aAxHtE,2BA6HE,SAAc/J,GACZ,OAAO7F,KAAKqF,OAAO,CAAE2N,WAAY,IAAInB,GAAY,CAAEhM,eA9HvD,yBAiIE,SAAYoN,GACV,OAAOjT,KAAKqF,OAAO,CAAE4N,eAlIzB,sBAqIE,SAASC,GACP,OAAOlT,KAAKqF,OAAO,CAAE6N,YAtIzB,mBAyIE,WAEE,YADmBlP,IAAfhE,KAAKqP,QAAqBrP,KAAKqP,MAAQmE,YAAUxT,KAAK+H,OAAQ/H,KAAKgI,SAChEhI,KAAKqP,QA3IhB,kBA8IE,WACE,MAAM,GAAN,mBAAWrP,KAAKkI,KAAKH,QAArB,YAAgC/H,KAAK4S,WAAW/M,WA/IpD,kBAkJE,WACE,MAAM,GAAN,mBAAW7F,KAAKkI,KAAKF,QAArB,YAAgChI,KAAK6S,WAAWhN,WAnJpD,kCAuJE,WACE,IAAM+H,EAAQ6F,YAAUzT,KAAKsP,SAC7B,OAAOtP,KAAKqF,OAAO,CACjBsN,KAAMF,GACNvK,KAAM,IAAI6G,GACV6D,WAAY,IAAIf,GAAY,CAAEhM,OAAQ+H,EAAM8F,OAAOC,IAAO9T,SAC1DgT,WAAY,IAAIhB,GAAY,CAAEhM,OAAQ+H,EAAM8F,OAAOC,IAAOjM,aA7JhE,oBAmKE,WACE,IAAMkJ,EAAkB,GAClBgD,EAAe5T,KAAKkI,KAAK2I,SAM/B,MALqB,KAAjB+C,GAAqBhD,EAAM1M,KAAK0P,GAC/B5T,KAAK4S,WAAW9C,OAAOc,EAAM1M,KAAN,YAAgBlE,KAAK4S,WAAW/B,WACvD7Q,KAAK6S,WAAW/C,OAAOc,EAAM1M,KAAN,YAAgBlE,KAAK6S,WAAWhC,WACvD7Q,KAAK8S,aAAahD,OAAOc,EAAM1M,KAAN,YAAgBlE,KAAK8S,aAAajC,WAC3D7Q,KAAK+S,YAAYjD,OAAOc,EAAM1M,KAAN,YAAgBlE,KAAK+S,YAAYlC,WACvDD,EAAME,KAAK,QA3KtB,qBA8KE,SAActM,GAAuC,IAAD,UAC5CoM,EAAQpM,EAAKuM,MAAM,KACnBC,EAAO,SAACC,GAAD,mCAAeL,EAAMI,MAAK,SAAAnM,GAAC,OAAIA,EAAEqM,WAAWD,aAA5C,aAAe,EAAkCE,QAAQF,EAAG,WAA5D,QAAmE,IAC1E2C,EAAY,cAAU5C,EAAK,QAAf,cAA4BA,EAAK,MAAjC,cAA4CA,EAAK,MAAjD,cAA4DA,EAAK,OAC7E6C,EAAiB7C,EAAK,MACtB8C,EAAiB9C,EAAK,MACtB+C,EAAmB/C,EAAK,MACxBgD,EAAkBhD,EAAK,MAC7B,OAAO,IAAI0B,EAAW,CACpBC,KAAMF,GACNvK,KAAI,UAAE6G,GAAUvB,OAAOoG,UAAnB,QAAoC,IAAI7E,GAC5C6D,WAAU,UAAEf,GAAYrE,OAAOqG,UAArB,QAAwC,IAAIhC,GACtDgB,WAAU,UAAEhB,GAAYrE,OAAOsG,UAArB,QAAwC,IAAIjC,GACtDiB,aAAY,UAAEjB,GAAYrE,OAAOuG,UAArB,QAA0C,IAAIlC,GAC1DkB,YAAW,UAAEf,GAAcxE,OAAOwG,UAAvB,QAA2C,IAAIhC,SA5LhE,KCrBaiC,GAKX,WAAYlP,GAA4C,yBAJ/CoF,KAAe,GAI+B,KAH9C+J,iBAG8C,OAF9CC,aAE8C,OACxCnQ,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,IAInCqP,GAIX,WAAYrP,GAA2C,yBAH9CsP,GAAoB,IAAIJ,GAGqB,KAF7CK,OAAwB,IAAIL,QAGtBjQ,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,ICbnCwP,GAAb,WAKE,WAAYxP,GAAyC,yBAJ5CmJ,IAAc,EAI6B,KAH3CsG,KAAe,EAG4B,KAF3CC,SALe,QAQTzQ,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GANhD,0CASE,SAAeI,GACb,OAAO,IAAIoP,EAAJ,2BAAoBvU,MAASmF,MAVxC,oBAaE,WACE,UAAWnF,KAAKkO,IAAM,GAAKlO,KAAKyU,YAdpC,sBAiBE,SAAiBD,GACf,OAAIA,EAAO,GAAKxU,KAAK0U,SAAWF,EAAaxU,KACtCA,KAAKqF,OAAO,CAAEmP,WAnBzB,mBAsBE,WACE,OAAqB,IAAdxU,KAAKwU,OAvBhB,kBA0BE,WACE,OAAOxU,KAAKwU,OAASxU,KAAK0U,WA3B9B,kBA8BE,WACE,OAAI1U,KAAK0P,OAAe1P,KACjBA,KAAKuQ,SAASvQ,KAAKwU,KAAO,KAhCrC,oBAmCE,WACE,OAAIxU,KAAK0P,OAAe1P,KACjBA,KAAKuQ,SAASvQ,KAAK0U,YArC9B,kBAwCE,WACE,OAAI1U,KAAK2U,QAAgB3U,KAClBA,KAAKuQ,SAASvQ,KAAKwU,KAAO,KA1CrC,qBA6CE,WACE,OAAIxU,KAAK2U,QAAgB3U,KAClBA,KAAKuQ,SAAS,KA/CzB,qBAkDE,WACE,OAAOvQ,KAAKwU,KAAOxU,KAAKyU,WAnD5B,mBAsDE,WACE,OAAOtI,KAAKsF,KAAKzR,KAAKwU,KAAO,GAAKxU,KAAKyU,SAAUzU,KAAKkO,OAvD1D,sBA0DE,WACE,IAAMlF,EAAQhJ,KAAKwU,KAAOxU,KAAKyU,SAAW,EACpCpL,EAAO8C,KAAKsF,KAAKzR,KAAKwU,KAAO,GAAKxU,KAAKyU,SAAUzU,KAAKkO,KAC5D,MAAM,GAAN,OAAUlF,EAAV,YAAmBK,EAAnB,eAA8BrJ,KAAKkO,SA7DvC,KCKa0G,GAAb,WAKE,WAAY7P,GAA+C,yBAJlD7E,MAAiB,GAIgC,KAHjD2U,UAAoB,EAG6B,KAFjD9L,cAEiD,OAC3C/E,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GANhD,0CASE,SAAeI,GACb,OAAO,IAAIyP,EAAJ,2BAA0B5U,MAASmF,MAV9C,sBAaE,SAASrE,GACP,OAAOd,KAAKqF,OAAO,CAAEnF,MAAOY,MAdhC,yBAiBE,SAAY8Q,GACV,OAAO5R,KAAKqF,OAAO,CAAEwP,SAAUjD,MAlBnC,yBAqBE,SAAYlR,GACV,OAAOV,KAAKqF,OAAO,CAAE0D,SAAUrI,MAtBnC,iBAyBE,WACE,MAAO,CACLR,MAAOF,KAAK6U,UAAY7U,KAAKE,MAAMuB,OAAS,EAAIzB,KAAKE,WAAQ8D,EAC7D+E,SAAU/I,KAAK+I,cA5BrB,KAiCa+L,GAKX,WAAY/P,GAAgD,yBAJnDmJ,IAAc,EAIoC,KAHlD5G,QAAoB,GAG8B,KAFlD6G,WAEkD,OAC5CnK,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,IC5CnCgQ,GACH,SADGA,GAEJ,QAFIA,GAGH,SAHGA,GAIH,SAJGA,GAKJ,QAGIC,GAAb,WAIE,WAAYjQ,GAAwC,yBAH3CuK,QAAmByF,GAGuB,KAF1CE,MAAmB,CAACF,GAAgBA,SAG9B/Q,IAATe,GAAoBE,OAAOC,OAAOlF,KAAM+E,GALhD,0CAQE,SAAeI,GACb,OAAO,IAAI6P,EAAJ,2BAAmBhV,MAASmF,MATvC,wBAYE,SAAWmG,GACT,OAAOtL,KAAKqF,OAAO,CAAEiK,QAAShE,MAblC,sBAgBE,SAAS2J,GACP,OAAOjV,KAAKqF,OAAO,CAAE4P,MAAOA,MAjBhC,sBAoBE,SAASC,GACP,OAAOlV,KAAKqF,OAAO,CAAEiK,QAAStP,KAAKiV,MAAMC,OArB7C,iBAwBE,WACE,OAAOlV,KAAKiV,MAAME,QAAQnV,KAAKsP,aAzBnC,K,QCGa8F,GAAkBC,wBAA+B,CAC5DC,UAAW,IAAIN,GACfO,aAAc,aACdC,iBAAkB,IAAIZ,GACtBa,oBAAqB,aACrBC,kBAAmB,IAAIZ,GACvBa,qBAAsB,eAGXC,GAA8B,SAAC,GAAkB,IAAhBlL,EAAe,EAAfA,SAC5C,EAAkCmL,mBAAoB,IAAIb,IAA1D,mBAAOM,EAAP,KAAkBC,EAAlB,KACA,EAAgDM,mBAA2B,IAAIjB,IAA/E,mBAAOY,EAAP,KAAyBC,EAAzB,KACA,EAAkDI,mBAChD,IAAIf,IADN,mBAAOY,EAAP,KAA0BC,EAA1B,KAGMG,EAAQ,CACZR,YACAC,eACAC,mBACAC,sBACAC,oBACAC,wBAaF,OAXAI,qBAAU,WACP,sBAAC,sBAAA3S,EAAA,sEACUwL,KADV,kCAEE2G,EACED,EACGU,SAAS,CAACjB,GAAgBA,GAAeA,GAAgBA,GAAgBA,KACzEkB,WAAWlB,KALlB,0CAAD,KASA,IACI,eAACK,GAAgBc,SAAjB,CAA0BJ,MAAOA,EAAjC,SAAyCpL,KCrCrCyL,GAAed,wBAA4B,CACtDe,WAAY,IAAI1D,GAChB2D,cAAe,aACfC,kBAActS,EACduS,gBAAiB,eAGNC,GAA2B,SAAC,GAAkB,IAAhB9L,EAAe,EAAfA,SACzC,EAAyCmL,oBACvC,kBAAMnD,GAAWlF,OAAOiJ,OAAOC,SAASC,KAAK3T,MAAM,KAAO,IAAI0P,MADhE,mBAAO0D,EAAP,KAAmBQ,EAAnB,KAOA,EAAwCf,qBAAxC,mBAAOS,EAAP,KAAqBC,EAArB,KACA,OACE,eAACJ,GAAaD,SAAd,CACEJ,MAAO,CACLM,aACAC,cATgB,SAACpF,GACrB2F,EAAmB3F,GACnBwF,OAAOI,QAAQC,aAAa,KAAM,GAAlC,WAA0C7F,EAAEJ,YAQxCyF,eACAC,mBALJ,SAQG7L,KCpBMqM,GACE,cADFA,GAEC,aAFDA,GAGQ,oBAHRA,GAIK,iBAJLA,GAKO,mBALPA,GAMO,mBANPA,GAOG,eAPHA,GAQA,YARAA,GASK,iBAULC,GAAoB3B,wBAAiC,CAChE4B,WAAY,IAAIvF,GAChBwF,cAAe,eAGJC,GAAgC,SAAC,GAAkB,IAAhBzM,EAAe,EAAfA,SAC9C,EAAyCmL,oBACvC,kCAAMrI,GAAO4J,aAAaC,QAAQ,eAAiB,aAAnD,QAA4D,IAAI3F,MADlE,mBAAOuF,EAAP,KAAmBK,EAAnB,KAOA,OACE,eAACN,GAAkBd,SAAnB,CAA4BJ,MAAO,CAAEmB,aAAYC,cAL7B,SAACjW,GACrBqW,EAAmBrW,GACnBmW,aAAaG,QAAQ,aAAc1G,GAAO5P,MAG1C,SACGyJ,KAKDmG,GAAS,SAAC5P,GACd,OAAOuW,KAAKC,UAAUxW,EAAEF,MAGpByM,GAAS,SAAChJ,GACd,IACE,IAAMO,EAAOyS,KAAKE,MAAMlT,GACxB,OAAO,IAAIkN,GAA+B3M,GAC1C,MAAOsG,GACP,SCvDSsM,GAAb,WAKE,WAAYC,GAA2B,yBAJ9BC,OAI6B,OAH7BC,OAG6B,OAF7BC,OAE6B,EAChCH,GAAoB,KACtB5X,KAAK6X,EAAI,IACT7X,KAAK8X,EAAI,GACT9X,KAAK+X,EAAI,IACAH,GAAoB,KAC7B5X,KAAK6X,EAAI,IACT7X,KAAK8X,EAAI,GACT9X,KAAK+X,EAAI,KAET/X,KAAK6X,EAAI,IACT7X,KAAK8X,EAAI,GACT9X,KAAK+X,EAAI,IAjBf,sCAqBE,SAAGjY,GACD,OAAOE,KAAK+X,EAAIjY,EAAIE,KAAK8X,IAtB7B,gBAyBE,SAAG/X,GACD,OAAOC,KAAK+X,GAAKpY,IAAa,EAAII,GAAKC,KAAK8X,IA1BhD,eA6BE,YAAmC,IAAD,mBAA/BhY,EAA+B,KAA5BC,EAA4B,KAChC,MAAO,CAACC,KAAKgY,GAAGlY,GAAIE,KAAKiY,GAAGlY,MA9BhC,eAiCE,YAAsC,IAAD,mBAAlCmY,EAAkC,KAA9BC,EAA8B,KACnC,MAAO,CAACC,IAAQF,EAAKlY,KAAK+X,GAAK/X,KAAK8X,GAAIM,IAAQpY,KAAK6X,EAAIM,EAAKnY,KAAK+X,GAAK/X,KAAK8X,MAlCjF,mBAqCE,WACE,OAAO,IAAIpY,MAAMC,KAAYC,KAAK,MAAMmB,KAAI,SAACsX,EAAGnW,GAAJ,OAAUA,OAtC1D,sBAyCE,WACE,OAAQlC,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,MAAO,KACT,KAAK,IACH,MAAO,QAhDf,4BAoDE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,OAAO,EACT,KAAK,IACH,OAAO,KA3Df,4BA+DE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,OAAO,IACT,KAAK,IACH,OAAO,KAtEf,yBA0EE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,MAAO,MACT,KAAK,IACH,MAAO,UAjFf,wBAqFE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,OAAO,EACT,KAAK,IACH,OAAO,KA5Ff,yBAgGE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,MAAO,OACT,KAAK,IACH,MAAO,UAvGf,0BA2GE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,MAAO,OACT,KAAK,IACH,MAAO,UAlHf,kCAsHE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,OAAO,EACT,KAAK,IACH,OAAO,KA7Hf,sCAiIE,WACE,OAAQ7X,KAAK6X,GACX,KAAK,IAEL,KAAK,IACH,MAAO,MACT,KAAK,IACH,MAAO,WAxIf,KA6IaS,GAAgBjD,wBAAsB,IAAIsC,GAAO,MAEjDY,GAA4B,SAAC,GAAkB,IAAhB7N,EAAe,EAAfA,SACpC8N,EAASC,mBAAQ,kBAAM,IAAId,GAAOlB,OAAOiC,cAAa,IAC5D,OAAO,eAACJ,GAAcpC,SAAf,CAAwBJ,MAAO0C,EAA/B,SAAwC9N,KAG3C0N,GAAS,SAACO,GAAD,OAAuBxM,KAAKsF,IAAItF,KAAKyM,IAAI,EAAGzM,KAAKrD,MAAM6P,IAAKhZ,IAAa,I,kGCxJ3EkZ,GAAuC,SAAC,GACnD,OAD+D,EAAVC,KAEnD,KAAK,EACH,OACE,eAAC,KAAD,CAAMC,QAAQ,SAAd,SACE,eAAC,KAAD,CAAMC,GAAIC,KAAsBC,QAAQ,QAAQC,MAAM,gBAG5D,KAAK,EACH,OACE,eAAC,KAAD,CAAMJ,QAAQ,SAAd,SACE,eAAC,KAAD,CAAMC,GAAII,KAAaF,QAAQ,QAAQC,MAAM,eAGnD,KAAK,KACH,OACE,eAAC,KAAD,CAAMJ,QAAQ,SAAd,SACE,eAAC,KAAD,CAAMC,GAAIK,KAAgBH,QAAQ,QAAQC,MAAM,eAGtD,QACE,OAAO,iCCgJPxF,GAA2E,SAAC,GAG3E,IAAD,EAFJ9F,EAEI,EAFJA,OACAyL,EACI,EADJA,aAEA,EACEC,qBAAWnE,IADLI,EAAR,EAAQA,iBAAkBC,EAA1B,EAA0BA,oBAAqBH,EAA/C,EAA+CA,UAAWC,EAA1D,EAA0DA,aAM1D,OACE,gBAAC,KAAD,WACE,eAAC,KAAD,CACEiE,QAAQ,OACRrF,QARU,WACdsB,EAAoBD,EAAiBiE,YAAY5L,EAAOnN,KACxD6U,EAAaD,EAAUW,WAAWlB,MAIhC,mBAGKlH,EAAOvC,KAAKoB,OAHjB,YAG2BmB,EAAO/B,QAAQY,UAC1C,wBALF,UAMG4M,EAAavV,IAAI8J,EAAOlC,gBAN3B,aAMG,EAAkCL,SAK1BoO,GAzKK,WAAO,IAAD,IAClBC,EAAKlB,mBAAQ,kBAAM,IAAI9R,IAAe,IAC5C,EAAwCkP,mBAA4C,IAAItS,KAAxF,mBAAO+V,EAAP,KAAqBM,EAArB,KACA,EAAkC/D,mBAAsC,IAAItS,KAA5E,mBAAOsW,EAAP,KAAkBC,EAAlB,KACA/D,qBAAU,WACP,sBAAC,sBAAA3S,EAAA,kEACAwW,EADA,SACsBD,EAAGI,kBADzB,8CAEAD,EAFA,SAEmBH,EAAGK,eAFtB,6EAAD,KAIA,IAEH,IACMC,EADiBV,qBAAWpD,IAA1BC,WACelO,KAAKiH,OAC5B,EAAgC0G,qBAAhC,mBAAOqE,EAAP,KAAiBC,EAAjB,KAYA,GAXApE,qBAAU,gBACI/R,IAARiW,EAIH,sBAAC,4BAAA7W,EAAA,sEACqBuW,EAAGS,aAAa,CAACH,IADtC,QACM5Z,EADN,QAEWoB,OAAS,GAAG0Y,EAAY9Z,EAAO,IAF1C,0CAAD,GAHC8Z,OAAYnW,KAOb,CAACiW,SAEajW,IAAbkW,EACF,OACE,eAAC,IAAD,UACE,eAAC,KAAD,CAAMf,MAAM,WAAWkB,GAAG,OAA1B,mCAMN,IAAQxa,EAA8Cqa,EAA9Cra,MAAO6H,EAAuCwS,EAAvCxS,MAAOE,EAAgCsS,EAAhCtS,WAAYC,EAAoBqS,EAApBrS,KAAMF,EAAcuS,EAAdvS,UAClC2S,EAAG,uDAAmDJ,EAASxZ,IACrE,OACE,gBAAC,KAAD,CAAO6Z,WAAW,aAAlB,UACE,eAAC,KAAD,CAASvB,GAAG,KAAK5J,KAAK,KAAtB,kBAGA,gBAAC,IAAD,CAAMoL,GAAG,OAAT,UACE,eAAC,IAAD,CAAUC,MAAM,MAAMC,SAAS,QAA/B,SACE,gBAAC,KAAD,CAAOtL,KAAK,WAAWoK,QAAQ,WAA/B,UACE,2BAAUmB,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,gBAAC,KAAD,WACE,gBAAC,KAAD,WACE,eAAC,KAAD,oBACA,eAAC,KAAD,UACE,eAAC,GAAD,CAAS3B,IAAKoB,EAAS1X,aAEzB,gBAAC,KAAD,CAAIqY,WAAS,EAAb,UAAeX,EAAS7R,OAAS,IAAjC,aAEF,gBAAC,KAAD,WACE,eAAC,KAAD,oBACA,eAAC,KAAD,UACE,eAAC,GAAD,CAASyQ,IAAKoB,EAASzX,aAEzB,gBAAC,KAAD,CAAIoY,WAAS,EAAb,UAAeX,EAAS5R,OAAS,IAAjC,qBAKR,eAAC,IAAD,CAAUmS,MAAM,MAAMC,SAAS,QAA/B,SACE,gBAAC,KAAD,CAAOtL,KAAK,WAAWoK,QAAQ,WAA/B,UACE,2BAAUmB,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,gBAAC,KAAD,WACE,gBAAC,KAAD,WACE,eAAC,KAAD,mBACA,eAAC,KAAD,CAAII,WAAS,EAAb,SAAehT,EAAKyD,UAEtB,gBAAC,KAAD,WACE,eAAC,KAAD,mBACA,eAAC,KAAD,CAAIuP,WAAS,EAAb,SAAeX,EAASvR,kBAKhC,eAAC,IAAD,CAAU8R,MAAM,MAAMC,SAAS,QAA/B,SACE,gBAAC,KAAD,CAAOtL,KAAK,WAAWoK,QAAQ,WAA/B,UACE,2BAAUmB,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,gBAAC,KAAD,WACE,gBAAC,KAAD,WACE,eAAC,KAAD,kBACA,eAAC,KAAD,CAAII,WAAS,EAAb,SAAeX,EAASzR,SAE1B,gBAAC,KAAD,WACE,eAAC,KAAD,mBACA,eAAC,KAAD,CAAIoS,WAAS,EAAb,SAAeX,EAAStR,qBAOlC,eAAC,KAAD,CAASoQ,GAAG,KAAK5J,KAAK,KAAtB,0BAGA,eAAC,KAAD,CAAKoL,GAAG,OAAR,SACE,eAAC,GAAD,CAAQ3M,OAAQhO,EAAOyZ,aAAcA,MAGvC,eAAC,KAAD,CAASN,GAAG,KAAK5J,KAAK,KAAtB,0BAGA,eAAC,KAAD,CAAKoL,GAAG,OAAR,SACE,eAAC,GAAD,CAAQ3M,OAAQnG,EAAO4R,aAAcA,MAGvC,eAAC,KAAD,CAASN,GAAG,KAAK5J,KAAK,KAAtB,wBAGA,eAAC,KAAD,CAAKoL,GAAG,OAAR,SACE,gBAAC,KAAD,YACI5S,EAAWmC,OAAS,YADxB,cACyCnC,EAAW0D,KAAKoB,QACvD,wBAFF,UAGM9E,EAAWoB,MAHjB,cAG4BpB,EAAWqB,KAHvC,mBAKG4Q,EAAU9V,IAAI6D,EAAWmE,aAL5B,aAKG,EAAgCT,KALnC,eAK2CgO,EAAavV,IAAI6D,EAAW+D,gBALvE,aAK2C,EAAsCL,KAC/E,wBANF,SAOS4O,EAASpR,WAIpB,eAAC,KAAD,CAASkQ,GAAG,KAAK5J,KAAK,KAAtB,uBAGA,eAAC,KAAD,CAAKoL,GAAG,OAAR,SACE,eAAC,GAAD,CAAQ3M,OAAQlG,EAAW2R,aAAcA,MAG3C,eAAC,KAAD,CAASN,GAAG,KAAK5J,KAAK,KAAtB,4BAGA,eAAC,KAAD,CAAKoL,GAAG,OAAR,SACE,eAAC,KAAD,CAAMM,KAAMR,EAAKS,YAAU,EAAC5B,MAAM,WAAWoB,WAAW,SAAxD,SACGD,U,oBClKI,SAASU,KACtB,OAAO,IAAIC,OAAO,IAA0B,+CCuCvC,IAAMC,GAAsB,WACjC,MAAsC3B,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACpB,EAAsCR,oBAAS,GAA/C,mBAAOsF,EAAP,KAAoBC,EAApB,KACA,EAA4BvF,mBAA8B,MAA1D,mBAAOxV,EAAP,KAAegb,EAAf,KACA,EAA0BxF,mBAAwB,MAAlD,mBAAO1H,EAAP,KAAcmN,EAAd,KAEA,EAAsCzF,oBAAS,GAA/C,mBAAO0F,EAAP,KAAoBC,EAApB,KACMC,EAAaC,iBAAe,IAC5BC,EAAaD,kBAAgB,GAC7BE,EAAcF,iBAAe,GAE7BG,EAAYH,iBAAsB,MAClCI,EAAiBJ,kBAAgB,GAGjCK,EAAqBC,uBAAY,WACrC,IAAMjU,EAAmB,GACnBC,EAAmB,GAUzB,OARAoO,EAAWlO,KAAKH,OAAOkU,SAAQ,SAAA5Z,GAC7B0F,EAAO7D,KAAgB,GAAX7B,EAAM,GAAUA,EAAM,OAGpC+T,EAAWlO,KAAKF,OAAOiU,SAAQ,SAAA5Z,GAC7B2F,EAAO9D,KAAgB,GAAX7B,EAAM,GAAUA,EAAM,OAG7B,CAAE0F,OAAQ,IAAImU,WAAWnU,GAASC,OAAQ,IAAIkU,WAAWlU,MAC/D,CAACoO,IAGE+F,EAAgBH,sBAAW,sBAAC,wCAAA5Y,EAAA,kEAEzBuY,EAAWrM,QAFc,iDAG9B8L,GAAe,GACfE,EAAS,MAGHpb,EAAQkW,EAAWlO,KAAKoH,QAAQpP,MAChC8E,EAAWoR,EAAWlO,KAAKoH,QAAQtK,SAIpC6W,EAAUvM,UACP8M,EAAY,IAAKC,GACvBR,EAAUvM,QAAU8M,EACpBN,EAAexM,SAAU,EACzB8M,EAAEE,UAAY,SAACC,GACb,IAAMC,EAAWD,EAAGE,KACpB,GAAiB,UAAbD,EAAIE,KACNZ,EAAexM,SAAU,OACpB,GAAiB,QAAbkN,EAAIE,KAAgB,CAC7B,IAAMvS,EAAeqS,EAAIrS,MAAQ,GACjC,GAAIA,EAAK+G,WAAW,WAAY,CAC9B,IAAMyL,EAAS,cAAcC,KAAKzS,GAC5B0S,EAAS,cAAcD,KAAKzS,GAC5B2S,EAAO,cAAcF,KAAKzS,GAC5B2S,IAAMlB,EAAYtM,QAAUxF,SAASgT,EAAK,GAAI,KAClD,IACMC,EADYrd,MAAM4E,KAAK6F,EAAK6S,SAAS,qBACRjc,KAAI,SAAC0I,GAAD,MAAQ,CAAE3J,EAAGgK,SAASL,EAAE,GAAI,IAAK1J,EAAG+J,SAASL,EAAE,GAAI,IAAKwT,MAAO,MAChGC,EAAaH,EAAGtb,OAAS,EAAI,CAAE3B,EAAGid,EAAG,GAAGjd,EAAGC,EAAGgd,EAAG,GAAGhd,EAAGkd,MAAOH,EAAOhT,SAASgT,EAAK,GAAI,IAAM,QAAM9Y,EACzGqX,GAAU,SAAA8B,GAAI,MAAK,CACjBC,SAAUF,IAAU,OAAIC,QAAJ,IAAIA,OAAJ,EAAIA,EAAMC,UAC9BC,MAAOV,EAAS7S,SAAS6S,EAAO,GAAI,KAAU,OAAJQ,QAAI,IAAJA,OAAA,EAAAA,EAAME,QAAS,EACzDC,MAAOT,EAAS/S,SAAS+S,EAAO,GAAI,KAAU,OAAJM,QAAI,IAAJA,OAAA,EAAAA,EAAMG,QAAS,EACzDC,KAAMT,EAAOhT,SAASgT,EAAK,GAAI,KAAU,OAAJK,QAAI,IAAJA,OAAA,EAAAA,EAAMI,OAAQ,EACnDR,KACAS,YAAgB,OAAJL,QAAI,IAAJA,OAAA,EAAAA,EAAMK,aAAc,YAE7B,GAAIrT,EAAK+G,WAAW,SAAU,CACnC,IACMsM,EADc9d,MAAM4E,KAAK6F,EAAK6S,SAAS,6BACAjc,KAAI,SAAC0I,GAAD,MAAQ,CACvD3J,EAAGgK,SAASL,EAAE,GAAI,IAClB1J,EAAG+J,SAASL,EAAE,GAAI,IAClBwT,MAAOnT,SAASL,EAAE,GAAI,QAExB4R,GAAU,SAAA8B,GAAI,MAAK,CACjBC,SAAQ,OAAED,QAAF,IAAEA,OAAF,EAAEA,EAAMC,SAChBC,OAAW,OAAJF,QAAI,IAAJA,OAAA,EAAAA,EAAME,QAAS,EACtBC,OAAW,OAAJH,QAAI,IAAJA,OAAA,EAAAA,EAAMG,QAAS,EACtBC,MAAU,OAAJJ,QAAI,IAAJA,OAAA,EAAAA,EAAMI,OAAQ,EACpBR,IAAQ,OAAJI,QAAI,IAAJA,OAAA,EAAAA,EAAMJ,KAAM,GAChBS,uBAGC,GAAiB,WAAbhB,EAAIE,KAAmB,CAChC,IAAMe,EAAejB,EAAIkB,SACzB,GAAID,GAAQA,EAAKjM,SAAS,KAAM,CAC9B,MAAiBiM,EAAK1M,MAAM,KAA5B,mBAAOsB,EAAP,KAAWC,EAAX,KAGMqL,EAA6B,CACjCP,SAAU,CAAEtd,EAHJgK,SAASuI,EAAI,IAGNtS,EAFP+J,SAASwI,EAAI,IAEH2K,MAAOrB,EAAYtM,SACrC+N,MAAO,EACPC,MAAO,EACPC,KAAM3B,EAAYtM,QAClByN,GAAI,GACJS,WAAY,IAEdnC,EAAUsC,GAEZvC,GAAe,OACO,UAAboB,EAAIE,MACbpB,EAASsC,OAAOpB,EAAIqB,SAAW,8BAGnCzB,EAAE0B,YAAY,CAAEpB,KAAM,UAEH,IAAjBxc,EAAMuB,OACR,UAAAoa,EAAUvM,eAAV,SAAmBwO,YAAY,CAAEpB,KAAM,UAAWqB,QAAS,WAErDC,EAAQ9d,EAAMa,KAAI,SAACE,EAAGiB,GAC1B,IACM2C,GADQG,EAAW9C,EAAI,IAAM,EAAIA,EAAI,IAAM,GAC/B,EAAI,EACtB,MAAM,GAAN,OAAUjB,EAAE,GAAZ,YAAkBA,EAAE,GAApB,YAA0B4D,MAEtBkZ,EAND,iBAMqBC,EAAMlN,KAAK,MANhC,UAOL,UAAA+K,EAAUvM,eAAV,SAAmBwO,YAAY,CAAEpB,KAAM,UAAWqB,aAtFtB,kDA0F1BpC,EAAWrM,SAASgM,EAAS,6BAAD,OAAU,gBAAe2C,MAAQ,KAAIJ,QAAUD,OAAO,EAAD,MA1FvD,sGA8F/B,CAACxH,EAAY2F,IAEhBhG,qBAAU,WAER,OADA4F,EAAWrM,SAAU,EACd,WACLqM,EAAWrM,SAAU,EACjBuM,EAAUvM,UACZuM,EAAUvM,QAAQ4O,YAClBrC,EAAUvM,QAAU,SAGvB,IAEHyG,qBAAU,WACR,GAAKwF,EAAL,CACA,IAAMrb,EAAQkW,EAAWlO,KAAKoH,QAAQpP,MAChCie,EAAM/H,EAAWlO,KAAKoH,QAAQtK,SAC9BoZ,EAAM5G,KAAKC,UAAUvX,GAAf,WAA4Bie,GACpCC,IAAQ3C,EAAWnM,SAAY6L,IACjCM,EAAWnM,QAAU8O,EAEjBvC,EAAUvM,SACZuM,EAAUvM,QAAQwO,YAAY,CAAEpB,KAAM,SAExCP,QAED,CAAC/F,EAAYmF,EAAaJ,EAAagB,IAc1C,IAAMkC,EAAYrC,uBAAY,SAAC7b,GAC7B,IAAMkC,EAAe,CAAClC,EAAKL,EAAGK,EAAKJ,GACnCsW,EAAcD,EAAW9C,KAAKjR,MAC7B,CAAC+T,EAAYC,IAGhBN,qBAAU,WACR,GAAK1V,GAAWA,EAAO+c,SAAvB,CACA,IAAM3T,EAAIpJ,EAAO+c,SACXlK,EAAQ,CAAC,CAAEpT,EAAG2J,EAAE3J,EAAGC,EAAG0J,EAAE1J,EAAGkd,MAAOxT,EAAEwT,QAE1C,OADA5G,EAAcD,EAAWkI,SAASpL,IAC3B,WACLmD,EAAcD,EAAWkI,SAAS,SAEnC,QAACje,QAAD,IAACA,OAAD,EAACA,EAAQ+c,WAGZ,IAcqBE,EAdfiB,EAAc,SAACtB,GACnB,OAAI9Q,KAAKqS,IAAIvB,IAAU,IACdA,EAAQ,EAAI,gBAAQ,gBAEtBA,EAAQ,EAAR,WAAgBA,GAAhB,UAA6BA,IAgBtC,OACE,gBAAC,KAAD,CAAQwB,QAAS,EAAGC,MAAM,UAA1B,UAEE,eAAC,KAAD,CAAKzd,EAAG,EAAG0d,YAAa,EAAGC,aAAa,KAAxC,SACE,gBAAC,KAAD,CAAQH,QAAS,EAAGC,MAAM,UAA1B,UACE,eAAC,KAAD,CAAMG,SAAS,KAAKC,WAAW,OAA/B,sCAEA,eAAC,KAAD,CAAQL,QAAS,EAAjB,SACE,gBAAC,KAAD,WACE,eAAC,KAAD,CAAMI,SAAS,KAAKE,GAAI,EAAxB,sCACA,eAAC,KAAD,CAAQC,UAAWzD,EAAa0D,SAAU,SAAA5T,GAAC,OAAImQ,EAAenQ,EAAE6T,OAAOC,UAAU/P,KAAK,iBAO7FjB,GACC,gBAAC,KAAD,CAAOiR,OAAO,QAAd,UACE,eAAC,KAAD,IACCjR,KAKJ9N,GACC,eAAC,KAAD,CAAKY,EAAG,EAAG0d,YAAa,EAAGC,aAAa,KAAxC,SACE,gBAAC,KAAD,CAAQH,QAAS,EAAGC,MAAM,UAA1B,UACE,eAAC,KAAD,CAAMG,SAAS,KAAKC,WAAW,OAA/B,sCAGA,gBAAC,KAAD,CAAQL,QAAS,EAAjB,UACE,gBAAC,KAAD,CAAMI,SAAS,KAAf,UACE,oDADF,IACwBxe,EAAOgd,SAE/B,gBAAC,KAAD,CAAMwB,SAAS,KAAf,UACE,oDADF,KAzCSvB,EA0C2Bjd,EAAOid,MAzCjDA,GAAS,IAAe,GAAN,QAAWA,EAAQ,KAAS+B,QAAQ,GAApC,KAClB/B,GAAS,IAAY,GAAN,QAAWA,EAAQ,KAAM+B,QAAQ,GAAjC,KACZ/B,EAAM9c,eAyCH,gBAAC,KAAD,CAAMqe,SAAS,KAAf,UACE,oDADF,IACwBxe,EAAOkd,WAKhCld,EAAO+c,UACN,eAAC,KAAD,CAAKnc,EAAG,EAAGqe,GAAG,UAAUV,aAAa,KAArC,SACE,gBAAC,KAAD,CAAQ7F,QAAQ,gBAAhB,UACE,gBAAC,KAAD,CAAQ2F,MAAM,QAAQD,QAAS,EAA/B,UACE,eAAC,KAAD,CAAMI,SAAS,KAAKC,WAAW,OAA/B,sCACA,gBAAC,KAAD,CAAMD,SAAS,KAAf,UACGjB,OAAO2B,aAAa,GAAKlf,EAAO+c,SAAStd,GAAIO,EAAO+c,SAASrd,EAAI,KAEpE,gBAAC,KAAD,CAAM8e,SAAS,KAAK1F,MAAM,WAA1B,2BACOoF,EAAYle,EAAO+c,SAASH,aAGrC,eAAC,KAAD,CACE/I,YAAY,OACZ9E,KAAK,KACL+E,QAAS,kBAAMkK,EAAUhe,EAAO+c,WAHlC,2CAYL/c,EAAO0c,GAAGtb,OAAS,GAClB,gBAAC,KAAD,WACE,eAAC,KAAD,CAAMod,SAAS,KAAKC,WAAW,OAAOC,GAAI,EAA1C,0BACA,eAAC,KAAD,CAAMF,SAAS,KAAK1F,MAAM,WAA1B,SACG9Y,EAAO0c,GAAGhc,KAAI,SAAC0I,EAAGvH,GAAJ,gBACV0b,OAAO2B,aAAa,GAAK9V,EAAE3J,IADjB,OACsB2J,EAAE1J,EAAI,GAD5B,OACgCmC,EAAI7B,EAAO0c,GAAGtb,OAAS,EAAI,IAAM,OAC7EqP,KAAK,SAMbzQ,EAAOmd,WAAW/b,OAAS,GAC1B,gBAAC,KAAD,WACE,eAAC,KAAD,CAAMod,SAAS,KAAKC,WAAW,OAAOC,GAAI,EAA1C,sCACA,gBAAC,KAAD,CAAO3P,KAAK,KAAKoK,QAAQ,SAAzB,UACE,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,2BACA,eAAC,KAAD,2BACA,eAAC,KAAD,2BACA,eAAC,KAAD,gCAGJ,eAAC,KAAD,UACGnZ,EAAOmd,WAAWxa,MAAM,EAAG,IAAIjC,KAAI,SAACZ,EAAM+U,GAAP,OAClC,gBAAC,KAAD,WACE,eAAC,KAAD,UAAKA,EAAQ,IACb,gBAAC,KAAD,WAAK0I,OAAO2B,aAAa,GAAKpf,EAAKL,GAAIK,EAAKJ,EAAI,KAChD,eAAC,KAAD,UAAKwe,EAAYpe,EAAK8c,SACtB,eAAC,KAAD,UACE,eAAC,KAAD,CACE7N,KAAK,KACL8E,YAAY,OACZsF,QAAQ,UACRrF,QAAS,kBAAMkK,EAAUle,IAJ3B,8BALK+U,uB,0FC9SzBsK,GAAiB,WACrB,MAAkDjG,qBAAWnE,IAArDI,EAAR,EAAQA,iBAAkBC,EAA1B,EAA0BA,oBACpBgK,EAAe,IAAI3a,EAAK,CAAE5E,MAAOsV,EAAiBtV,QAAS2Q,OAAO,KACxE,OACE,gBAAC,KAAD,CAAYzB,KAAK,KAAjB,UACE,eAAC,KAAD,UACE,eAAC,KAAD,MAEF,eAAC,KAAD,CAAOsN,KAAK,SAASgD,YAAY,qBAAqB9P,YAAU,EAACkG,MAAO2J,IACxE,eAAC,KAAD,UACE,eAAC,KAAD,CACET,UAAWxJ,EAAiBX,SAC5BoK,SAAU,SAAA5T,GAAC,OAAIoK,EAAoBD,EAAiBmK,YAAYtU,EAAE6T,OAAOC,mBAO7ES,GAAkB,WACtB,MAAkDrG,qBAAWnE,IAArDI,EAAR,EAAQA,iBAAkBC,EAA1B,EAA0BA,oBACpBoK,EAAQpH,mBAAQ,kBAAM,IAAI9R,IAAe,IAE/C,EAA0BkP,mBAAiB,IAA3C,mBAAOC,EAAP,KAAcgK,EAAd,KACA,EAA8BjK,mBAAsB,IAApD,mBAAOtP,EAAP,KAAgBwZ,EAAhB,KACMC,EAAoBC,eAkBpBlX,EAAWyM,EAAiBzM,SAClCgN,qBAAU,WACgB,kBAAbhN,GACV,sBAAC,8BAAA3F,EAAA,sEACqByc,EAAMK,UAAUnX,GADrC,OACM8E,EADN,OAEMsS,EAAatS,EAAM,UAAMA,EAAOvC,KAAKoB,OAAlB,YAA4BmB,EAAO/B,QAAQY,QAAW,GAC/EoT,EAASK,GAHT,0CAAD,KAKA,CAACpX,IAEJ,IAAMqX,EAAiB1E,iBAAO,MAC9B,OACE,gBAAC,KAAD,CAAS2E,gBAAiBD,EAAgBE,OAAQN,EAAkBM,OAApE,UACE,eAAC,KAAD,UACE,gBAAC,KAAD,CAAYlR,KAAK,KAAjB,UACE,eAAC,KAAD,UACE,eAAC,KAAD,MAEF,eAAC,KAAD,CACEmR,IAAKH,EACL1D,KAAK,SACLgD,YAAY,gBACZ5J,MAAOA,EACP3B,QAAS6L,EAAkBQ,OAC3BvB,SAAU,SAAA5T,GAAC,OAzCJ,SAACyK,GAChBgK,EAAShK,GACR,sBAAC,4BAAA1S,EAAA,6DACMqd,EAAW3K,EAAMpJ,OAAOqE,MAAM,OADpC,KAEAgP,EAFA,SAEiBF,EAAMa,cAAcD,GAFrC,4EAAD,GAuCsBxB,CAAS5T,EAAE6T,OAAOpJ,UAEnC,eAAC,KAAD,UACE,eAAC,KAAD,CACE1G,KAAK,KACL+E,QAnCU,WACpBsB,EAAoBD,EAAiBiE,iBAAYzV,IACjD8b,EAAS,IACTE,EAAkBW,WAiCRC,cAAwC5c,IAA9BwR,EAAiBzM,WAA2BiX,EAAkBM,gBAKhF,gBAAC,KAAD,WACE,eAAC,KAAD,IACA,eAAC,KAAD,UACE,eAAC,KAAD,CAAO9G,QAAQ,WAAWpK,KAAK,KAA/B,SACE,eAAC,KAAD,UACG7I,EAAQxF,KAAI,SAACE,EAAGiB,GAAJ,OACX,eAAC,KAAD,CAAYiS,QAAS,kBAnDdtG,EAmDgC5M,EAlDnDwU,EAAoBD,EAAiBiE,YAAY5L,EAAOnN,UACxDsf,EAAkBW,UAFA,IAAC9S,GAmDoCgT,OAAQ,CAAEvB,GAAI,YAAzD,SACE,eAAC,KAAD,oBAAQre,EAAEqK,KAAKoB,OAAf,YAAyBzL,EAAE6K,QAAQY,WAD5BxK,mBAYVwX,GAzGK,WAClB,OACE,gBAAC,KAAD,CAAYe,MAAM,OAAOqG,QAAS,EAAGrC,QAAS,EAAGsC,cAAc,QAA/D,UACE,eAAC,GAAD,IACA,eAAC,GAAD,Q,6BCaAC,GAAgF,SAAC,GAGhF,IAFLC,EAEI,EAFJA,MACAC,EACI,EADJA,SAEA,OACE,eAAC,IAAD,UACE,gBAAC,KAAD,CAAazC,QAAS,EAAGrP,KAAK,KAAKoK,QAAQ,QAA3C,UACE,eAAC,KAAD,CACE2H,aAAW,QACXC,KAAM,eAAC,KAAD,IACNC,WAAYJ,EAAMtM,QAClBR,QAAS,kBAAM+M,EAASD,EAAMK,cAEhC,eAAC,KAAD,CACEH,aAAW,OACXC,KAAM,eAAC,KAAD,IACNC,WAAYJ,EAAMtM,QAClBR,QAAS,kBAAM+M,EAASD,EAAM9D,WAEhC,eAAC,KAAD,CAAQkE,YAAU,EAAC5G,MAAM,OAAzB,SACGwG,EAAMzgB,aAET,eAAC,KAAD,CACE2gB,aAAW,OACXC,KAAM,eAAC,KAAD,IACNC,WAAYJ,EAAMvR,OAClByE,QAAS,kBAAM+M,EAASD,EAAMM,WAEhC,eAAC,KAAD,CACEJ,aAAW,OACXC,KAAM,eAAC,KAAD,IACNC,WAAYJ,EAAMvR,OAClByE,QAAS,kBAAM+M,EAASD,EAAM7Q,mBAOlCoR,GAAwC,SAAC,GAAiB,IAAfla,EAAc,EAAdA,QACzCqS,EAAKlB,mBAAQ,kBAAM,IAAI9R,IAAe,IAC5C,EAA0BkP,mBAAqB,IAA/C,mBAAOpP,EAAP,KAAcgb,EAAd,KACA1L,qBAAU,WACP,sBAAC,sBAAA3S,EAAA,kEAAYqe,EAAZ,SAA2B9H,EAAGS,aAAa9S,GAA3C,sGAAD,KACA,CAACA,IACJ,MAAuDiS,qBAAWpD,IAA1DC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cAAeE,EAAnC,EAAmCA,gBAC7BmL,EAAgBtL,EAAWzD,OAASF,GAC1C,EAAoCoD,qBAApC,mBAAO8L,EAAP,KAAmBC,EAAnB,KA6BA,OACE,gBAAC,KAAD,CAAOnH,MAAM,OAAOrL,KAAK,WAAWoK,QAAQ,WAA5C,UACE,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,mBACA,eAAC,KAAD,oBACA,eAAC,KAAD,CAAIqI,QAAS,EAAb,oBACA,eAAC,KAAD,oBACA,eAAC,KAAD,mBACA,eAAC,KAAD,uBAGJ,2BAAUlH,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,UACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,QACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,UACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,eAAC,KAAD,UACGhU,EAAM1F,KAAI,SAAC0G,EAAG2W,GACb,IAAM0D,EAAOJ,EAAa,OAAGC,QAAH,IAAGA,OAAH,EAAGA,EAAYxS,OAASiH,EAAWlO,KAAKiH,OAC5D4S,EAAOL,EAAgBtL,EAAWlO,KAAKiH,YAASnL,EACtD,OACE,gBAAC,KAAD,CAEEmQ,QAAS,kBAvDL,SAAC1M,GACf,IAAMua,EAAY,OAAGL,QAAH,IAAGA,IAAcvL,EAAWlO,KACxC+Z,EAAc,IAAIlT,GAAU,CAChCC,KAAM,IAAIlK,EAAK,CAAE5E,MAAOuH,EAAEvH,QAC1BiP,OAAQ1H,EAAE/G,GACVuO,OAAQmH,EAAWlO,KAAKoH,QAAQF,OAE7BsS,GACHE,EAAcxL,EAAWlO,MAE3BmO,EAAcD,EAAW8L,QAAQD,GAAaE,QAAQ1P,KAEtD,IAUM6D,EAAe,IAAIlC,GAAa,CACpCC,GAAI,IAAIJ,GAAc,CAAE9J,KAAM,OAAQ+J,YAAa,OAAQC,QAX9C,WACbkC,EAAc,IAAI3D,GAAW,CAAExK,KAAM+Z,KACrCL,OAAc5d,GACduS,OAAgBvS,MAShBsQ,OAAQ,IAAIL,GAAc,CAAE9J,KAAM,SAAUgK,QAP7B,WACfkC,EAAcD,EAAW8L,QAAQF,GAAcG,QAAQ1P,KACvDmP,OAAc5d,GACduS,OAAgBvS,QAMlBuS,EAAgBD,GA6BSnC,CAAQ1M,IACvB6X,GAAI7X,EAAE/G,KAAOohB,EAAO,YAAcra,EAAE/G,KAAOqhB,EAAO,kBAAe/d,EACjE6c,OAAQ,CAAEvB,GAAI,YAJhB,UAME,eAAC,KAAD,CAAIzE,WAAS,EAAb,SAAepT,EAAEG,WAAWoB,QAC5B,eAAC,KAAD,UAAKyD,EAAgBhF,EAAE5H,SACvB,eAAC,KAAD,UACE,eAAC,GAAD,CAASiZ,IAAKrR,EAAEjF,aAElB,eAAC,KAAD,UAAKiF,EAAEvH,MAAMuB,OAAOjB,aACpB,eAAC,KAAD,UACE,eAAC,GAAD,CAASsY,IAAKrR,EAAEhF,aAElB,eAAC,KAAD,UAAKgK,EAAgBhF,EAAEC,SACvB,eAAC,KAAD,CAAImT,WAAS,EAAb,SAAelO,EAAclF,EAAEI,KAAKyD,QACpC,eAAC,KAAD,CAAIuP,WAAS,EAAb,SAAepT,EAAEK,QAAQ0D,KAAK4W,kBAhBzBhE,YAyBJ1E,GA9IK,WAClB,IAAQhE,EAAsB6D,qBAAWnE,IAAjCM,kBACR,EAA0BG,mBAAqB,IAAItB,IAAnD,mBAAO0M,EAAP,KAAcC,EAAd,KACAnL,qBAAU,WACRmL,EAAS,IAAI3M,GAAW,CAAErG,IAAKwH,EAAkBpO,QAAQ7F,YACxD,CAACiU,EAAkBpO,UACtB,IAAMA,EAAUoO,EAAkBpO,QAAQtE,MAAMie,EAAMoB,UAAWpB,EAAMqB,SACvE,OACE,uCACE,eAAC,GAAD,CAAiBrB,MAAOA,EAAOC,SAAUA,IACzC,eAAC,GAAD,CAAY5Z,QAASA,QChBZoS,GAfK,WAClB,IAAQhE,EAAsB6D,qBAAWnE,IAAjCM,kBACR,OACE,gBAAC,KAAD,CAAO+E,MAAM,OAAOiE,MAAM,SAA1B,UACE,eAAC6D,GAAD,IACC7M,EAAkBvH,OACjB,eAAC,KAAD,CAAMgL,MAAM,WAAWqJ,GAAG,OAA1B,SACG9M,EAAkBvH,QAGtBuH,EAAkBpO,QAAQ7F,OAAS,GAAK,eAAC,GAAD,Q,6BC4GhCiY,GApGK,WAClB,MAA0C7D,oBAAkB,GAA5D,mBAAO4M,EAAP,KAAsBC,EAAtB,KACA,EAA8C7M,mBAAiB,GAA/D,mBAAO8M,EAAP,KAAwBC,EAAxB,KACA,EAAkD/M,mBAAiB,GAAnE,mBAAOgN,EAAP,KAA0BC,EAA1B,KACA,EAAkCjN,oBAAkB,GAApD,mBAAOkN,EAAP,KAAkBC,EAAlB,KACMC,EAAsBhD,eAEtBiD,EAAU,uCAAG,kCAAA9f,EAAA,yDACX+f,EAAOC,SAASC,eAAe,YAEvB,QADRC,EAFW,OAEHH,QAFG,IAEHA,OAFG,EAEHA,EAAMG,QACmB,IAAjBA,EAAM7hB,OAHX,uBAIfihB,GAAiB,GAJF,iCAOjBO,EAAoBzC,SAEpB7Z,EAAY4c,QACN1D,EAAQ,IAAIlZ,EAVD,UAWXkZ,EAAM2D,aAAaF,EAAM,IAAI,SAAAriB,GAAC,OAAI2hB,EAAmB3hB,MAX1C,eAajB6L,GAAiByW,QACXE,EAAa,IAAI3W,GAdN,UAeX2W,EAAWC,qBAAoB,SAAAziB,GAAC,OAAI6hB,EAAqB7hB,MAf9C,QAiBjB+hB,GAAa,GAjBI,4CAAH,qDAmBhB,OACE,uCACE,gBAAC,KAAD,WACE,eAAC,KAAD,CAAShK,GAAG,KAAK5J,KAAK,KAAtB,+BAGA,gBAAC,KAAD,CAAOuU,UAAQ,EAAf,UACE,gBAAC,KAAD,CAAYvU,KAAK,KAAjB,UACE,gBAAC,KAAD,CAAgBqL,MAAM,OAAtB,UACE,eAAC,KAAD,IADF,gBAGA,eAAC,KAAD,CACE/Z,GAAG,WACHgc,KAAK,OACLkH,UAAWnB,EACXxD,SAAU,kBAAMyD,GAAiB,SAGrC,eAAC,KAAD,CAAQtT,KAAK,KAAK8E,YAAY,OAAOC,QAAS+O,EAA9C,qBAIF,eAAC,KAAD,CAASlK,GAAG,KAAK5J,KAAK,KAAtB,qBAGA,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,gBAAC,KAAD,yFACmF,IACjF,uCAFF,2JAKA,gBAAC,KAAD,2DACqD,IACnD,eAAC,KAAD,CAAM0L,KAAK,wBAAwB3B,MAAM,WAAW4B,YAAU,EAA9D,mCAFF,8DAUN,gBAAC,KAAD,CACEuF,OAAQ2C,EAAoB3C,OAC5BK,QAASsC,EAAoBtC,QAC7BkD,YAAU,EACVC,qBAAqB,EAJvB,UAME,eAAC,KAAD,IACA,gBAAC,KAAD,WACE,eAAC,KAAD,CAAa9K,GAAG,KAAhB,SAAsB+J,EAAY,aAAe,eACjD,eAAC,KAAD,UACE,gBAAC,KAAD,CAAOtE,QAAQ,OAAf,UACE,eAAC,KAAD,CAASzF,GAAG,KAAK5J,KAAK,KAAK2P,GAAG,OAA9B,gCAGA,eAAC,KAAD,CAAUjJ,MAAO6M,IACjB,eAAC,KAAD,CAAS3J,GAAG,KAAK5J,KAAK,KAAK2P,GAAG,OAA9B,gCAGA,eAAC,KAAD,CAAUjJ,MAAO+M,SAGrB,eAAC,KAAD,UACE,eAAC,KAAD,CAAQ1O,QAAS,kBAAMsC,OAAOC,SAASqN,UAAU1C,YAAa0B,EAA9D,oC,oBCvENiB,GAAuF,SAAC,GAIvF,IAHLvd,EAGI,EAHJA,MACAvG,EAEI,EAFJA,MACA6I,EACI,EADJA,SAEMkb,EAAaxd,EAAMf,QAAO,SAAA+B,GAAC,OAAIA,EAAE5H,MAAMa,KAAOqI,KAC9Cmb,EAAazd,EAAMf,QAAO,SAAA+B,GAAC,OAAIA,EAAEC,MAAMhH,KAAOqI,KAC9Cob,EAAY7hB,EAAS2hB,GACrBG,EAAY9hB,EAAS4hB,GACrBG,EAAaxhB,EAAmBohB,EAAY/jB,GAAO8C,MAAM,EAAG,GAC5DshB,EAAazhB,EAAmBqhB,EAAYhkB,GAAO8C,MAAM,EAAG,GAC5DuhB,EAAcpY,KAAKyM,IAAL,MAAAzM,KAAI,YACnBkY,EAAWtjB,KAAI,mCAAKkQ,GAAL,kBAAY9E,KAAKyM,IAAI3H,EAAEzO,SAAUyO,EAAExO,SAAUwO,EAAEvO,UAD3C,mBAEnB4hB,EAAWvjB,KAAI,mCAAKkQ,GAAL,kBAAY9E,KAAKyM,IAAI3H,EAAEzO,SAAUyO,EAAExO,SAAUwO,EAAEvO,YAEnE,OACE,gBAAC,KAAD,CAAO+X,MAAM,OAAOgE,QAAQ,OAAOpE,GAAG,OAAtC,UACE,eAAC,GAAD,CACEmK,MAAO,CAAEC,MAAO,aAAcpW,MAAO8V,EAAUvhB,KAC/CkW,IAAK,CAAE2L,MAAO,MAAOpW,MAAO8V,EAAU3hB,SAAU2W,MAAO,YACvDuL,KAAM,CAAED,MAAO,OAAQpW,MAAO8V,EAAU1hB,SAAU0W,MAAO,aACzDzW,KAAM,CAAE+hB,MAAO,OAAQpW,MAAO8V,EAAUzhB,KAAMyW,MAAO,cAEvD,eAAC,GAAD,CAAqBwL,MAAON,EAAYE,YAAaA,IACrD,eAAC,KAAD,IACA,eAAC,GAAD,CACEC,MAAO,CAAEC,MAAO,aAAcpW,MAAO+V,EAAUxhB,KAC/CkW,IAAK,CAAE2L,MAAO,MAAOpW,MAAO+V,EAAU3hB,SAAU0W,MAAO,aACvDuL,KAAM,CAAED,MAAO,OAAQpW,MAAO+V,EAAU5hB,SAAU2W,MAAO,YACzDzW,KAAM,CAAE+hB,MAAO,OAAQpW,MAAO+V,EAAU1hB,KAAMyW,MAAO,cAEvD,eAAC,GAAD,CAAqBwL,MAAOL,EAAYC,YAAaA,EAAaK,cAAY,QAK9EC,GAA4D,SAAC,GAAsB,IAApBpe,EAAmB,EAAnBA,MAAOvG,EAAY,EAAZA,MACpE4kB,EAAOxiB,EAASmE,GAChBke,EAAQ9hB,EAAmB4D,EAAOvG,GAAO8C,MAAM,EAAG,IAClDuhB,EAAcpY,KAAKyM,IAAL,MAAAzM,KAAI,YAAQwY,EAAM5jB,KAAI,mCAAKkQ,GAAL,kBAAY9E,KAAKyM,IAAI3H,EAAEzO,SAAUyO,EAAExO,SAAUwO,EAAEvO,WACzF,OACE,gBAAC,KAAD,CAAO+X,MAAM,OAAOgE,QAAQ,OAAOpE,GAAG,OAAtC,UACE,eAAC,GAAD,CACEmK,MAAO,CAAEC,MAAO,MAAOpW,MAAOyW,EAAKliB,KACnCkW,IAAK,CAAE2L,MAAO,YAAapW,MAAOyW,EAAKtiB,SAAU2W,MAAO,YACxDuL,KAAM,CAAED,MAAO,YAAapW,MAAOyW,EAAKriB,SAAU0W,MAAO,aACzDzW,KAAM,CAAE+hB,MAAO,OAAQpW,MAAOyW,EAAKpiB,KAAMyW,MAAO,cAElD,eAAC,GAAD,CAAqBwL,MAAOA,EAAOJ,YAAaA,QAKhDQ,GAA+D,SAAC,GAAyB,IAAvBte,EAAsB,EAAtBA,MAAOsC,EAAe,EAAfA,SACvEkb,EAAaxd,EAAMf,QAAO,SAAA+B,GAAC,OAAIA,EAAE5H,MAAMa,KAAOqI,KAC9Cmb,EAAazd,EAAMf,QAAO,SAAA+B,GAAC,OAAIA,EAAEC,MAAMhH,KAAOqI,KAC9Cob,EAAY7hB,EAAS2hB,GACrBG,EAAY9hB,EAAS4hB,GAC3B,OACE,gBAAC,KAAD,CAAOzJ,MAAM,OAAOgE,QAAQ,OAAOpE,GAAG,OAAtC,UACE,eAAC,GAAD,CACEmK,MAAO,CAAEC,MAAO,aAAcpW,MAAO8V,EAAUvhB,KAC/CkW,IAAK,CAAE2L,MAAO,MAAOpW,MAAO8V,EAAU3hB,SAAU2W,MAAO,YACvDuL,KAAM,CAAED,MAAO,OAAQpW,MAAO8V,EAAU1hB,SAAU0W,MAAO,aACzDzW,KAAM,CAAE+hB,MAAO,OAAQpW,MAAO8V,EAAUzhB,KAAMyW,MAAO,cAEvD,eAAC,KAAD,IACA,eAAC,GAAD,CACEqL,MAAO,CAAEC,MAAO,aAAcpW,MAAO+V,EAAUxhB,KAC/CkW,IAAK,CAAE2L,MAAO,MAAOpW,MAAO+V,EAAU3hB,SAAU0W,MAAO,aACvDuL,KAAM,CAAED,MAAO,OAAQpW,MAAO+V,EAAU5hB,SAAU2W,MAAO,YACzDzW,KAAM,CAAE+hB,MAAO,OAAQpW,MAAO+V,EAAU1hB,KAAMyW,MAAO,kBAmBvD6L,GAA+B,SAAC,GAAgC,IAA9BR,EAA6B,EAA7BA,MAAO1L,EAAsB,EAAtBA,IAAK4L,EAAiB,EAAjBA,KAAMhiB,EAAW,EAAXA,KACxD,OACE,gBAAC,KAAD,CAAYoe,QAAS,EAAGrG,MAAM,OAAOwK,UAAU,SAA/C,UACE,gBAAC,KAAD,CAAMC,UAAWV,EAAMrL,MAAvB,UACE,eAAC,KAAD,UAAYqL,EAAMC,QAClB,eAAC,KAAD,UAAaD,EAAMnW,WAErB,gBAAC,KAAD,CAAM6W,UAAWpM,EAAIK,MAArB,UACE,eAAC,KAAD,UAAYL,EAAI2L,QAChB,eAAC,KAAD,UAAa3L,EAAIzK,QACjB,gBAAC,KAAD,YAAiB,IAAMyK,EAAIzK,MAASmW,EAAMnW,OAAOgR,QAAQ,GAAzD,UAEF,gBAAC,KAAD,CAAM6F,UAAWR,EAAKvL,MAAtB,UACE,eAAC,KAAD,UAAYuL,EAAKD,QACjB,eAAC,KAAD,UAAaC,EAAKrW,QAClB,gBAAC,KAAD,YAAiB,IAAMqW,EAAKrW,MAASmW,EAAMnW,OAAOgR,QAAQ,GAA1D,UAEF,gBAAC,KAAD,CAAM6F,UAAWxiB,EAAKyW,MAAtB,UACE,eAAC,KAAD,UAAYzW,EAAK+hB,QACjB,eAAC,KAAD,UAAa/hB,EAAK2L,QAClB,gBAAC,KAAD,YAAiB,IAAM3L,EAAK2L,MAASmW,EAAMnW,OAAOgR,QAAQ,GAA1D,cAMF8F,GAID,SAAC,GAA0C,IAAxCR,EAAuC,EAAvCA,MAAOJ,EAAgC,EAAhCA,YAAaK,EAAmB,EAAnBA,aAC1B,EAAsCrL,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cAEpB,OACE,gBAAC,KAAD,CAAOoE,MAAM,OAAOrL,KAAK,WAAWoK,QAAQ,WAA5C,UACE,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,mBACA,eAAC,KAAD,kBACA,eAAC,KAAD,UAAKoL,EAAe,SAAW,WAC/B,eAAC,KAAD,UAAKA,EAAe,SAAW,WAC/B,eAAC,KAAD,wBAGJ,2BAAUjK,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,2BAAUE,KAAM,EAAGC,MAAO,CAAEH,MAAO,SACnC,eAAC,KAAD,UACGkK,EAAM5jB,KAAI,WAASqd,GAAS,IAAD,mBAAfnd,EAAe,KAAZgQ,EAAY,KACpBpR,EAAQ,CAAEsZ,MAAO,WAAY9K,MAAO4C,EAAEzO,UACtCkF,EAAQ,CAAEyR,MAAO,YAAa9K,MAAO4C,EAAExO,UAC7C,EAAoBmiB,EAAe,CAACld,EAAO7H,GAAS,CAACA,EAAO6H,GAA5D,mBAAOoR,EAAP,KAAY4L,EAAZ,KACA,OACE,gBAAC,KAAD,CAAc7D,OAAQ,CAAEvB,GAAI,YAAcnL,QAAS,kBAvB7C,SAAClT,GAAD,OAAcoV,EAAcD,EAAW+L,QAAQ1P,IAAgBa,KAAKrS,IAuBjBkT,CAAQlT,IAAjE,UACE,eAAC,KAAD,CAAI4Z,WAAS,EAAb,SAAe9I,YAAU9Q,GAAGT,aAC5B,eAAC,KAAD,CAAIqa,WAAS,EAAb,SAAe5J,EAAErO,MACjB,eAAC,KAAD,CAAIiY,WAAS,EAAb,SACiB,IAAd/B,EAAIzK,OACH,eAAC,GAAD,CAAe8K,MAAOL,EAAIK,MAAO9K,MAAOyK,EAAIzK,MAAOkW,YAAaA,MAGpE,eAAC,KAAD,CAAI1J,WAAS,EAAb,SACkB,IAAf6J,EAAKrW,OACJ,eAAC,GAAD,CAAe8K,MAAOuL,EAAKvL,MAAO9K,MAAOqW,EAAKrW,MAAOkW,YAAaA,MAGtE,eAAC,KAAD,CAAI1J,WAAS,EAAb,SACc,IAAX5J,EAAEvO,MACD,eAAC,GAAD,CAAeyW,MAAM,WAAW9K,MAAO4C,EAAEvO,KAAM6hB,YAAaA,QAfzDnG,YA0BfgH,GAA2E,SAAC,GAI3E,IAHLjM,EAGI,EAHJA,MACA9K,EAEI,EAFJA,MACAkW,EACI,EADJA,YAEA,OACE,eAAC,IAAD,UACE,eAAC,KAAD,CACEc,gBAAiBlM,EACjBsB,MAAK,WAAO,IAAMpM,EAASkW,GAAalF,UAAnC,KACLtG,QAAQ,SACRuM,aAAa,SAJf,SAMGjX,OAMMqL,GAjNK,WAClB,IAAMC,EAAKlB,mBAAQ,kBAAM,IAAI9R,IAAe,IAC5C,EAAgD4S,qBAAWnE,IAAnDI,EAAR,EAAQA,iBAAkBE,EAA1B,EAA0BA,kBAC1B,EAA0BG,mBAAqB,IAA/C,mBAAOpP,EAAP,KAAcgb,EAAd,KACA1L,qBAAU,WACP,sBAAC,sBAAA3S,EAAA,kEAAYqe,EAAZ,SAA2B9H,EAAGS,aAAa1E,EAAkBpO,SAA7D,sGAAD,KACA,CAACoO,EAAkBpO,UACtB,MAA4BkO,EAAiB1S,MAArC5C,EAAR,EAAQA,MAAO6I,EAAf,EAAeA,SACf,YAAc/E,IAAV9D,QAAoC8D,IAAb+E,EAClB,eAAC,GAAD,CAAyBtC,MAAOA,EAAOvG,MAAOA,EAAO6I,SAAUA,SACnD/E,IAAV9D,QAAoC8D,IAAb+E,EACzB,eAAC,GAAD,CAAgBtC,MAAOA,EAAOvG,MAAOA,SACzB8D,IAAV9D,QAAoC8D,IAAb+E,EACzB,eAAC,GAAD,CAAiBtC,MAAOA,EAAOsC,SAAUA,IAEzC,gCClBI2Q,GAfK,WAClB,IAAQhE,EAAsB6D,qBAAWnE,IAAjCM,kBACR,OACE,gBAAC,KAAD,CAAO+E,MAAM,OAAOiE,MAAM,SAA1B,UACE,eAAC6D,GAAD,IACC7M,EAAkBvH,OACjB,eAAC,KAAD,CAAMgL,MAAM,WAAWqJ,GAAG,OAA1B,SACG9M,EAAkBvH,QAGtBuH,EAAkBpO,QAAQ7F,OAAS,GAAK,eAAC8jB,GAAD,QCezCC,GAAmB,WACvB,MAAoCjM,qBAAWnE,IAAvCE,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,aACnB,OACE,gBAAC,IAAD,CACEkF,MAAM,OACNvF,MAAOI,EAAUJ,MACjB+J,SAAU,SAAA/J,GAAK,OAAIK,EAAaD,EAAUmQ,SAASvQ,KAHrD,UAKE,eAAC,IAAD,UACGI,EAAUL,MAAMlU,KAAI,SAACuK,EAAM8S,GAAP,OACnB,eAAC,IAAD,UAAgBsH,GAAWpa,IAAjB8S,QAGd,eAAC,IAAD,UACG9I,EAAUL,MAAMlU,KAAI,SAACuK,EAAM8S,GAC1B,OAAQ9S,GACN,KAAKyJ,GACH,OACE,eAAC,IAAD,CAAoB4Q,GAAI,EAAxB,SACE,eAACC,GAAD,KADaxH,GAInB,KAAKrJ,GACH,OACE,eAAC,IAAD,CAAoB4Q,GAAI,EAAxB,SACE,eAACE,GAAD,KADazH,GAInB,KAAKrJ,GACH,OACE,eAAC,IAAD,CAAoB4Q,GAAI,EAAxB,SACE,eAACG,GAAD,KADa1H,GAInB,KAAKrJ,GACH,OACE,eAAC,IAAD,CAAoB4Q,GAAI,EAAxB,SACE,eAAC,GAAD,KADavH,GAInB,KAAKrJ,GACH,OACE,eAAC,IAAD,CAAoB4Q,GAAI,EAAxB,SACE,eAACI,GAAD,KADa3H,GAInB,QACE,OAAO,yCAQfsH,GAAa,SAACzU,GAAD,OAAuBA,EAAE+U,OAAO,GAAG5D,cAAgBnR,EAAEjO,MAAM,IAE/D0W,GA7EK,WAAO,IAAD,EAClBC,EAAKlB,mBAAQ,kBAAM,IAAI3L,KAAoB,IACzCsJ,EAAemD,qBAAWpD,IAA1BC,WACR,EACEmD,qBAAWnE,IADLI,EAAR,EAAQA,iBAAkBC,EAA1B,EAA0BA,oBAAqBE,EAA/C,EAA+CA,qBAEzCsQ,EAAa7P,EAAWlO,KAAKoH,QAAQpP,MACrC4C,EAAQ0S,EAAiB1S,MAW/B,OAVAiT,qBAAU,WAERN,EAAoBD,EAAiB0Q,SAASD,MAC7C,CAACA,EAAWxkB,SACfsU,qBAAU,WACP,sBAAC,kCAAA3S,EAAA,sEACkCuW,EAAGwM,OAAOrjB,GAD5C,gBACQoL,EADR,EACQA,IAAKD,EADb,EACaA,IAAKE,EADlB,EACkBA,MAClBwH,EAAqB,IAAIb,GAAkB,CAAE5G,MAAK5G,QAAS2G,EAAKE,WAFhE,0CAAD,KAIA,WAACrL,EAAM5C,aAAP,aAAC,EAAaM,WAAYsC,EAAMiG,WAC5B,eAAC,GAAD,KCLHqd,I,OAAW,WACf,IAAM5N,EAASe,qBAAWjB,IAC1B,OACE,uBACExY,EAAG,EACHC,EAAG,EACH0a,MAAOjC,EAAOX,EACdwO,OAAQ7N,EAAOX,EACfyO,GAAI9N,EAAOV,EAAI,EACfyO,GAAI/N,EAAOV,EAAI,EACf0O,OAAO,OACP5mB,KAAK,eASL6mB,GAA0B,SAAC,GAAgB,IAAdD,EAAa,EAAbA,OAC3BhO,EAASe,qBAAWjB,IACpBoO,EAAgBlO,EAAO/T,QAAQ1D,KAAI,SAACjB,EAAGse,GAAJ,OACvC,uBAEEuI,GAAInO,EAAOR,GAAGlY,GACd8mB,GAAIpO,EAAOP,GAAG,GACd4O,GAAIrO,EAAOR,GAAGlY,GACdgnB,GAAItO,EAAOP,GAAGtY,IAAa,GAC3B6mB,OAAQA,EACRO,cAAc,QACdC,YAAaxO,EAAOyO,kBAPf7I,MAUH8I,EAAkB1O,EAAO/T,QAAQ1D,KAAI,SAAChB,EAAGqe,GAAJ,OACzC,uBAEEuI,GAAInO,EAAOR,GAAG,GACd4O,GAAIpO,EAAOP,GAAGlY,GACd8mB,GAAIrO,EAAOR,GAAGrY,IAAa,GAC3BmnB,GAAItO,EAAOP,GAAGlY,GACdymB,OAAQA,EACRO,cAAc,QACdC,YAAaxO,EAAOyO,kBAPf7I,MAUT,OACE,+BACGsI,EACAQ,MAKDC,GAAY,WAChB,IAAM3O,EAASe,qBAAWjB,IAQ1B,OACE,6BARa,CACb,CAAC,EAAG,GACJ,CAAC,EAAG,IACJ,CAAC,EAAG,GACJ,CAAC,GAAI,GACL,CAAC,GAAI,KAIKvX,KAAI,WAASqd,GAAT,uBAAEte,EAAF,KAAKC,EAAL,YACV,yBAEEiY,GAAIQ,EAAOR,GAAGlY,GACdmY,GAAIO,EAAOP,GAAGlY,GACd0F,EAAG+S,EAAOV,EAAI,GACd0O,OAAO,OACP5mB,KAAK,QALAwe,SAYTgJ,GAA2B,SAAC,GAAgB,IAAdZ,EAAa,EAAbA,OAC5BhO,EAASe,qBAAWjB,IACpB+O,EAAW7O,EAAO/T,QAAQ1D,KAAI,SAACjB,EAAGse,GAAJ,OAClC,uBAEEte,EAAG0Y,EAAOR,GAAGlY,GACbC,EAAGyY,EAAOP,GAAG,GAAiB,GAAXO,EAAOT,EAAU,GAAKS,EAAO8O,aAChDC,WAAW,SACX3nB,KAAM4mB,EACN3H,SAAUrG,EAAOgP,cACjBjN,WAAW,SAPb,SASGkN,YAAe3nB,IARXse,MAWHsJ,EAAWlP,EAAO/T,QAAQ1D,KAAI,SAAChB,EAAGqe,GAAJ,OAClC,uBAEEte,EAAe,EAAX0Y,EAAOT,EAAS,GAAKS,EAAO8O,aAChCvnB,EAAGyY,EAAOP,GAAGlY,GACbwnB,WAAW,SACXI,iBAAiB,UACjB/nB,KAAM4mB,EACN3H,SAAUrG,EAAOgP,cACjBjN,WAAW,SARb,SAUGqN,YAAe7nB,IATXqe,MAYT,OACE,+BACGiJ,EACAK,MAKDG,GAAc,WAClB,IAAMrP,EAASe,qBAAWjB,IAC1B,OACE,uBACExY,EAAG,EACHC,EAAG,EACH0a,MAAOjC,EAAOX,EACdwO,OAAQ7N,EAAOX,EACfyO,GAAI9N,EAAOV,EAAI,EACfyO,GAAI/N,EAAOV,EAAI,EACflY,KAAK,WACLkoB,QAAS,MAKApO,GAjJY,SAAC,GAA6C,IAA3CqO,EAA0C,EAA1CA,YAAaC,EAA6B,EAA7BA,YAAaC,EAAgB,EAAhBA,UAChDzB,EAASyB,EAAY,OAAS,WACpC,OACE,+BACGA,GAAa,eAAC,GAAD,IACd,eAAC,GAAD,CAAQzB,OAAQA,IAChB,eAAC,GAAD,IACCuB,GAAe,eAAC,GAAD,CAASvB,OAAQA,IAChCwB,GAAe,eAAC,GAAD,QCdTE,GAA8D,SAAC,GAIrE,IAHLroB,EAGI,EAHJA,MACAwC,EAEI,EAFJA,MACAoiB,EACI,EADJA,MAEMjM,EAASe,qBAAWjB,IAC1B,EAAiBE,EAAO3T,EAAExC,GAA1B,mBAAO2V,EAAP,KAAWC,EAAX,KACMxS,EAAM+S,EAAOV,EAAI,EAAK,EAAK,GACjC,OACE,+BACE,yBACEE,GAAIA,EACJC,GAAIA,EACJxS,EAAGA,EACHuhB,YAAaxO,EAAO2P,iBACpB3B,OAAO,UACP4B,cAAc,MACdxoB,KAAMC,EAAQ,UAAY,UAE3B4kB,GACC,eAAC,GAAD,CACEA,MAAOA,EACPzM,GAAIA,EACJC,GAAIA,EACJoQ,UAAWxoB,EAAQ,aAAe,UAClCgf,SAAUrG,EAAO8P,cACjB/N,WAAW,mBAORgO,GAMR,SAAC,GAA0D,IAAxDvf,EAAuD,EAAvDA,MAAOC,EAAgD,EAAhDA,IAAKud,EAA2C,EAA3CA,OAAQQ,EAAmC,EAAnCA,YAAawB,EAAsB,EAAtBA,gBACvC,cAAiBxf,EAAjB,GAAO2d,EAAP,KAAWC,EAAX,KACA,cAAiB3d,EAAjB,GAAO4d,EAAP,KAAWC,EAAX,KACM2B,EAAa9B,IAAOE,GAAMD,IAAOE,EACvC,OACE,+BACG2B,GACC,uBACE9B,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJN,OAAO,QACPQ,YAAaA,EACbD,cAAc,OACde,QAAQ,QAGZ,uBACEnB,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJN,OAAQA,EACRQ,YAAaA,EACbD,cAAc,QACdyB,gBAAiBA,EACjBV,QAAQ,YAMHY,GAAwD,SAAC,GAW/D,IAVLC,EAUI,EAVJA,MACA3Q,EASI,EATJA,GACAC,EAQI,EARJA,GACAxS,EAOI,EAPJA,EACA0T,EAMI,EANJA,MACA2O,EAKI,EALJA,QACArD,EAII,EAJJA,MACA5F,EAGI,EAHJA,SACAtE,EAEI,EAFJA,WACA8N,EACI,EADJA,UAEMO,EAAU,WACd,OAAQD,GACN,IAAK,SACH,OAAO,eAAC,GAAD,CAAQ3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAOA,EAAO2O,QAASA,IAC9D,IAAK,UACH,OAAO,eAAC,GAAD,CAAS9P,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAOA,EAAO2O,QAASA,IAC/D,IAAK,QACH,OAAO,eAAC,GAAD,CAAO9P,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAOA,EAAO2O,QAASA,KAPjD,GAUV3d,OAAiBnG,IAAVygB,GACX,eAAC,GAAD,CACEA,MAAOA,EACPzM,GAAIA,EACJC,GAAIA,EACJoQ,UAAWA,EACXxJ,SAAUA,EACVtE,WAAYA,IAGhB,OACE,+BACGqO,EACAze,MA0BD0e,GAA0B,SAAC,GAAD,IAAG7Q,EAAH,EAAGA,GAAIC,EAAP,EAAOA,GAAIxS,EAAX,EAAWA,EAAG0T,EAAd,EAAcA,MAAO2O,EAArB,EAAqBA,QAArB,OAC9B,6BACE,yBAAQ9P,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG+gB,OAAO,OAAO5mB,KAAMuZ,EAAO2P,YAAahB,OAIpEiB,GAA2B,SAAC,GAAD,IAAG/Q,EAAH,EAAGA,GAAIC,EAAP,EAAOA,GAAIxS,EAAX,EAAWA,EAAG0T,EAAd,EAAcA,MAAO2O,EAArB,EAAqBA,QAArB,OAC/B,oBAAGkB,UAAS,qBAAgBhR,EAAhB,aAAuBC,EAAvB,KAAZ,SACE,uBACEnY,EAAGkY,EAAKvS,EACR1F,EAAGkY,EAAKxS,EACRgV,MAAW,EAAJhV,EACP4gB,OAAY,EAAJ5gB,EACR+gB,OAAO,OACP5mB,KAAMuZ,EACN2P,YAAahB,OAKbmB,GAAyB,SAAC,GAAmC,IAAjCjR,EAAgC,EAAhCA,GAAIC,EAA4B,EAA5BA,GAAIxS,EAAwB,EAAxBA,EAAG0T,EAAqB,EAArBA,MAAO2O,EAAc,EAAdA,QAC3CnB,EAAmB3O,EAAKvS,EAApBohB,EAAuB7O,EAAKvS,EAAxBmhB,EAA2B3O,EAAKxS,EAA5BqhB,EAA+B7O,EAAKxS,EACjDuhB,EAAmB,EAAJvhB,EAAS,GAC9B,OACE,+BACE,uBACEkhB,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJC,GAAIA,EACJN,OAAQrN,EACR6N,YAAaA,EACbc,QAASA,IAEX,uBACEnB,GAAIA,EACJC,GAAIE,EACJD,GAAIA,EACJC,GAAIF,EACJJ,OAAQrN,EACR6N,YAAaA,EACbc,QAASA,QAMXoB,GAAsB,SAAC,GAAD,IAAGzE,EAAH,EAAGA,MAAOzM,EAAV,EAAUA,GAAIC,EAAd,EAAcA,GAAIoQ,EAAlB,EAAkBA,UAAWxJ,EAA7B,EAA6BA,SAAUtE,EAAvC,EAAuCA,WAAvC,OAC1B,uBACEza,EAAGkY,EACHjY,EAAGkY,EACHsP,WAAW,SACXI,iBAAiB,UACjB/nB,KAAMyoB,EACNxJ,SAAUA,EACVtE,WAAYA,EAPd,SASGkK,KC3KC0E,GAAyC,SAAC,GAAe,IAAbC,EAAY,EAAZA,MAC1C5Q,EAASe,qBAAWjB,IACpBrG,EAAWmX,EAAMnX,SAASlR,KAAI,WAAeqd,GAAf,uBAAEpV,EAAF,KAASC,EAAT,YAClC,eAAC,GAAD,CAEED,MAAOwP,EAAO3T,EAAEmE,GAChBC,IAAKuP,EAAO3T,EAAEoE,GACdud,OAAO,aACPQ,YAAaxO,EAAO6Q,uBACpBb,gBAAiBhQ,EAAO8Q,4BALnBlL,MAQHpV,EAAS,WACb,QAAoBhF,IAAhBolB,EAAMpgB,MAAV,CACA,MAAiBwP,EAAO3T,EAAEukB,EAAMpgB,OAAhC,mBAAOgP,EAAP,KAAWC,EAAX,KACMxS,EAAK+S,EAAOV,EAAI,GAAM,EAC5B,OAAO,eAAC,GAAD,CAAa6Q,MAAM,SAAS3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAM,aAAa2O,QAAS,MAJxE,GAMf,OACE,+BACG7V,EACAjJ,MAKDugB,GAAyD,SAAC,GAA0B,IAAxBH,EAAuB,EAAvBA,MAAOI,EAAgB,EAAhBA,UACjEhR,EAASe,qBAAWjB,IACpB7S,EAAgB,EAAX+S,EAAOV,EAAS,EACrB2R,EAAUL,EAAMvjB,OAAO9E,KAAI,SAACE,EAAGmd,GACnC,MAAiB5F,EAAO3T,EAAE5D,GAA1B,mBAAO+W,EAAP,KAAWC,EAAX,KACM9N,EAAOqf,EAAY,6BAA6BxD,OAAO5H,QAAOpa,EACpE,OACE,eAAC,GAAD,CAEE2kB,MAAM,SACN3Q,GAAIA,EACJC,GAAIA,EACJxS,EAAGA,EACH0T,MAAM,SACN2O,QAAS,GACTrD,MAAOta,EACPke,UAAU,UACVxJ,SAAUrG,EAAOkR,eACjBnP,WAAW,cAVN6D,MAcX,OAAO,6BAAIqL,KAGPE,GAA+D,SAAC,GAA2B,IAAzBP,EAAwB,EAAxBA,MAAOQ,EAAiB,EAAjBA,WACvEpR,EAASe,qBAAWjB,IACpB7S,EAAgB,EAAX+S,EAAOV,EAAS,EACrBzO,EAAO+f,EAAMvjB,OAAOpE,OAAS,EAC7BgoB,EAAUL,EAAMvjB,OAAO9E,KAAI,SAACE,EAAGmd,GACnC,MAAiB5F,EAAO3T,EAAE5D,GAA1B,mBAAO+W,EAAP,KAAWC,EAAX,KACM4R,EAAsB,eAAfD,GAA+BxL,EAAM,IAAM,EACxD,EAA2B0L,GAAeF,EAAYxL,EAAK/U,GAA3D,mBAAO8P,EAAP,KAAckP,EAAd,KACA,OAAOwB,EACL,+BAEA,eAAC,GAAD,CAEElB,MAAM,SACN3Q,GAAIA,EACJC,GAAIA,EACJxS,EAAGA,EACH0T,MAAOA,EACP2O,QAAS,GACTrD,MAAK,UAAKrG,EAAM,GAChBiK,UAAWA,EACXxJ,SAAUrG,EAAOkR,eACjBnP,WAAW,UAVN6D,MAcX,OAAO,6BAAIqL,KAGPK,GAAiB,SACrBF,EACAxL,EACA/U,GAEA,IAAMsL,EAAkB,IAARyJ,EACV1O,EAAS0O,IAAQ/U,EACjB0gB,EAAY3L,EAAM,IAAM,EAC9B,OAAQwL,GACN,IAAK,aACH,OAAOjV,GAAWjF,EAAS,CAAC,SAAU,SAAW,CAAC,QAAS,UAC7D,IAAK,gBACH,OAAOqa,EAAY,CAAC,QAAS,SAAW,CAAC,QAAS,SACpD,IAAK,gBACH,OAAOA,EAAY,CAAC,QAAS,SAAW,CAAC,QAAS,WAIzCrQ,GA1GY,SAAC,GAAD,IAAGzH,EAAH,EAAGA,SAAUpM,EAAb,EAAaA,OAAQmkB,EAArB,EAAqBA,KAAMC,EAA3B,EAA2BA,gBAAiBC,EAA5C,EAA4CA,eAA5C,OACzB,+BACE,eAAC,GAAD,CAAUd,MAAOnX,IACjB,eAAC,GAAD,CAAQmX,MAAOvjB,EAAQ2jB,UAAWS,IAClC,eAAC,GAAD,CAAMb,MAAOY,EAAMJ,WAAYM,Q,SC6B7BC,GAAsB,SAAC,GAAqB,IAAnBtqB,EAAkB,EAAlBA,MAAOuqB,EAAW,EAAXA,KAC9B5R,EAASe,qBAAWjB,IACpBkO,EAAS3mB,EAAQ,OAAS,YAC1BoS,EAAWmY,EAAKrpB,KAAI,SAACspB,EAAKjM,GAAN,OACxB,eAAC,GAAD,CAEEpV,MAAOwP,EAAO3T,EAAEwlB,EAAIrhB,OACpBC,IAAKuP,EAAO3T,EAAEwlB,EAAIphB,KAClBud,OAAQA,EACRQ,YAAaxO,EAAO6Q,uBACpBb,gBAAiBhQ,EAAO8Q,4BALnBlL,MAQT,OAAO,6BAAInM,KAGPqY,GAAsB,SAAC,GAAiC,IAA/BzqB,EAA8B,EAA9BA,MAAOuqB,EAAuB,EAAvBA,KAAMG,EAAiB,EAAjBA,WACpC/R,EAASe,qBAAWjB,IACpB7S,EAAgB,EAAX+S,EAAOV,EAAS,GACrBqB,EAAQtZ,EAAQ,OAAS,YACzB2qB,EAAKJ,EAAKrpB,KAAI,SAACspB,EAAK5gB,GACxB,IACMghB,EADOC,aAAQL,GACFM,OAAO5pB,KAAI,SAACsK,EAAGsN,GAChC,MAAiBH,EAAO3T,EAAEwG,GAA1B,mBAAO2M,EAAP,KAAWC,EAAX,KACA,OAAOsS,EACL,eAAC,GAAD,CAAa5B,MAAM,UAAkB3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAOA,EAAO2O,QAAS,IAAhDnP,GAElC,eAAC,GAAD,CAAqBgQ,MAAM,SAAS3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAOA,EAAO2O,QAAS,IAA/DnP,MAGtB,OAAO,6BAAY8R,GAAJhhB,MAEjB,OAAO,6BAAI+gB,KAGPI,GAAsC,SAAC,GAAgB,IAAd/kB,EAAa,EAAbA,OACvC2S,EAASe,qBAAWjB,IACpB7S,EAAgB,EAAX+S,EAAOV,EAAS,GACrB+S,EAAUhlB,EAAO9E,KAAI,SAACE,EAAGmd,GAC7B,MAAiB5F,EAAO3T,EAAE5D,GAA1B,mBAAO+W,EAAP,KAAWC,EAAX,KACA,OAAO,eAAC,GAAD,CAAuB0Q,MAAM,QAAQ3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAM,MAAM2O,QAAS,IAA9D1J,MAE3B,OAAO,6BAAIyM,KAGEnR,GAhFY,SAAC,GAAmD,IAAjD9L,EAAgD,EAAhDA,MAAOkd,EAAyC,EAAzCA,SAAUC,EAA+B,EAA/BA,SAAUC,EAAqB,EAArBA,eACjDC,EAASxX,YAAU7F,GACzB,OACE,+BACGkd,GACC,uCACE,eAAC,GAAD,CAAMV,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQC,KAAMtrB,OAAK,IACzD,eAAC,GAAD,CAAMuqB,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQE,OAAQvrB,OAAK,IAC3D,eAAC,GAAD,CAAMuqB,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQG,OAAQxrB,OAAK,IAC3D,eAAC,GAAD,CAAMuqB,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQI,MAAOzrB,OAAK,IAC1D,eAAC,GAAD,CAAMuqB,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQC,OAC9C,eAAC,GAAD,CAAMf,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQE,SAC9C,eAAC,GAAD,CAAMhB,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQG,SAC9C,eAAC,GAAD,CAAMjB,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQI,WAGjDP,GACC,uCACE,eAAC,GAAD,CAAMX,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQG,OAAQxrB,OAAK,IAC3D,eAAC,GAAD,CAAMuqB,KAAMa,EAAOb,KAAKzW,IAAO9T,MAAOqrB,IAAQI,MAAOzrB,OAAK,EAAC0qB,YAAU,IACrE,eAAC,GAAD,CAAMH,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQG,SAC9C,eAAC,GAAD,CAAMjB,KAAMa,EAAOb,KAAKzW,IAAOjM,MAAOwjB,IAAQI,MAAOf,YAAU,OAGlES,GAAkB,eAAC,GAAD,CAAYnlB,OAAQolB,EAAOM,aAAaxqB,KAAI,6DCX/DyqB,GAAyE,SAAC,GAAD,IAC7E3lB,EAD6E,EAC7EA,OACAb,EAF6E,EAE7EA,SACAymB,EAH6E,EAG7EA,WAH6E,OAK7E,6BACG5lB,EAAO9E,KAAI,SAACE,EAAGmd,GACd,IAAMve,EAAQmF,EAAWoZ,EAAM,IAAM,EAAIA,EAAM,IAAM,EACrD,OACE,eAAC,GAAD,CAAiB/b,MAAOpB,EAAGpB,MAAOA,EAAO4kB,MAAOgH,EAAU,UAAMrN,EAAM,QAAMpa,GAAhEoa,SAMdsN,GAAsD,SAAC,GAAD,IAAG7lB,EAAH,EAAGA,OAAQhG,EAAX,EAAWA,MAAX,OAC1D,6BACGgG,EAAO9E,KAAI,SAACE,EAAGmd,GAAJ,OACV,eAAC,GAAD,CAAiB/b,MAAOpB,EAAGpB,MAAOA,GAAtBue,SAKZuN,GAAiC,SAAC,GAAe,IAAbtpB,EAAY,EAAZA,MAClCmW,EAASe,qBAAWjB,IAC1B,EAAiBE,EAAO3T,EAAExC,GAA1B,mBAAO2V,EAAP,KAAWC,EAAX,KACMxS,EAAM+S,EAAOV,EAAI,EAAK,GAAM,GAClC,OAAO,eAAC,GAAD,CAAa6Q,MAAM,SAAS3Q,GAAIA,EAAIC,GAAIA,EAAIxS,EAAGA,EAAG0T,MAAM,SAAS2O,QAAS,KAGpEpO,GAzCY,SAAC,GAAgE,IAA9DxR,EAA6D,EAA7DA,KAAMujB,EAAuD,EAAvDA,WAAYG,EAA2C,EAA3CA,aAAchZ,EAA6B,EAA7BA,WAAYC,EAAiB,EAAjBA,WACxE,OACE,+BACG+Y,GAAgB1jB,EAAK2jB,UAAY,eAAC,GAAD,CAAUxpB,MAAO6F,EAAK2jB,WACxD,eAAC,GAAD,CAAOhmB,OAAQqC,EAAKhI,MAAO8E,SAAUkD,EAAKlD,SAAUymB,WAAYA,IAChE,eAAC,GAAD,CAAY5lB,OAAQ+M,EAAW/M,OAAQhG,OAAO,IAC9C,eAAC,GAAD,CAAYgG,OAAQgN,EAAWhN,OAAQhG,OAAO,QCQrCisB,GAxBsB,SAAC,GAAe,IAAb5Y,EAAY,EAAZA,MAChCsF,EAASe,qBAAWjB,IACpByT,EAAS7Y,EAAMnS,KAAI,SAACsK,EAAG+S,GAC3B,MAAiB5F,EAAO3T,EAAE,CAACwG,EAAEvL,EAAGuL,EAAEtL,IAAlC,mBAAOiY,EAAP,KAAWC,EAAX,KACMwM,EAAK,UAAMpZ,EAAE4R,OACnB,OACE,uBAEEnd,EAAGkY,EACHjY,EAAGkY,EACHsP,WAAW,SACXI,iBAAiB,UACjB/nB,KAAMyL,EAAE4R,OAAS,EAAI,WAAa,UAClC4B,SAAUrG,EAAOkR,eACjBnP,WAAW,SACXuN,QAAS,GATX,SAWGrD,GAVIrG,MAcX,OAAO,6BAAI2N,KC2CErS,GArDY,SAAC,GAAiC,IAA/BhZ,EAA8B,EAA9BA,GAAIsrB,EAA0B,EAA1BA,aAAc5C,EAAY,EAAZA,MACxC5Q,EAASe,qBAAWjB,IAClBrB,EAAesC,qBAAWvC,IAA1BC,WACF/O,EAAOkhB,EAAMzW,OAASF,GAAoB2W,EAAMlhB,KAAK8G,KAAOoa,EAAMlhB,KAAKoH,QACvE6E,EACJ6X,GACC,SAAC3gB,GACA,IAAM4gB,EAAO5gB,EAAE6gB,cAAcC,wBACtBjU,EAAW7M,EAAE+gB,QAAUH,EAAKnsB,EAAxBqY,EAA2B9M,EAAEghB,QAAUJ,EAAKlsB,EACvDisB,EAAaxT,EAAOvX,EAAE,CAACiX,EAAIC,MAEzBmU,EAAYlD,EAAMzW,OAASF,GAC3ByX,EAAiBjT,EAAW7R,IAAI2R,IAClC,aACAqS,EAAMnW,SACN,gBACA,gBACJ,OACE,uBAAKvS,GAAIA,EAAI+Z,MAAOjC,EAAOX,EAAGwO,OAAQ7N,EAAOX,EAAG1D,QAASA,EAAzD,UACE,eAAC,GAAD,CACE4T,YAAa9Q,EAAW7R,IAAI2R,IAC5BiR,YAAasE,EACbrE,UAAWhR,EAAW7R,IAAI2R,OAE1BuV,GACA,eAACC,GAAD,CACE3e,MAAOwb,EAAM9Z,QACbwb,SAAU7T,EAAW7R,IAAI2R,IACzBgU,SAAU9T,EAAW7R,IAAI2R,IACzBiU,eAAgB/T,EAAW7R,IAAI2R,OAGjCuV,GACA,eAACE,GAAD,CACE3mB,OAAQujB,EAAMtW,aACdb,SAAUmX,EAAMrW,YAChBiX,KAAMZ,EAAMpW,WACZiX,gBAAiBhT,EAAW7R,IAAI2R,IAChCmT,eAAgBA,IAGpB,eAACuC,GAAD,CACEvkB,KAAMA,EACNujB,WAAYxU,EAAW7R,IAAI2R,IAC3B6U,aAAc3U,EAAW7R,IAAI2R,IAC7BnE,WAAYwW,EAAMxW,WAClBC,WAAYuW,EAAMvW,cAElByZ,GAAalD,EAAMlW,MAAMzR,OAAS,GAAK,eAAC,GAAD,CAAOyR,MAAOkW,EAAMlW,YCnDpDwG,GANK,WAClB,MAAsCH,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cAEpB,OAAO,eAACqW,GAAD,CAAOhsB,GALM,aAKa0oB,MAAOhT,EAAY4V,aAD/B,SAAC/qB,GAAD,OAAcoV,EAAcD,EAAW9C,KAAKrS,QC0BpDyY,GA/BK,WAClB,IAAMlB,EAASe,qBAAWjB,IAClBhC,EAAiBiD,qBAAWpD,IAA5BG,aACR,YAAqBtS,IAAjBsS,EACK,+BAGP,gBAAC,KAAD,CACEmE,MAAM,OACNkS,eAAe,eACfC,WAAW,SACXxd,KAAMoJ,EAAOqU,WAJf,UAME,eAAC,KAAD,CACEpS,MAAM,MACNvG,YAAaoC,EAAajC,GAAGH,YAC7BC,QAASmC,EAAajC,GAAGF,QAH3B,SAKGmC,EAAajC,GAAGlK,OAEnB,eAAC,KAAD,CACEsQ,MAAM,MACNvG,YAAaoC,EAAahC,OAAOJ,YACjCC,QAASmC,EAAahC,OAAOH,QAH/B,SAKGmC,EAAahC,OAAOnK,W,UC4EvB2iB,GAAoC,SAAC,GACzC,OADsD,EAAXna,MAEzC,KAAKF,GACH,OAAO,eAAC,KAAD,CAAMyG,QAAQ,QAAQF,GAAI+T,OACnC,KAAKta,GACH,OAAO,eAAC,KAAD,CAAMyG,QAAQ,QAAQF,GAAIgU,OACnC,KAAKva,GACH,OAAO,eAAC,KAAD,CAAMyG,QAAQ,QAAQF,GAAIiU,OACnC,KAAKxa,GACH,OAAO,eAAC,KAAD,CAAMyG,QAAQ,QAAQF,GAAIkU,OACnC,KAAKza,GACH,OAAO,eAAC,KAAD,CAAMyG,QAAQ,QAAQF,GAAImU,OACnC,QACE,OAAO,eAAC,KAAD,CAAMjU,QAAQ,QAAQF,GAAI+T,SAIxBrT,GA/FK,WAClB,MAAsCH,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cAcpB,OACE,qCACE,gBAAC,KAAD,CAAM+W,YAAY,EAAOC,UAAU,MAAMC,eAAe,EAAxD,UACE,eAAC,KAAD,CAAYtU,GAAIuU,KAAYnM,KAAM,eAAC,GAAD,CAAUzO,KAAMyD,EAAWzD,OAAUwO,aAAW,SAClF,gBAAC,KAAD,WACE,gBAAC,KAAD,CAAiBzE,KAAK,QAAQ8Q,MAAM,OAAO1X,MAAOM,EAAWzD,KAAMsM,SAlBzD,SAACnJ,GACjBO,EAAcD,EAAW+L,QAAQrM,KAiB3B,UACE,eAAC,KAAD,CAAgBA,MAAOrD,GAAvB,SACE,gBAAC,KAAD,CAAMma,WAAW,SAAjB,UACE,eAAC,GAAD,CAAUja,KAAMF,KAChB,eAAC,KAAD,CAAMgb,GAAI,EAAV,uBAGJ,eAAC,KAAD,CAAgB3X,MAAOrD,GAAvB,SACE,gBAAC,KAAD,CAAMma,WAAW,SAAjB,UACE,eAAC,GAAD,CAAUja,KAAMF,KAChB,eAAC,KAAD,CAAMgb,GAAI,EAAV,mCAGJ,eAAC,KAAD,CAAgB3X,MAAOrD,GAAvB,SACE,gBAAC,KAAD,CAAMma,WAAW,SAAjB,UACE,eAAC,GAAD,CAAUja,KAAMF,KAChB,eAAC,KAAD,CAAMgb,GAAI,EAAV,mCAGJ,eAAC,KAAD,CAAgB3X,MAAOrD,GAAvB,SACE,gBAAC,KAAD,CAAMma,WAAW,SAAjB,UACE,eAAC,GAAD,CAAUja,KAAMF,KAChB,eAAC,KAAD,CAAMgb,GAAI,EAAV,8BAGJ,eAAC,KAAD,CAAgB3X,MAAOrD,GAAvB,SACE,gBAAC,KAAD,CAAMma,WAAW,SAAjB,UACE,eAAC,GAAD,CAAUja,KAAMF,KAChB,eAAC,KAAD,CAAMgb,GAAI,EAAV,gCAIN,eAAC,KAAD,CACE/Q,KAAK,WACL8Q,MAAM,SACN1X,MAAOM,EAAWlO,KAAK8G,KAAKhK,SAAW,CAAC,eAAiB,GACzDia,SAnDW,SAACnJ,GACpB,IAAM4X,EAAe5X,EAAmBtE,SAAS,eAC3Cmc,EAAYvX,EAAWlO,KAAKwlB,YAAYA,GAC9CrX,EAAcD,EAAW8L,QAAQyL,KA4C3B,SAME,eAAC,KAAD,CAAgB7X,MAAM,cAAtB,SACE,gBAAC,KAAD,CAAM8W,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAI4U,OAC1B,eAAC,KAAD,CAAMH,GAAI,EAAV,iCAIN,eAAC,KAAD,IACA,gBAAC,KAAD,CAAUtZ,QAxDC,WAEZsC,OAAOoX,QADI,4DAEhBxX,EAAc,IAAI3D,KAqDZ,UACE,eAAC,KAAD,CAAMwG,QAAQ,QAAQF,GAAI8U,KAAiB3U,MAAM,YACjD,eAAC,KAAD,CAAMsU,GAAI,EAAGtU,MAAM,UAAnB,mC,8BCtBGO,GAhDY,SAAC,GAAyB,IAAvB4G,EAAsB,EAAtBA,OAAQK,EAAc,EAAdA,QACpC,OACE,gBAAC,KAAD,CAAOL,OAAQA,EAAQK,QAASA,EAASkD,YAAU,EAAnD,UACE,eAAC,KAAD,IACA,gBAAC,KAAD,WACE,eAAC,KAAD,CAAa7K,GAAG,KAAhB,8BACA,eAAC,KAAD,IACA,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,CAASA,GAAG,KAAK5J,KAAK,KAAtB,mBAGA,gBAAC,KAAD,WACE,gBAAC,KAAD,WACE,eAAC,KAAD,CAAU4J,GAAI+U,OACd,eAAC,KAAD,CAAMjT,KAAK,8BAA8B3B,MAAM,WAAW4B,YAAU,EAApE,4BAFF,sBAOA,gBAAC,KAAD,WACE,eAAC,KAAD,CAAU/B,GAAIgV,OACd,eAAC,KAAD,CAAMlT,KAAK,0BAA0B3B,MAAM,WAAW4B,YAAU,EAAhE,yBAFF,6BAQF,eAAC,KAAD,CAAS/B,GAAG,KAAK5J,KAAK,KAAtB,qBAGA,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,8CACA,eAAC,KAAD,wIAQR,eAAC,KAAD,WC1BOsK,GAhCY,SAAC,GAAY,IAAVhZ,EAAS,EAATA,GACpB0V,EAAemD,qBAAWpD,IAA1BC,WACR,OACE,eAAC,KAAD,CAAK6X,QAAM,EAAX,SACE,eAAC3V,GAAcpC,SAAf,CAAwBJ,MAAO,IAAI6B,GAAO,KAA1C,SACE,eAAC+U,GAAD,CAAOhsB,GAAIA,EAAI0oB,MAAOhT,SC8GxB8X,GAAwE,SAAC,GAGxE,IAFL5N,EAEI,EAFJA,OACAK,EACI,EADJA,QAEA,OACE,eAAC,KAAD,CAAaL,OAAQA,EAAQK,QAASA,EAASwN,yBAAqBnqB,EAAW6f,YAAU,EAAzF,SACE,eAAC,KAAD,UACE,gBAAC,KAAD,WACE,eAAC,KAAD,CAAmB7K,GAAG,KAAtB,0CACA,gBAAC,KAAD,gDACoC,8CADpC,iEAIA,eAAC,KAAD,UACE,eAAC,KAAD,CAAQ9E,YAAY,OAAOC,QAASwM,EAApC,0BAUGjH,GAhHK,WAClB,IAAM0U,EAAQC,eAGNjY,EAAemD,qBAAWpD,IAA1BC,WACF5R,EAAOoB,YAAWwQ,EAAWlO,KAAKoH,QAAQpP,OAAOM,WACvD,EAA0B8tB,aAAa9pB,GAA/B+pB,EAAR,EAAQA,OAAQzY,EAAhB,EAAgBA,MAcV0Y,EAAmB,kBAanBC,EAAyBxO,eAC/B,EAAsC1G,qBAAWvC,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACdwX,EAAazX,EAAW7R,IAAI2R,IAC5B4X,EAAWD,EAAaE,KAAqBC,KAU7CC,EAAkB7O,eACxB,OACE,uCACE,gBAAC,KAAD,CAAMmN,YAAY,EAAOC,UAAU,YAAnC,UACE,eAAC,KAAD,CAAYrU,GAAIuU,KAAYnM,KAAM,eAAC,KAAD,MAClC,gBAAC,KAAD,WACE,gBAAC,KAAD,CAAWoM,MAAM,UAAjB,UACE,gBAAC,KAAD,CAAUrZ,QA9CW,WACxB2B,IACLyY,IACAH,EAAM,CACJZ,MAAO,UACPuB,YAAY,0BACZ3P,OAAQ,UACR4P,SAAU,IACVC,YAAY,MAsCN,UACE,eAAC,KAAD,CAAM/V,QAAQ,QAAQF,GAAIkW,OAC1B,eAAC,KAAD,CAAMzB,GAAI,EAAV,wCAEF,gBAAC,KAAD,CAAUtZ,QApCW,YDrCP,SAACzT,GACzB,IAAMyuB,EAAU/L,SAASC,eAAe3iB,GAClC0uB,GAAU,IAAIC,eAAgBC,kBAAkBH,GAChDI,EAAY,IAAIC,MACtBD,EAAUE,IACR,2CAA6CC,KAAKC,SAASC,mBAAmBR,KAChF,IAAMS,EAAazM,SAAS0M,cAAc,UAC1CD,EAAWpV,MAAQ0U,EAAQ1U,MAAMsV,QAAQja,MACzC+Z,EAAWxJ,OAAS8I,EAAQ9I,OAAO0J,QAAQja,MAC3C,IAAMka,EAAMH,EAAWI,WAAW,MAClCD,EAAIE,UAAY,QAChBF,EAAIG,SAAS,EAAG,EAAGN,EAAWpV,MAAOoV,EAAWxJ,QAChDkJ,EAAUa,OAAS,WACjBJ,EAAIK,UAAUd,EAAW,EAAG,GAC5B,IAAMnsB,EAAIggB,SAAS0M,cAAc,KACjC1sB,EAAE0X,KAAO+U,EAAWS,UAAU,aAC9BltB,EAAEmtB,aAAa,WAAY,kBAC3BntB,EAAEotB,cAAc,IAAIC,WAAW,WCqB/BC,CAAWlC,GACXJ,EAAM,CACJZ,MAAO,cACPuB,YAAa,+BACb3P,OAAQ,UACR4P,SAAU,IACVC,YAAY,KA6BN,UACE,eAAC,KAAD,CAAM/V,QAAQ,QAAQF,GAAI2X,OAC1B,eAAC,KAAD,CAAMlD,GAAI,EAAV,0CAGJ,eAAC,KAAD,CAAWD,MAAM,WAAjB,SACE,gBAAC,KAAD,CAAUrZ,QA1BD,WACbua,EACFxX,EAAcD,EAAW2Z,IAAI,CAAC7Z,OAE9B0X,EAAuBjO,SACvBtJ,EAAcD,EAAWrF,GAAG,CAACmF,QAqBvB,UACE,eAAC,KAAD,CAAMmC,QAAQ,QAAQF,GAAI2V,IAC1B,eAAC,KAAD,CAAMlB,GAAI,EAAGoD,GAAI,EAAjB,SACGnC,EAAa,aAAe,mBAE7BA,GAAc,eAAC,KAAD,CAAMxV,QAAQ,QAAQF,GAAI8X,YAG9C,eAAC,KAAD,IACA,gBAAC,KAAD,CAAU3c,QAAS2a,EAAgBtO,OAAnC,UACE,eAAC,KAAD,CAAMtH,QAAQ,QAAQF,GAAI+X,OAC1B,eAAC,KAAD,CAAMtD,GAAI,EAAV,uCAIN,eAACuD,GAAD,CAAgBtwB,GAAI8tB,IACpB,eAAC,GAAD,CACElO,OAAQmO,EAAuBnO,OAC/BK,QAAS8N,EAAuB9N,UAElC,eAACsQ,GAAD,CAAY3Q,OAAQwO,EAAgBxO,OAAQK,QAASmO,EAAgBnO,cClDrEuQ,GAAoB,WACxB,MAAwBC,KAAxB,mBAAOjpB,EAAP,KAAaga,EAAb,KACA,OACE,gBAAC,KAAD,CAAMkL,YAAY,EAAOC,UAAU,MAAnC,UACE,eAAC,KAAD,CAAYrU,GAAIuU,KAAYnM,KAAM,eAAC,KAAD,IAAiBlN,YAAY,WAC/D,gBAAC,KAAD,WACE,gBAAC,KAAD,CAAUC,QAAS,kBAAM+N,EAAQha,EAAKkpB,gBAAtC,UACE,eAAC,KAAD,CAAMlY,QAAQ,QAAQF,GAAIqY,OAC1B,eAAC,KAAD,CAAM5D,GAAI,EAAGoD,GAAI,EAAjB,6BAIF,eAAC,KAAD,IACA,gBAAC,KAAD,CAAU1c,QAAS,kBAAM+N,EAAQha,EAAKopB,kBAAtC,UACE,eAAC,KAAD,CAAMpY,QAAQ,QAAQF,GAAIuY,OAC1B,eAAC,KAAD,CAAM9D,GAAI,EAAGoD,GAAI,EAAjB,0CASJM,GAAiB,WACrB,MAAsC5X,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACpB,MAAO,CAACD,EAAWlO,KAAM,SAAAA,GAAI,OAAImO,EAAcD,EAAW8L,QAAQha,OAGrDwR,GA1EK,WAClB,IAAMlB,EAASe,qBAAWjB,IAC1B,EAAwB6Y,KAAxB,mBAAOjpB,EAAP,KAAaga,EAAb,KACA,OACE,gBAAC,KAAD,CAAazD,QAAS,EAAGjF,QAAQ,QAAQpK,KAAMoJ,EAAOqU,WAAtD,UACE,eAAC,KAAD,CACE1Y,QAAS,kBAAM+N,EAAQha,EAAKspB,YAC5BpQ,KAAM,eAAC,KAAD,IACND,aAAW,WACXE,YAAanZ,EAAKuI,cAEpB,eAAC,KAAD,CACE0D,QAAS,kBAAM+N,EAAQha,EAAKupB,aAC5BrQ,KAAM,eAAC,KAAD,IACND,aAAW,WACXE,YAAanZ,EAAKuI,cAEnBvI,EAAKsH,YACJ,eAAC,GAAD,IAEA,eAAC,KAAD,CACEiL,MAAO,EACPF,WAAW,aACXuE,WAAW,SACXuC,YAAY,EAJd,SAMGnZ,EAAK+G,SAGV,eAAC,KAAD,CACEkF,QAAS,kBAAM+N,EAAQha,EAAKyH,YAC5ByR,KAAM,eAAC,KAAD,IACND,aAAW,UACXE,YAAanZ,EAAKoI,aAEpB,eAAC,KAAD,CACE6D,QAAS,kBAAM+N,EAAQha,EAAKkI,WAC5BgR,KAAM,eAAC,KAAD,IACND,aAAW,UACXE,YAAanZ,EAAKoI,iBCkDXoJ,GAxFK,WAClB,MAAsCH,qBAAWvC,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACdwa,EAA2B,CAC/B3a,GACAA,GACAA,GACAA,IAEI4a,EAA2B,CAC/B5a,GACAA,GACAA,IAEF,OACE,qCACE,gBAAC,KAAD,CAAMsW,UAAU,UAAUD,YAAY,EAAOE,eAAe,EAA5D,UACE,eAAC,KAAD,CAAYtU,GAAIuU,KAAYnM,KAAM,eAAC,KAAD,IAAqBD,aAAW,SAClE,gBAAC,KAAD,WACE,gBAAC,KAAD,CACEqM,MAAM,kBACN9Q,KAAK,WACLkV,aAAc3a,EAAWrS,OACzBqa,SAAU,SAACra,GAAD,OACRsS,EACED,EAAW4a,OAAOH,EAA0B9sB,KANlD,UAUE,eAAC,KAAD,CAAgBkR,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAI8Y,OAC1B,eAAC,KAAD,CAAMrE,GAAI,EAAV,8BAGJ,eAAC,KAAD,CAAgB3X,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAI+Y,OAC1B,eAAC,KAAD,CAAMtE,GAAI,EAAV,+BAGJ,eAAC,KAAD,CAAgB3X,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAIgZ,OAC1B,eAAC,KAAD,CAAMvE,GAAI,EAAV,8BAGJ,eAAC,KAAD,CAAgB3X,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAIiZ,OAC1B,eAAC,KAAD,CAAMxE,GAAI,EAAV,+BAIN,gBAAC,KAAD,CACED,MAAM,aACN9Q,KAAK,WACLkV,aAAc3a,EAAWrS,OACzBqa,SAAU,SAACra,GAAD,OACRsS,EACED,EAAW4a,OAAOF,EAA0B/sB,KANlD,UAUE,eAAC,KAAD,CAAgBkR,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAII,OAC1B,eAAC,KAAD,CAAMqU,GAAI,EAAV,mCAGJ,eAAC,KAAD,CAAgB3X,MAAOiB,GAAvB,SACE,gBAAC,KAAD,CAAM6V,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAIkZ,KAAgBtX,MAAO,CAAEoO,UAAW,mBAC9D,eAAC,KAAD,CAAMyE,GAAI,EAAV,mCAGJ,eAAC,KAAD,CAAgB3X,MAAM,mBAAtB,SACE,gBAAC,KAAD,CAAM8W,WAAW,SAAjB,UACE,eAAC,KAAD,CAAM1T,QAAQ,QAAQF,GAAImZ,OAC1B,eAAC,KAAD,CAAM1E,GAAI,EAAV,8CCzEV2E,GAAoC,SAAC,GACzC,OADsD,EAAXzf,MAEzC,KAAKF,GACH,OAAO,eAAC,KAAD,IACT,KAAKA,GACH,OAAO,eAAC,KAAD,IACT,KAAKA,GACH,OAAO,eAAC,KAAD,IACT,KAAKA,GACH,OAAO,eAAC,KAAD,IACT,KAAKA,GACH,OAAO,eAAC,KAAD,IACT,QACE,OAAO,eAAC,KAAD,MAIP4f,GAA2B,WAC/B,MAAsC9Y,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACpB,OACE,gBAAC,KAAD,CAAM+W,YAAY,EAAOC,UAAU,MAAnC,UACE,eAAC,KAAD,CACErU,GAAIuU,KACJnM,KAAM,eAAC,KAAD,CAAmBxG,MAAO,CAAEoO,UAAW,sBAE/C,eAAC,KAAD,UACE,gBAAC,KAAD,CAAU7U,QAAS,kBAAMkC,EAAcD,EAAW8L,QAAQ9L,EAAWlO,KAAKoqB,eAA1E,UACE,eAAC,KAAD,CAAMpZ,QAAQ,QAAQF,GAAIqY,KAAmBzW,MAAO,CAAEoO,UAAW,oBACjE,eAAC,KAAD,CAAMyE,GAAI,EAAGoD,GAAI,EAAjB,0CASJ0B,GAAwB,WAC5B,MAAsChZ,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACpB,OACE,gBAAC,KAAD,CAAM+W,YAAY,EAAOC,UAAU,MAAnC,UACE,eAAC,KAAD,CAAYrU,GAAIuU,KAAYnM,KAAM,eAAC,KAAD,MAClC,eAAC,KAAD,UACE,gBAAC,KAAD,CAAUjN,QAAS,kBAAMkC,EAAcD,EAAW8L,QAAQ,IAAInT,MAA9D,UACE,eAAC,KAAD,CAAMmK,QAAQ,QAAQF,GAAIwZ,OAC1B,eAAC,KAAD,CAAM/E,GAAI,EAAGoD,GAAI,EAAjB,iCASKnX,GAtEK,WAClB,MAAsCH,qBAAWpD,IAAzCC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,cACpB,OAAID,EAAWqc,oBAA4B,eAAC,GAAD,IACvCrc,EAAWsc,iBAAyB,eAAC,GAAD,IAEtC,eAAC,KAAD,CACEve,QAAS,kBAAMkC,EAAcD,EAAW/F,SACxCsiB,aAAc,SAAAtnB,GAAC,OAAIA,EAAEunB,kBACrBxR,KAAM,eAAC,GAAD,CAAUzO,KAAMyD,EAAWzD,OACjCwO,aAAW,OACXjN,YAAakC,EAAWlO,KAAKsH,YAAc,cAAWxL,EACtDqd,YAAajL,EAAWrG,WCVxB8iB,GAAiB,WACrB,IAAMra,EAASe,qBAAWjB,IAC1B,OACE,gBAAC,KAAD,CACEmC,MAAM,OACNjB,QAAQ,QACRmT,eAAe,eACfC,WAAW,SACXxd,KAAMoJ,EAAOqU,WALf,UAOE,eAACiG,GAAD,IACA,eAACC,GAAD,IACA,eAACC,GAAD,IACA,eAACC,GAAD,IACA,eAACC,GAAD,QAKSxZ,GAxBK,WAClB,IAAQpD,EAAiBiD,qBAAWpD,IAA5BG,aACR,OAAO,0CAAoBtS,IAAjBsS,EAA6B,eAAC6c,GAAD,IAAiB,eAAC,GAAD,OCE3CzZ,GATK,WAClB,OACE,gBAAC,KAAD,CAAO+E,QAAQ,OAAf,UACE,eAAC,GAAD,IACA,eAAC2U,GAAD,Q,UCkCSC,GApCDC,aAAY,CACxBC,WAAY,CACVC,MAAO,CACLC,MAAO,CAAC,KAAM,KAAM,MACpBC,MAAO,CACL,WAAY,CACVC,GAAI,CACF9U,SAAU,KACV8G,GAAI,EACJnD,GAAI,EACJoR,WAAY,KAEdC,GAAI,CACFhV,SAAU,KACV8G,GAAI,EACJnD,GAAI,EACJoR,WAAY,OAIlBnzB,SAAU,CACR,WAAY,CACVkzB,GAAI,CACF1O,UAAW,UAEb4O,GAAG,aACD5O,UAAW,SACX1K,WAAY,cAhCF,CACpB,0BAA2B,CACzBA,WAAY,yBCwBVuZ,GAAW,WACf,IAAMtb,EAASe,qBAAWjB,IAClBrB,EAAesC,qBAAWvC,IAA1BC,WACR,OACE,eAAC,GAAD,UACE,eAAC,IAAD,CAAQoD,GAAG,SAAX,SACE,gBAAC,IAAD,CAAMtB,QAAQ,SAAd,UACE,eAAC,IAAD,CAAUqD,EAAG5D,EAAOX,EAApB,SACE,eAACkc,GAAD,MAED9c,EAAW7R,IAAI2R,KACd,eAAC,IAAD,CAAUqF,EAAG5D,EAAOX,EAApB,SACE,eAAC,GAAD,UACE,eAACmc,GAAD,gBAUDta,GAnCK,WAClB,OACE,eAAC,IAAD,CAAgB2Z,MAAOA,GAAvB,SACE,eAAC,GAAD,UACE,eAAC,GAAD,UACE,eAAC,GAAD,W,OCTUY,QACW,cAA7Bxd,OAAOC,SAASwd,UAEe,UAA7Bzd,OAAOC,SAASwd,UAEhBzd,OAAOC,SAASwd,SAASxqB,MAAM,2DCTnCyqB,MAAM,0BACHC,KADH,uCACQ,WAAM1W,GAAN,eAAAta,EAAA,yDACCsa,EAASrJ,GADV,iEAEeqJ,EAAS2W,OAAOC,OAAM,kBAAM,QAF3C,UAEE7X,EAFF,wDAIJ8X,IAASC,cAAc/X,GACvB,IAAM8X,IAASE,YAAc,UALzB,2CADR,uDAQGH,OAAM,eAETI,IAASC,OACP,eAAC,aAAD,UACE,eAAC,GAAD,MAEFvR,SAASC,eAAe,SD8GpB,kBAAmBuR,WACrBA,UAAUC,cAAcjmB,MACrBwlB,MAAK,SAAAU,GACJA,EAAaC,gBAEdT,OAAM,SAAAnmB,GACLO,QAAQP,MAAMA,EAAM0P,c","file":"static/js/main.3c229917.chunk.js","sourcesContent":["import { BOARD_SIZE, Point } from 'renjukit'\n\nexport class Bitboard {\n  private readonly vlines: number[] = new Array(BOARD_SIZE).fill(0)\n\n  putMut(black: boolean, [x, y]: Point) {\n    this.vlines[x] += (black ? 0b01 : 0b10) << (2 * y)\n  }\n\n  putMovesMut(blackFirst: boolean, moves: Point[]) {\n    let black = blackFirst\n    for (const move of moves) {\n      this.putMut(black, move)\n      black = !black\n    }\n  }\n\n  toString(): string {\n    let result = ''\n    let skip = 0\n    for (const vline of this.vlines) {\n      if (vline === 0) {\n        skip++\n      } else {\n        if (skip !== 0) {\n          result += skip.toString(16) + '.'\n          skip = 0\n        }\n        result += vline.toString(16) + '/'\n        skip = 0\n      }\n    }\n    return result\n  }\n}\n","import { BOARD_SIZE, Point } from 'renjukit'\nimport { Bitboard } from './bitboard'\n\nexport type VariantId = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7\nexport type Reversed = boolean\nexport type Rotation = 0 | 90 | 180 | 270\nexport type Variant = {\n  id: VariantId\n  reversed: Reversed\n  rotation: Rotation\n}\nexport type Variants = [Variant, Variant, Variant, Variant, Variant, Variant, Variant, Variant]\n\nexport const variants: Variants = [\n  { id: 0, reversed: false, rotation: 0 },\n  { id: 1, reversed: true, rotation: 0 },\n  { id: 2, reversed: false, rotation: 90 },\n  { id: 3, reversed: true, rotation: 90 },\n  { id: 4, reversed: false, rotation: 180 },\n  { id: 5, reversed: true, rotation: 180 },\n  { id: 6, reversed: false, rotation: 270 },\n  { id: 7, reversed: true, rotation: 270 },\n]\n\nexport const inverseVariantId = (v: VariantId): VariantId => {\n  return [0, 1, 6, 3, 4, 5, 2, 7][v] as VariantId\n}\n\nexport type PointsVariants = [\n  Point[],\n  Point[],\n  Point[],\n  Point[],\n  Point[],\n  Point[],\n  Point[],\n  Point[]\n]\n\nexport const pointsVariants = (ps: Point[]): PointsVariants => {\n  return variants.map(v =>\n    ps.map(p => pointVariantRaw(p, v.reversed, v.rotation))\n  ) as PointsVariants\n}\n\nexport const pointVariant = (p: Point, v: VariantId): Point => {\n  const { reversed, rotation } = variants[v]\n  return pointVariantRaw(p, reversed, rotation)\n}\n\nconst pointVariantRaw = (p: Point, reversed: Reversed, rotation: Rotation): Point => {\n  const N = BOARD_SIZE - 1\n  const [x, y] = reversed ? [p[1], p[0]] : p\n  switch (rotation) {\n    case 0:\n      return [x, y]\n    case 90:\n      return [y, N - x]\n    case 180:\n      return [N - x, N - y]\n    case 270:\n      return [N - y, x]\n    default:\n      return [x, y]\n  }\n}\n\nexport type BitboardVariants = [\n  Bitboard,\n  Bitboard,\n  Bitboard,\n  Bitboard,\n  Bitboard,\n  Bitboard,\n  Bitboard,\n  Bitboard\n]\n\nexport const toBitboardVariants = (movesVariants: PointsVariants): BitboardVariants => {\n  const ret = emptyBitboardVariants()\n  for (let v = 0; v < movesVariants.length; v++) {\n    ret[v].putMovesMut(true, movesVariants[v])\n  }\n  return ret\n}\n\nexport const emptyBitboardVariants = (): BitboardVariants => {\n  return [\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n    new Bitboard(),\n  ]\n}\n\nexport const canonicalBitboard = (bvs: BitboardVariants): [VariantId, Bitboard] => {\n  const v = minString(bvs.map(b => b.toString()))[0] as VariantId\n  return [v, bvs[v]]\n}\n\nexport const canonicalBitboardString = (bvs: BitboardVariants): [VariantId, string] => {\n  return minString(bvs.map(b => b.toString())) as [VariantId, string]\n}\n\nconst minString = (ss: string[]): [number, string] => {\n  let minI = 0\n  let minS = ss[0]\n  for (let i = 1; i < ss.length; i++) {\n    if (ss[i] < minS) {\n      minI = i\n      minS = ss[i]\n    }\n  }\n  return [minI, minS]\n}\n","import { Point } from 'renjukit'\nimport { canonicalBitboardString, emptyBitboardVariants, pointsVariants } from './symmetry'\n\nexport const encodeAccumulatedMoves = (moves: Point[]): string[] => {\n  const boardVariants = emptyBitboardVariants()\n  const movesVariants = pointsVariants(moves)\n  const result: string[] = []\n  for (let i = 0; i < moves.length; i++) {\n    const black = i % 2 === 0\n    for (let v = 0; v < movesVariants.length; v++) {\n      const point = movesVariants[v][i]\n      boardVariants[v].putMut(black, point)\n    }\n    result[i] = canonicalBitboardString(boardVariants)[1]\n  }\n  return result\n}\n","import { BOARD_SIZE, Point } from 'renjukit'\nimport {\n  canonicalBitboard,\n  inverseVariantId,\n  pointsVariants,\n  pointVariant,\n  toBitboardVariants,\n} from './symmetry'\n\nexport type GameRecord = {\n  moves: Point[]\n  blackWon?: boolean | null\n  whiteWon?: boolean | null\n}\n\nexport type GamesStat = {\n  all: number\n  blackWon: number\n  whiteWon: number\n  draw: number\n}\n\nexport const calcStat = (records: GameRecord[]): GamesStat => {\n  let blackWon = 0\n  let whiteWon = 0\n  let draw = 0\n  for (const record of records) {\n    if (record.blackWon) {\n      blackWon += 1\n    } else if (record.whiteWon) {\n      whiteWon += 1\n    } else {\n      draw += 1\n    }\n  }\n  return { all: records.length, blackWon, whiteWon, draw }\n}\n\nexport const calcStatByNextMove = (records: GameRecord[], query: Point[]): [Point, GamesStat][] => {\n  const dataset = records.map(record => record.moves.slice(0, query.length + 1))\n  const groups = groupByNextMove(query, dataset)\n  const stats: [Point, GamesStat][] = groups.map(([point, indices]) => {\n    const subRecords = indices.map(i => records[i])\n    const stat = calcStat(subRecords)\n    return [point, stat]\n  })\n  return stats.sort((a, b) => b[1].all - a[1].all)\n}\n\nconst groupByNextMove = (query: Point[], dataset: Point[][]): [Point, number[]][] => {\n  const queryLength = query.length\n  const mapByPointCode = new Map<number, number[]>()\n  for (let i = 0; i < dataset.length; i++) {\n    const moves = dataset[i]\n    if (moves.length <= queryLength) continue\n    const [headMoves, nextMove] = [moves.slice(0, queryLength), moves[queryLength]]\n    const headMovesVariants = pointsVariants(headMoves)\n    const canonicalVariantId = canonicalBitboard(toBitboardVariants(headMovesVariants))[0]\n    const canonicalNextMove = pointVariant(nextMove, canonicalVariantId)\n    const pointCode = encodeFast(canonicalNextMove)\n    const item = mapByPointCode.get(pointCode)\n    if (item === undefined) {\n      mapByPointCode.set(pointCode, [i])\n    } else {\n      item.push(i)\n    }\n  }\n\n  const queryVariantId = canonicalBitboard(toBitboardVariants(pointsVariants(query)))[0]\n  const inversedVariantId = inverseVariantId(queryVariantId)\n  const mapByBoardCode = new Map<string, [Point, number[]]>()\n  for (const [code, indices] of Array.from(mapByPointCode.entries())) {\n    const nextMove = pointVariant(decodeFast(code), inversedVariantId)\n    const moves = [...query, nextMove]\n    const boardCode = canonicalBitboard(toBitboardVariants(pointsVariants(moves)))[1].toString()\n    const item = mapByBoardCode.get(boardCode)\n    if (item === undefined) {\n      mapByBoardCode.set(boardCode, [nextMove, indices])\n    } else {\n      if (encodeFast(nextMove) < encodeFast(item[0])) item[0] = nextMove\n      item[1].push(...indices)\n    }\n  }\n\n  return Array.from(mapByBoardCode.values())\n}\n\nconst encodeFast = (p: Point): number => p[0] * BOARD_SIZE + p[1]\n\nconst decodeFast = (c: number): Point => [~~(c / BOARD_SIZE), c % BOARD_SIZE]\n","import { parsePoints, Point, pointEqual, wrapPoints } from 'renjukit'\n\nexport class Game {\n  readonly moves: Point[] = []\n  readonly inverted: boolean = false\n\n  constructor(init?: undefined | Partial<Game>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<Game>): Game {\n    return new Game({ ...this, ...fields })\n  }\n\n  move(p: Point): Game {\n    if (this.has(p)) return this\n    return this.update({\n      moves: [...this.moves, p],\n    })\n  }\n\n  undo(): Game {\n    if (this.moves.length === 0) return this\n    return this.update({\n      moves: this.moves.slice(0, this.moves.length - 1),\n    })\n  }\n\n  has(p: Point): boolean {\n    return this.moves.findIndex(q => pointEqual(p, q)) >= 0\n  }\n\n  cut(length: number): Game {\n    return this.update({ moves: this.moves.slice(0, length) })\n  }\n\n  invert(inverted: boolean): Game {\n    return this.update({ inverted })\n  }\n\n  get canUndo(): boolean {\n    return this.moves.length > 0\n  }\n\n  get blacks(): Point[] {\n    const r = this.inverted ? 1 : 0\n    return this.moves.filter((p, i) => i % 2 === r)\n  }\n\n  get whites(): Point[] {\n    const r = this.inverted ? 0 : 1\n    return this.moves.filter((p, i) => i % 2 === r)\n  }\n\n  get lastMove(): Point | undefined {\n    return this.moves[this.moves.length - 1]\n  }\n\n  get isBlackTurn(): boolean {\n    const r = this.inverted ? 1 : 0\n    return this.moves.length % 2 === r\n  }\n\n  get size(): number {\n    return this.moves.length\n  }\n\n  get empty(): boolean {\n    return this.moves.length === 0\n  }\n\n  encode(separator: string = ''): string {\n    return wrapPoints(this.moves).toString(separator)\n  }\n\n  static decode(code: string): Game | undefined {\n    const points = parsePoints(code)\n    return points && new Game({ moves: points })\n  }\n}\n","import Dexie, { Table } from 'dexie'\nimport { parsePoints, Point } from 'renjukit'\n\nconst CHUNK_SIZE = 2000\n\nconst tableNames = [\n  'countries',\n  'cities',\n  'months',\n  'rules',\n  'openings',\n  'players',\n  'tournaments',\n  'games',\n] as const\ntype TableName = typeof tableNames[number]\nconst TableName: Record<TableName, TableName> = {\n  countries: tableNames[0],\n  cities: tableNames[1],\n  months: tableNames[2],\n  rules: tableNames[3],\n  openings: tableNames[4],\n  players: tableNames[5],\n  tournaments: tableNames[6],\n  games: tableNames[7],\n} as const\n\ntype Base = {\n  id: number\n}\n\ntype Named = Base & {\n  name: string\n}\n\nexport type RIFCountry = Named & {\n  abbr: string\n}\n\nexport type RIFCity = Named & {\n  country: RIFCountry['id']\n}\n\nexport type RIFMonth = Named\n\nexport type RIFRule = Named & {\n  info: string\n}\n\nexport type RIFOpening = Named & {\n  abbr: string\n}\n\nexport type RIFPlayer = Named & {\n  surname: string\n  country: RIFCountry['id']\n  city: RIFCity['id']\n}\n\nexport type RIFTournament = Named & {\n  country: RIFCountry['id']\n  city: RIFCity['id']\n  year: number\n  month: RIFMonth['id']\n  start: string\n  end: string\n  rule: RIFRule['id']\n  rated: boolean\n}\n\nexport type RIFGame = Base & {\n  publisher: RIFPlayer['id']\n  tournament: RIFTournament['id']\n  round: string\n  rule: RIFRule['id']\n  black: RIFPlayer['id']\n  white: RIFPlayer['id']\n  bresult: number\n  btime: number\n  wtime: number\n  opening: RIFOpening['id']\n  alt: string\n  swap: string\n  move: string\n  info: string\n}\n\nconst indexedFields: Record<TableName, string> = {\n  countries: 'id',\n  cities: 'id',\n  months: 'id',\n  rules: 'id',\n  openings: 'id',\n  players: 'id,name,surname,country',\n  tournaments: 'id,name,country,year',\n  games: 'id,tournament,black,white,bresult',\n}\n\nexport type GameView = {\n  id: RIFGame['id']\n  black: RIFPlayer\n  white: RIFPlayer\n  blackWon: boolean | null\n  whiteWon: boolean | null\n  moves: Point[]\n  btime: number\n  wtime: number\n  round: string\n  rule: RIFRule\n  opening: RIFOpening\n  alts: Point[]\n  alt: string\n  swap: string\n  info: string\n  tournament: RIFTournament\n  publisher: RIFPlayer\n}\n\nexport class RIFDatabase extends Dexie {\n  static readonly DBNAME = 'rif'\n  private readonly countries: Table<RIFCountry, number>\n  private readonly cities: Table<RIFCity, number>\n  private readonly months: Table<RIFMonth, number>\n  private readonly rules: Table<RIFRule, number>\n  private readonly openings: Table<RIFOpening, number>\n  private readonly players: Table<RIFPlayer, number>\n  private readonly tournaments: Table<RIFTournament, number>\n  private readonly games: Table<RIFGame, number>\n\n  static reset() {\n    indexedDB.deleteDatabase(RIFDatabase.DBNAME)\n  }\n\n  constructor() {\n    super(RIFDatabase.DBNAME)\n    this.version(1).stores(indexedFields)\n    this.countries = this.table(TableName.countries)\n    this.cities = this.table(TableName.cities)\n    this.months = this.table(TableName.months)\n    this.rules = this.table(TableName.rules)\n    this.openings = this.table(TableName.openings)\n    this.players = this.table(TableName.players)\n    this.tournaments = this.table(TableName.tournaments)\n    this.games = this.table(TableName.games)\n  }\n\n  async searchPlayers(prefixes: string[], limit: number = 10): Promise<RIFPlayer[]> {\n    return await this.players\n      .where('surname')\n      .startsWithAnyOfIgnoreCase(prefixes)\n      .or('name')\n      .startsWithAnyOfIgnoreCase(prefixes)\n      .limit(limit)\n      .sortBy('surname')\n  }\n\n  async getGameViews(gameIds: RIFGame['id'][]): Promise<GameView[]> {\n    if (gameIds.length === 0) return []\n    const games = await this.games.bulkGet(gameIds)\n    const [blacks, whites, publishers, tournaments, rules, openings] = await Promise.all([\n      this.players.bulkGet(games.map(g => g?.black ?? 0)),\n      this.players.bulkGet(games.map(g => g?.white ?? 0)),\n      this.players.bulkGet(games.map(g => g?.publisher ?? 0)),\n      this.tournaments.bulkGet(games.map(g => g?.tournament ?? 0)),\n      this.rules.bulkGet(games.map(g => g?.rule ?? 0)),\n      this.openings.bulkGet(games.map(g => g?.opening ?? 0)),\n    ])\n    return games.map((game, i) => {\n      const r = game?.bresult ?? null\n      const blackWon = r === 1 ? true : r === 0 ? false : null\n      const whiteWon = r === 0 ? true : r === 1 ? false : null\n      return {\n        id: game?.id ?? 0,\n        black: blacks[i] ?? unknownRIFPlayer(),\n        white: whites[i] ?? unknownRIFPlayer(),\n        blackWon,\n        whiteWon,\n        moves: parsePoints(game?.move ?? '') ?? [],\n        btime: game?.btime ?? 0,\n        wtime: game?.wtime ?? 0,\n        opening: openings[i] ?? unknownRIFOpening(),\n        rule: rules[i] ?? unknownRIFRule(),\n        alt: game?.alt ?? '',\n        alts: [], // TODO\n        swap: game?.swap ?? '',\n        info: game?.info ?? '',\n        publisher: publishers[i] ?? unknownRIFPlayer(),\n        tournament: tournaments[i] ?? unknownRIFTournament(),\n        round: game?.round ?? '',\n      }\n    })\n  }\n\n  async getPlayer(playerId: RIFPlayer['id']): Promise<RIFPlayer | undefined> {\n    return await this.players.get(playerId)\n  }\n\n  async getGamesByIdRange(start: RIFGame['id'], end: RIFGame['id']): Promise<RIFGame[]> {\n    return await this.games.where('id').between(start, end).toArray()\n  }\n\n  async getMaxGameId(): Promise<RIFGame['id']> {\n    const maxGame = await this.games.orderBy('id').last()\n    return maxGame?.id ?? 0\n  }\n\n  async getTournamentsStartDateNumberMap(): Promise<Map<RIFTournament['id'], number>> {\n    const ts = await this.tournaments.toArray()\n    const result = new Map<RIFTournament['id'], number>()\n    for (let i = 0; i < ts.length; i++) {\n      const t = ts[i]\n      const m = t.start.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/)\n      if (m) {\n        const [yyyy, mm, dd] = [m[1], m[2], m[3]]\n        result.set(t.id, parseInt(yyyy + mm + dd))\n      } else {\n        result.set(t.id, 0)\n      }\n    }\n    return result\n  }\n\n  async getTournamentsRatedMap(): Promise<Map<RIFTournament['id'], boolean>> {\n    const ts = await this.tournaments.toArray()\n    const result = new Map<RIFTournament['id'], boolean>()\n    for (let i = 0; i < ts.length; i++) {\n      const t = ts[i]\n      result.set(t.id, t.rated)\n    }\n    return result\n  }\n\n  async getCountriesMap(): Promise<Map<RIFCountry['id'], RIFCountry>> {\n    const arr = await this.countries.toArray()\n    const result = new Map<RIFCountry['id'], RIFCountry>()\n    for (let i = 0; i < arr.length; i++) {\n      const x = arr[i]\n      result.set(x.id, x)\n    }\n    return result\n  }\n\n  async getCitiesMap(): Promise<Map<RIFCity['id'], RIFCity>> {\n    const arr = await this.cities.toArray()\n    const result = new Map<RIFCity['id'], RIFCity>()\n    for (let i = 0; i < arr.length; i++) {\n      const x = arr[i]\n      result.set(x.id, x)\n    }\n    return result\n  }\n\n  async loadFromFile(file: File, progress: (percentile: number) => void = () => {}) {\n    const text = await file.text()\n    const dom = new DOMParser().parseFromString(text, 'application/xml')\n\n    const countries = dom.querySelector(TableName.countries)\n    const promises = []\n    if (countries !== null) {\n      promises.push(this.addCountries(countries.children))\n    }\n    const cities = dom.querySelector(TableName.cities)\n    if (cities !== null) {\n      promises.push(this.addCities(cities.children))\n    }\n    const months = dom.querySelector(TableName.months)\n    if (months !== null) {\n      promises.push(this.addMonths(months.children))\n    }\n    const openings = dom.querySelector(TableName.openings)\n    if (openings !== null) {\n      promises.push(this.addOpenings(openings.children))\n    }\n    const rules = dom.querySelector(TableName.rules)\n    if (rules !== null) {\n      promises.push(this.addRules(rules.children))\n    }\n    const players = dom.querySelector(TableName.players)\n    if (players !== null) {\n      promises.push(this.addPlayers(players.children))\n    }\n    const tournaments = dom.querySelector(TableName.tournaments)\n    if (tournaments !== null) {\n      promises.push(this.addTournaments(tournaments.children))\n    }\n    const games = dom.querySelector(TableName.games)\n    if (games !== null) {\n      promises.push(this.addGames(games.children, progress))\n    }\n    await Promise.all(promises)\n  }\n\n  private async addCountries(elems: HTMLCollection) {\n    const items: RIFCountry[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        abbr: e.getAttribute('abbr') ?? '',\n      })\n    }\n    await this.transaction('rw', this.countries, async () => {\n      await this.countries.bulkAdd(items)\n    })\n  }\n\n  private async addCities(elems: HTMLCollection) {\n    const items: RIFCity[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        country: parseInt(e.getAttribute('country') ?? ''),\n      })\n    }\n    await this.transaction('rw', this.cities, async () => {\n      await this.cities.bulkAdd(items)\n    })\n  }\n\n  private async addMonths(elems: HTMLCollection) {\n    const items: RIFMonth[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n      })\n    }\n    await this.transaction('rw', this.months, async () => {\n      await this.months.bulkAdd(items)\n    })\n  }\n\n  private async addRules(elems: HTMLCollection) {\n    const items: RIFRule[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        info: e.getElementsByTagName('info').item(0)?.innerHTML ?? '',\n      })\n    }\n    await this.transaction('rw', this.rules, async () => {\n      await this.rules.bulkAdd(items)\n    })\n  }\n\n  private async addOpenings(elems: HTMLCollection) {\n    const items: RIFOpening[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        abbr: e.getAttribute('abbr') ?? '',\n      })\n    }\n    await this.transaction('rw', this.openings, async () => {\n      await this.openings.bulkAdd(items)\n    })\n  }\n\n  private async addPlayers(elems: HTMLCollection) {\n    const items: RIFPlayer[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        surname: e.getAttribute('surname') ?? '',\n        country: parseInt(e.getAttribute('country') ?? ''),\n        city: parseInt(e.getAttribute('city') ?? ''),\n      })\n    }\n    await this.transaction('rw', this.players, async () => {\n      await this.players.bulkAdd(items)\n    })\n  }\n\n  private async addTournaments(elems: HTMLCollection) {\n    const items: RIFTournament[] = []\n    for (let i = 0; i < elems.length; i++) {\n      const [e, id] = getElemWithId(elems, i) ?? []\n      if (!e || !id) continue\n      items.push({\n        id: id,\n        name: e.getAttribute('name') ?? '',\n        country: parseInt(e.getAttribute('country') ?? ''),\n        city: parseInt(e.getAttribute('city') ?? ''),\n        year: parseInt(e.getAttribute('year') ?? ''),\n        month: parseInt(e.getAttribute('month') ?? ''),\n        start: e.getAttribute('start') ?? '',\n        end: e.getAttribute('end') ?? '',\n        rule: parseInt(e.getAttribute('rule') ?? ''),\n        rated: (e.getAttribute('rated') ?? '') === '1',\n      })\n    }\n    await this.transaction('rw', this.tournaments, async () => {\n      await this.tournaments.bulkAdd(items)\n    })\n  }\n\n  private async addGames(elems: HTMLCollection, progress: (percentile: number) => void = () => {}) {\n    for (let c = 0; c < elems.length; c += CHUNK_SIZE) {\n      const items: RIFGame[] = []\n      for (let i = 0; i < CHUNK_SIZE; i++) {\n        const [e, id] = getElemWithId(elems, c + i) ?? []\n        if (!e || !id) continue\n        items[i] = {\n          id: id,\n          publisher: parseInt(e.getAttribute('publisher') ?? ''),\n          tournament: parseInt(e.getAttribute('tournament') ?? ''),\n          round: e.getAttribute('round') ?? '',\n          rule: parseInt(e.getAttribute('rule') ?? ''),\n          black: parseInt(e.getAttribute('black') ?? ''),\n          white: parseInt(e.getAttribute('white') ?? ''),\n          bresult: parseFloat(e.getAttribute('bresult') ?? ''),\n          btime: parseInt(e.getAttribute('btime') ?? ''),\n          wtime: parseInt(e.getAttribute('wtime') ?? ''),\n          opening: parseInt(e.getAttribute('opening') ?? ''),\n          alt: e.getAttribute('alt') ?? '',\n          swap: e.getAttribute('swap') ?? '',\n          move: e.getElementsByTagName('move').item(0)?.innerHTML ?? '',\n          info: e.getElementsByTagName('info').item(0)?.innerHTML ?? '',\n        }\n      }\n      await this.transaction('rw', this.games, async () => {\n        await this.games.bulkAdd(items)\n      })\n      progress(Math.floor(((c + CHUNK_SIZE) * 100) / elems.length))\n    }\n    progress(100)\n  }\n}\n\nconst getElemWithId = (elems: HTMLCollection, i: number): [Element, number] | undefined => {\n  const e = elems.item(i)\n  if (!e) return\n  const id = parseInt(e.id)\n  if (isNaN(id)) return\n  return [e, id]\n}\n\nconst unknownRIFPlayer = (): RIFPlayer => ({\n  id: 0,\n  name: '',\n  surname: '',\n  country: 0,\n  city: 0,\n})\n\nconst unknownRIFOpening = (): RIFOpening => ({\n  id: 0,\n  name: '',\n  abbr: '',\n})\n\nconst unknownRIFRule = (): RIFRule => ({\n  id: 0,\n  name: '',\n  info: '',\n})\n\nconst unknownRIFTournament = (): RIFTournament => ({\n  id: 0,\n  name: '',\n  country: 0,\n  city: 0,\n  year: 0,\n  month: 0,\n  start: '',\n  end: '',\n  rule: 0,\n  rated: false,\n})\n\nexport const playerShortName = (p: RIFPlayer): string =>\n  `${p.name.trim()[0] ?? '?'}. ${p.surname.trim()}`\n\nexport const ruleShortName = (name: string): string => {\n  if (name === 'RIF') {\n    return 'RIF'\n  }\n  let m = name.match(/^Soosyrv(-[0-9]+)?$/)\n  if (m) {\n    return `SS${m[1] ?? ''}`\n  }\n  m = name.match(/^Taraguchi(-[0-9]+)?$/)\n  if (m) {\n    return `TG${m[1] ?? ''}`\n  }\n  m = name.match(/^Yamasyrv(-[0-9]+)?$/)\n  if (m) {\n    return `YS${m[1] ?? ''}`\n  }\n  m = name.match(/^Yamaguchi$/)\n  if (m) {\n    return 'YG'\n  }\n  m = name.match(/^Tarannikov$/)\n  if (m) {\n    return 'TN'\n  }\n  m = name.match(/^Sakata$/)\n  if (m) {\n    return 'SK'\n  }\n  m = name.match(/^LinHuan$/)\n  if (m) {\n    return 'LH'\n  }\n  return 'other'\n}\n","import Dexie, { Table } from 'dexie'\nimport { Point } from 'renjukit'\nimport { encodeAccumulatedMoves } from '../analysis'\nimport { Game } from '../rule'\nimport { RIFDatabase, RIFGame } from './rif'\n\nconst VERSION = 2\nconst EXAMPLE_MOVES: Point[] = [\n  [8, 8],\n  [9, 9],\n  [6, 6],\n] // I13\n\nconst CHUNK_SIZE = 2000\n\nconst MIN_ENCODE_MOVES = 3\nconst MAX_ENCODE_MOVES = 20\nconst MAX_SEARCH_HIT = 1000\n\nconst tableNames = ['games'] as const\ntype TableName = typeof tableNames[number]\nconst TableName: Record<TableName, TableName> = {\n  games: tableNames[0],\n}\n\ntype AnalyzedGame = {\n  id: RIFGame['id']\n  date: number\n  board: string[]\n  player: number[]\n  rated: boolean\n}\n\nconst indexedFields: Record<TableName, string> = {\n  games: 'id,date,*board,*player',\n}\n\ntype SearchQuery = {\n  moves: Point[] | undefined\n  playerId: number | undefined\n  limit?: number\n  offset?: number\n  desc?: boolean\n}\n\ntype SearchCondition = {\n  board?: string\n  player?: number\n}\n\ntype SearchResult = {\n  ids: number[]\n  hit: number\n  error?: string\n}\n\nexport class AnalyzedDatabase extends Dexie {\n  static readonly DBNAME = 'analyzed'\n  private readonly games: Table<AnalyzedGame, number>\n\n  static reset() {\n    indexedDB.deleteDatabase(AnalyzedDatabase.DBNAME)\n  }\n\n  constructor() {\n    super(AnalyzedDatabase.DBNAME)\n    this.version(VERSION).stores(indexedFields)\n    this.games = this.table(TableName.games)\n  }\n\n  async loadFromRIFDatabase(progress: (percentile: number) => void = () => {}) {\n    const rif = new RIFDatabase()\n    const [dateMap, ratedMap, maxId] = await Promise.all([\n      rif.getTournamentsStartDateNumberMap(),\n      rif.getTournamentsRatedMap(),\n      rif.getMaxGameId(),\n    ])\n    progress(0)\n    for (let startId = 0; startId <= maxId; startId += CHUNK_SIZE) {\n      const items = await rif.getGamesByIdRange(startId, startId + CHUNK_SIZE)\n      const games = items.map(item => {\n        const game = Game.decode(item.move) ?? new Game({})\n        const boardCodes = encodeAccumulatedMoves(game.moves.slice(0, MAX_ENCODE_MOVES)).slice(\n          MIN_ENCODE_MOVES - 1\n        )\n        return {\n          id: item.id,\n          date: dateMap.get(item.tournament) ?? 0,\n          board: boardCodes,\n          player: [item.black, item.white],\n          rated: ratedMap.get(item.tournament) ?? false,\n        }\n      })\n      await this.games.bulkAdd(games)\n      progress(Math.floor(((startId + CHUNK_SIZE) * 100) / maxId))\n    }\n    progress(100)\n  }\n\n  async search({\n    moves,\n    playerId,\n    limit = MAX_SEARCH_HIT,\n    offset = 0,\n    desc = true,\n  }: SearchQuery): Promise<SearchResult> {\n    const condition: SearchCondition = {}\n    if (moves !== undefined) {\n      if (moves.length < MIN_ENCODE_MOVES) {\n        return {\n          ids: [],\n          hit: 0,\n          error: `Too few moves to search (${moves.length} < ${MIN_ENCODE_MOVES})`,\n        }\n      }\n      if (moves.length > MAX_ENCODE_MOVES) {\n        return {\n          ids: [],\n          hit: 0,\n          error: `Too many moves to search (${moves.length} > ${MAX_ENCODE_MOVES})`,\n        }\n      }\n      const boardCode = encodeAccumulatedMoves(moves)[moves.length - 1]\n      condition.board = boardCode\n    }\n\n    if (playerId !== undefined) {\n      condition.player = playerId\n    }\n\n    if (condition.player === undefined && condition.board === undefined) {\n      return {\n        ids: [],\n        hit: 0,\n        error: 'Specify moves or player',\n      }\n    }\n\n    const hit = await this.games.where(condition).distinct().count()\n    if (hit <= 0) {\n      return {\n        ids: [],\n        hit,\n        error: 'No game found',\n      }\n    }\n    if (hit > MAX_SEARCH_HIT) {\n      return {\n        ids: [],\n        hit,\n        error: `Too many games (${hit} > ${MAX_SEARCH_HIT})`,\n      }\n    }\n\n    let collection = this.games.where(condition).distinct()\n    if (desc) collection = collection.reverse()\n    const ids = (await collection.sortBy('date')).slice(offset, offset + limit).map(g => g.id)\n    return { ids, hit }\n  }\n\n  async ready(): Promise<boolean> {\n    try {\n      const example = encodeAccumulatedMoves(EXAMPLE_MOVES)[EXAMPLE_MOVES.length - 1]\n      return (await this.games.where({ board: example }).first()) !== undefined\n    } catch (e) {\n      console.log(e)\n      return false\n    }\n  }\n}\n","import Dexie from 'dexie'\nimport { AnalyzedDatabase } from './analyzed'\nimport { RIFDatabase } from './rif'\n\nexport * from './analyzed'\nexport * from './rif'\n\nexport const ready = async (): Promise<boolean> => {\n  const bs = await Promise.all([\n    Dexie.exists(RIFDatabase.DBNAME),\n    Dexie.exists(AnalyzedDatabase.DBNAME),\n  ])\n  return bs[0] && bs[1]\n}\n","import { Point, pointEqual } from 'renjukit'\nimport { Game } from '../../rule'\n\nexport class GameState {\n  readonly main: Game = new Game()\n  readonly cursor: number = 0\n  readonly branch: Point[] = []\n  readonly gameid: number | undefined\n\n  constructor(init?: undefined | Partial<GameState>) {\n    if (init !== undefined) {\n      Object.assign(this, init)\n      if (!('cursor' in init)) this.cursor = this.main.size\n    }\n  }\n\n  private update(fields: Partial<GameState>): GameState {\n    return new GameState({ ...this, ...fields, cache: undefined })\n  }\n\n  canMove(p: Point): boolean {\n    return !this.current.has(p)\n  }\n\n  move(p: Point): GameState {\n    if (!this.canMove(p)) return this\n    if (this.isBranching) {\n      return this.moveBranch(p)\n    } else if (!this.isLast && pointEqual(p, this.main.moves[this.cursor])) {\n      return this.forward()\n    } else if (!this.isLast || this.isReadOnly) {\n      return this.moveBranch(p)\n    } else {\n      return this.moveMain(p)\n    }\n  }\n\n  get canUndo(): boolean {\n    return this.isBranching || (!this.isReadOnly && this.isLast && !this.main.empty)\n  }\n\n  undo(): GameState {\n    if (!this.canUndo) return this\n    if (this.isBranching) {\n      return this.undoBranch()\n    } else {\n      return this.undoMain()\n    }\n  }\n\n  get canClearRest(): boolean {\n    return !this.isBranching && !this.isReadOnly && !this.isLast\n  }\n\n  clearRest(): GameState {\n    if (!this.canClearRest) return this\n    return this.update({ main: this.main.cut(this.cursor) }).toLast()\n  }\n\n  /* main game */\n\n  private moveMain(p: Point): GameState {\n    return this.update({ main: this.main.move(p) }).toLast()\n  }\n\n  private undoMain(): GameState {\n    return this.update({ main: this.main.undo() }).toLast()\n  }\n\n  /* navigate */\n\n  get isStart(): boolean {\n    return this.cursor === 0\n  }\n\n  get isLast(): boolean {\n    return this.cursor === this.main.size\n  }\n\n  get canForward() {\n    return !this.isBranching && !this.isLast\n  }\n\n  forward(): GameState {\n    if (!this.canForward) return this\n    return this.navigate(this.cursor + 1)\n  }\n\n  toLast(): GameState {\n    if (!this.canForward) return this\n    return this.navigate(this.main.size)\n  }\n\n  get canBackward() {\n    return !this.isBranching && !this.isStart\n  }\n\n  backward(): GameState {\n    if (!this.canBackward) return this\n    return this.navigate(this.cursor - 1)\n  }\n\n  toStart(): GameState {\n    if (!this.canBackward) return this\n    return this.navigate(0)\n  }\n\n  private navigate(i: number): GameState {\n    if (i < 0 || this.main.size < i) return this\n    return this.update({ cursor: i })\n  }\n\n  /* branch */\n\n  get isBranching(): boolean {\n    return this.branch.length > 0\n  }\n\n  private moveBranch(p: Point): GameState {\n    return this.update({ branch: [...this.branch, p] })\n  }\n\n  private undoBranch(): GameState {\n    return this.update({ branch: this.branch.slice(0, this.branch.length - 1) })\n  }\n\n  clearBranch(): GameState {\n    return this.update({ branch: [] })\n  }\n\n  newFromBranch(): GameState {\n    return new GameState({ main: this.current, cursor: this.current.size })\n  }\n\n  invertMoves(inverted: boolean): GameState {\n    return this.update({\n      main: this.main.invert(inverted),\n      gameid: undefined,\n    })\n  }\n\n  /* current game */\n\n  get current(): Game {\n    return new Game({\n      moves: [...this.main.cut(this.cursor).moves, ...this.branch],\n      inverted: this.main.inverted,\n    })\n  }\n\n  get blacks(): Point[] {\n    return this.current.blacks\n  }\n\n  get whites(): Point[] {\n    return this.current.whites\n  }\n\n  get isBlackTurn(): boolean {\n    return this.current.isBlackTurn\n  }\n\n  get isReadOnly(): boolean {\n    return this.gameid !== undefined\n  }\n\n  encode(): string {\n    const codes: string[] = []\n    if (this.gameid !== undefined) codes.push(`gid:${this.gameid}`)\n    if (!this.main.empty) codes.push(`g:${this.main.encode()}`)\n    if (this.main.inverted) codes.push(`o:i`)\n    if (this.cursor !== 0) codes.push(`c:${this.cursor}`)\n    return codes.join(',')\n  }\n\n  static decode(code: string): GameState | undefined {\n    const codes = code.split(',')\n    const find = (s: string) => codes.find(c => c.startsWith(s))?.replace(s, '') ?? ''\n    const gameCode = find('g:')\n    const cursorCode = find('c:')\n    const gidCode = find('gid:')\n    const invertedCode = find('o:')\n    const main = (Game.decode(gameCode) ?? new Game()).invert(invertedCode.includes('i'))\n    const cursor = Math.min(main.size, parseInt(cursorCode) || 0)\n    const gameid = parseInt(gidCode) || undefined\n    return new GameState({ main, cursor, gameid })\n  }\n}\n","export class OptionsState<T extends string> {\n  readonly map: Partial<Record<T, boolean>> = {}\n\n  constructor(init?: Partial<Record<T, boolean>>) {\n    if (init) this.map = init\n  }\n\n  has(v: T): boolean {\n    return !!this.map[v]\n  }\n\n  on(values: T[]): OptionsState<T> {\n    const map: Partial<Record<T, boolean>> = {}\n    for (const v of values) map[v] = true\n    return new OptionsState<T>({ ...this.map, ...map })\n  }\n\n  off(values: T[]): OptionsState<T> {\n    const map: Partial<Record<T, boolean>> = {}\n    for (const v of values) map[v] = false\n    return new OptionsState<T>({ ...this.map, ...map })\n  }\n\n  change(targets: T[], on: T[]): OptionsState<T> {\n    const map: Partial<Record<T, boolean>> = {}\n    for (const v of targets) {\n      map[v] = on.includes(v)\n    }\n    return new OptionsState<T>({ ...this.map, ...map })\n  }\n\n  get empty(): boolean {\n    for (const v in this.map) {\n      if (this.map[v]) return false\n    }\n    return true\n  }\n\n  get values(): T[] {\n    const values: T[] = []\n    for (const v in this.map) {\n      if (this.map[v] === true) values.push(v)\n    }\n    return values\n  }\n}\n","import { parsePoints, Point, pointEqual, wrapPoint } from 'renjukit'\n\nexport class PointsState {\n  readonly points: Point[] = []\n\n  constructor(init?: undefined | Partial<PointsState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<PointsState>): PointsState {\n    return new PointsState({ ...this, ...fields })\n  }\n\n  edit(p: Point): PointsState {\n    const ps = this.points\n    const idx = ps.findIndex(q => pointEqual(p, q))\n    return this.update({\n      points: idx < 0 ? [...ps, p] : [...ps.slice(0, idx), ...ps.slice(idx + 1)],\n    })\n  }\n\n  undo(): PointsState {\n    return this.update({\n      points: this.points.slice(0, this.points.length - 1),\n    })\n  }\n\n  has(p: Point): boolean {\n    return this.points.findIndex(q => pointEqual(p, q)) >= 0\n  }\n\n  get canUndo(): boolean {\n    return this.points.length > 0\n  }\n\n  get empty(): boolean {\n    return this.points.length === 0\n  }\n\n  encode(): string {\n    return this.points.map(p => wrapPoint(p).toString()).join('')\n  }\n\n  static decode(code: string): PointsState | undefined {\n    const points = parsePoints(code)\n    return points && new PointsState({ points: points })\n  }\n}\n","import { parsePoints, Point, pointEqual, wrapPoints } from 'renjukit'\n\ntype Segment = [Point, Point]\n\nexport class SegmentsState {\n  readonly segments: Segment[] = []\n  readonly start: Point | undefined = undefined\n\n  constructor(init?: undefined | Partial<SegmentsState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<SegmentsState>): SegmentsState {\n    return new SegmentsState({ ...this, ...fields })\n  }\n\n  draw(p: Point): SegmentsState {\n    if (this.start === undefined) {\n      return this.update({ start: p })\n    }\n\n    const segment: Segment = [this.start, p]\n    if (this.has(segment) || !valid(segment)) {\n      return this.update({ start: undefined })\n    }\n    return this.update({\n      segments: [...this.segments, segment],\n      start: undefined,\n    })\n  }\n\n  undo(): SegmentsState {\n    if (this.start !== undefined) {\n      return this.update({ start: undefined })\n    }\n    return this.update({\n      segments: this.segments.slice(0, this.segments.length - 1),\n    })\n  }\n\n  unstart(): SegmentsState {\n    return this.update({ start: undefined })\n  }\n\n  get canUndo(): boolean {\n    return this.start !== undefined || this.segments.length > 0\n  }\n\n  get empty(): boolean {\n    return this.segments.length === 0\n  }\n\n  private has(segment: Segment): boolean {\n    return includes(this.segments, segment)\n  }\n\n  encode(): string {\n    return this.segments.map(s => wrapPoints(s).toString('')).join('')\n  }\n\n  static decode(code: string): SegmentsState | undefined {\n    const points = parsePoints(code)\n    if (!points) return undefined\n    if (points.length % 2 !== 0) return undefined\n    const segments: Segment[] = []\n    for (let i = 0; i < points.length / 2; i++) {\n      const l: Segment = [points[i * 2], points[i * 2 + 1]]\n      if (valid(l) && !includes(segments, l)) segments.push(l)\n    }\n    return new SegmentsState({ segments: segments })\n  }\n}\n\nconst includes = (segments: Segment[], [start, end]: Segment): boolean =>\n  segments.findIndex(\n    ([s, e]) =>\n      (pointEqual(start, s) && pointEqual(end, e)) || (pointEqual(start, e) && pointEqual(end, s))\n  ) >= 0\n\nconst valid = ([start, end]: Segment): boolean => {\n  if (pointEqual(start, end)) return false\n  const [sx, sy] = start\n  const [ex, ey] = end\n  return (\n    sx === ex || // vertical\n    sy === ey || // horizontal\n    ex - sx === ey - sy || // ascending\n    ex - sx === sy - ey // descending\n  )\n}\n","import { Board, makeBoard, Player, Point, wrapBoard } from 'renjukit'\nimport { GameState, PointsState, SegmentsState } from './common'\n\nconst boardModes = [\n  'game',\n  'freeBlacks',\n  'freeWhites',\n  'markerPoints',\n  'markerLines',\n  'preview',\n] as const\nexport type BoardMode = typeof boardModes[number]\nexport const BoardMode: Record<BoardMode, BoardMode> = {\n  game: 'game',\n  freeBlacks: 'freeBlacks',\n  freeWhites: 'freeWhites',\n  markerPoints: 'markerPoints',\n  markerLines: 'markerLines',\n  preview: 'preview',\n} as const\n\nexport class BoardState {\n  readonly mode: BoardMode = BoardMode.game\n  readonly game: GameState = new GameState()\n  readonly freeBlacks: PointsState = new PointsState()\n  readonly freeWhites: PointsState = new PointsState()\n  readonly markerPoints: PointsState = new PointsState()\n  readonly markerLines: SegmentsState = new SegmentsState()\n  readonly markerPath: PointsState = new PointsState()\n  readonly pathTurn: boolean = true\n  readonly evals: { x: number; y: number; score: number }[] = []\n  private cache: Board | undefined\n\n  constructor(init?: undefined | Partial<BoardState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<BoardState>): BoardState {\n    return new BoardState({ ...this, ...fields, cache: undefined })\n  }\n\n  /* edit */\n\n  private canEdit(p: Point): boolean {\n    switch (this.mode) {\n      case BoardMode.game:\n        return this.canEditMove(p)\n      case BoardMode.freeBlacks:\n        return this.canEditFreeStone(p) && !this.freeWhites.has(p)\n      case BoardMode.freeWhites:\n        return this.canEditFreeStone(p) && !this.freeBlacks.has(p)\n      case BoardMode.markerPoints:\n        return true\n      case BoardMode.markerLines:\n        return true\n      default:\n        return false\n    }\n  }\n\n  private canEditMove(p: Point): boolean {\n    return this.game.canMove(p) && !this.freeBlacks.has(p) && !this.freeWhites.has(p)\n  }\n\n  private canEditFreeStone(p: Point): boolean {\n    return this.game.isLast && !this.game.isBranching && !this.game.main.has(p)\n  }\n\n  edit(p: Point): BoardState {\n    if (!this.canEdit(p)) return this\n    switch (this.mode) {\n      case BoardMode.game:\n        return this.update({ game: this.game.move(p) })\n      case BoardMode.freeBlacks:\n        return this.update({ freeBlacks: this.freeBlacks.edit(p) })\n      case BoardMode.freeWhites:\n        return this.update({ freeWhites: this.freeWhites.edit(p) })\n      case BoardMode.markerPoints:\n        return this.update({ markerPoints: this.markerPoints.edit(p) })\n      case BoardMode.markerLines:\n        return this.update({ markerLines: this.markerLines.draw(p) })\n      default:\n        return this\n    }\n  }\n\n  /* edit menu */\n\n  setMode(mode: BoardMode): BoardState {\n    return this.update({\n      mode: mode,\n      markerLines: mode === BoardMode.markerPoints ? this.markerLines : this.markerLines.unstart(),\n    })\n  }\n\n  setGame(game: GameState): BoardState {\n    return this.update({ game })\n  }\n\n  /* undo */\n\n  get canUndo(): boolean {\n    switch (this.mode) {\n      case BoardMode.game:\n        return this.game.canUndo\n      case BoardMode.freeBlacks:\n        return this.freeBlacks.canUndo\n      case BoardMode.freeWhites:\n        return this.freeWhites.canUndo\n      case BoardMode.markerPoints:\n        return this.markerPoints.canUndo\n      case BoardMode.markerLines:\n        return this.markerLines.canUndo\n      default:\n        return false\n    }\n  }\n\n  undo(): BoardState {\n    if (!this.canUndo) return this\n    switch (this.mode) {\n      case BoardMode.game:\n        return this.update({ game: this.game.undo() })\n      case BoardMode.freeBlacks:\n        return this.update({ freeBlacks: this.freeBlacks.undo() })\n      case BoardMode.freeWhites:\n        return this.update({ freeWhites: this.freeWhites.undo() })\n      case BoardMode.markerPoints:\n        return this.update({ markerPoints: this.markerPoints.undo() })\n      case BoardMode.markerLines:\n        return this.update({ markerLines: this.markerLines.undo() })\n      default:\n        return this\n    }\n  }\n\n  get canClearRestOfMoves(): boolean {\n    return this.mode === BoardMode.game && !this.canUndo && this.game.canClearRest\n  }\n\n  get canClearMainGame(): boolean {\n    return this.mode === BoardMode.game && !this.canUndo && this.game.isReadOnly\n  }\n\n  /* general */\n\n  setMarkerPath(points: Point[]): BoardState {\n    return this.update({ markerPath: new PointsState({ points }) })\n  }\n\n  setPathTurn(pathTurn: boolean): BoardState {\n    return this.update({ pathTurn })\n  }\n\n  setEvals(evals: { x: number; y: number; score: number }[]): BoardState {\n    return this.update({ evals })\n  }\n\n  get current(): Board {\n    if (this.cache === undefined) this.cache = makeBoard(this.blacks, this.whites)\n    return this.cache\n  }\n\n  get blacks(): Point[] {\n    return [...this.game.blacks, ...this.freeBlacks.points]\n  }\n\n  get whites(): Point[] {\n    return [...this.game.whites, ...this.freeWhites.points]\n  }\n\n  /* encode */\n  convertMovesToStones(): BoardState {\n    const board = wrapBoard(this.current)\n    return this.update({\n      mode: BoardMode.game,\n      game: new GameState(),\n      freeBlacks: new PointsState({ points: board.stones(Player.black) }),\n      freeWhites: new PointsState({ points: board.stones(Player.white) }),\n    })\n  }\n\n  /* encode */\n\n  encode(): string {\n    const codes: string[] = []\n    const mainGameCode = this.game.encode()\n    if (mainGameCode !== '') codes.push(mainGameCode)\n    if (!this.freeBlacks.empty) codes.push(`b:${this.freeBlacks.encode()}`)\n    if (!this.freeWhites.empty) codes.push(`w:${this.freeWhites.encode()}`)\n    if (!this.markerPoints.empty) codes.push(`p:${this.markerPoints.encode()}`)\n    if (!this.markerLines.empty) codes.push(`l:${this.markerLines.encode()}`)\n    return codes.join(',')\n  }\n\n  static decode(code: string): BoardState | undefined {\n    const codes = code.split(',')\n    const find = (s: string) => codes.find(c => c.startsWith(s))?.replace(s, '') ?? ''\n    const mainGameCode = `gid:${find('gid:')},g:${find('g:')},o:${find('o:')},c:${find('c:')}`\n    const freeBlacksCode = find('b:')\n    const freeWhitesCode = find('w:')\n    const markerPointsCode = find('p:')\n    const markerLinesCode = find('l:')\n    return new BoardState({\n      mode: BoardMode.game,\n      game: GameState.decode(mainGameCode) ?? new GameState(),\n      freeBlacks: PointsState.decode(freeBlacksCode) ?? new PointsState(),\n      freeWhites: PointsState.decode(freeWhitesCode) ?? new PointsState(),\n      markerPoints: PointsState.decode(markerPointsCode) ?? new PointsState(),\n      markerLines: SegmentsState.decode(markerLinesCode) ?? new SegmentsState(),\n    })\n  }\n}\n","export class ConfirmOption {\n  readonly text: string = ''\n  readonly colorScheme?: string\n  readonly onClick?: () => void\n\n  constructor(init?: undefined | Partial<ConfirmOption>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n}\n\nexport class ConfirmState {\n  readonly ok: ConfirmOption = new ConfirmOption()\n  readonly cancel: ConfirmOption = new ConfirmOption()\n\n  constructor(init?: undefined | Partial<ConfirmState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n}\n","const DEFAULT_PAGE_SIZE = 20\n\nexport class PagerState {\n  readonly hit: number = 0\n  readonly page: number = 0\n  readonly pageSize: number = DEFAULT_PAGE_SIZE\n\n  constructor(init?: undefined | Partial<PagerState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<PagerState>): PagerState {\n    return new PagerState({ ...this, ...fields })\n  }\n\n  get lastPage(): number {\n    return ~~((this.hit - 1) / this.pageSize)\n  }\n\n  private navigate(page: number): PagerState {\n    if (page < 0 || this.lastPage < page) return this\n    return this.update({ page })\n  }\n\n  get isFirst(): boolean {\n    return this.page === 0\n  }\n\n  get isLast(): boolean {\n    return this.page === this.lastPage\n  }\n\n  next(): PagerState {\n    if (this.isLast) return this\n    return this.navigate(this.page + 1)\n  }\n\n  toLast(): PagerState {\n    if (this.isLast) return this\n    return this.navigate(this.lastPage)\n  }\n\n  prev(): PagerState {\n    if (this.isFirst) return this\n    return this.navigate(this.page - 1)\n  }\n\n  toFirst(): PagerState {\n    if (this.isFirst) return this\n    return this.navigate(0)\n  }\n\n  get pageStart(): number {\n    return this.page * this.pageSize\n  }\n\n  get pageEnd(): number {\n    return Math.min((this.page + 1) * this.pageSize, this.hit)\n  }\n\n  toString(): string {\n    const start = this.page * this.pageSize + 1\n    const last = Math.min((this.page + 1) * this.pageSize, this.hit)\n    return `${start}-${last} of ${this.hit}`\n  }\n}\n","import { Point } from 'renjukit'\n\ntype SearchQuery = {\n  moves: Point[] | undefined\n  playerId: number | undefined\n}\n\nexport class SearchQueryState {\n  readonly moves: Point[] = []\n  readonly useMoves: boolean = true\n  readonly playerId?: number\n\n  constructor(init?: undefined | Partial<SearchQueryState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<SearchQueryState>): SearchQueryState {\n    return new SearchQueryState({ ...this, ...fields })\n  }\n\n  setMoves(ps: Point[]): SearchQueryState {\n    return this.update({ moves: ps })\n  }\n\n  setUseMoves(on: boolean): SearchQueryState {\n    return this.update({ useMoves: on })\n  }\n\n  setPlayerId(id: number | undefined): SearchQueryState {\n    return this.update({ playerId: id })\n  }\n\n  get query(): SearchQuery {\n    return {\n      moves: this.useMoves && this.moves.length > 0 ? this.moves : undefined,\n      playerId: this.playerId,\n    }\n  }\n}\n\nexport class SearchResultState {\n  readonly hit: number = 0\n  readonly gameIds: number[] = []\n  readonly error?: string\n\n  constructor(init?: undefined | Partial<SearchResultState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n}\n","const tabNames = ['search', 'stats', 'detail', 'engine', 'setup'] as const\nexport type TabName = typeof tabNames[number]\nexport const TabName: Record<TabName, TabName> = {\n  search: 'search',\n  stats: 'stats',\n  detail: 'detail',\n  engine: 'engine',\n  setup: 'setup',\n} as const\n\nexport class TabsState {\n  readonly current: TabName = TabName.engine\n  readonly names: TabName[] = [TabName.engine, TabName.setup]\n\n  constructor(init?: undefined | Partial<TabsState>) {\n    if (init !== undefined) Object.assign(this, init)\n  }\n\n  private update(fields: Partial<TabsState>): TabsState {\n    return new TabsState({ ...this, ...fields })\n  }\n\n  setCurrent(name: TabName): TabsState {\n    return this.update({ current: name })\n  }\n\n  setNames(names: TabName[]): TabsState {\n    return this.update({ names: names })\n  }\n\n  setIndex(index: number): TabsState {\n    return this.update({ current: this.names[index] })\n  }\n\n  get index(): number {\n    return this.names.indexOf(this.current)\n  }\n}\n","import { createContext, FC, useEffect, useState } from 'react'\nimport { ready } from '../../database'\nimport { SearchQueryState, SearchResultState, TabName, TabsState } from '../../state'\n\nexport type AdvancedContext = {\n  tabsState: TabsState\n  setTabsState: (s: TabsState) => void\n  searchQueryState: SearchQueryState\n  setSearchQueryState: (s: SearchQueryState) => void\n  searchResultState: SearchResultState\n  setSearchResultState: (s: SearchResultState) => void\n}\n\nexport const AdvancedContext = createContext<AdvancedContext>({\n  tabsState: new TabsState(),\n  setTabsState: () => {},\n  searchQueryState: new SearchQueryState(),\n  setSearchQueryState: () => {},\n  searchResultState: new SearchResultState(),\n  setSearchResultState: () => {},\n})\n\nexport const AdvancedContextProvider: FC = ({ children }) => {\n  const [tabsState, setTabsState] = useState<TabsState>(new TabsState())\n  const [searchQueryState, setSearchQueryState] = useState<SearchQueryState>(new SearchQueryState())\n  const [searchResultState, setSearchResultState] = useState<SearchResultState>(\n    new SearchResultState()\n  )\n  const value = {\n    tabsState,\n    setTabsState,\n    searchQueryState,\n    setSearchQueryState,\n    searchResultState,\n    setSearchResultState,\n  }\n  useEffect(() => {\n    ;(async () => {\n      if (await ready()) {\n        setTabsState(\n          tabsState\n            .setNames([TabName.search, TabName.stats, TabName.detail, TabName.engine, TabName.setup])\n            .setCurrent(TabName.search)\n        )\n      }\n    })()\n  }, [])\n  return <AdvancedContext.Provider value={value}>{children}</AdvancedContext.Provider>\n}\n","import { createContext, FC, useState } from 'react'\nimport { BoardState, ConfirmState } from '../../state'\n\nexport type BasicContext = {\n  boardState: BoardState\n  setBoardState: (s: BoardState) => void\n  confirmState?: ConfirmState\n  setConfirmState: (s?: ConfirmState) => void\n}\n\nexport const BasicContext = createContext<BasicContext>({\n  boardState: new BoardState(),\n  setBoardState: () => {},\n  confirmState: undefined,\n  setConfirmState: () => {},\n})\n\nexport const BasicContextProvider: FC = ({ children }) => {\n  const [boardState, setBoardStateState] = useState<BoardState>(\n    () => BoardState.decode(window.location.hash.slice(1)) || new BoardState()\n  )\n  const setBoardState = (s: BoardState) => {\n    setBoardStateState(s)\n    window.history.replaceState(null, '', `#${s.encode()}`)\n  }\n  const [confirmState, setConfirmState] = useState<ConfirmState>()\n  return (\n    <BasicContext.Provider\n      value={{\n        boardState,\n        setBoardState,\n        confirmState,\n        setConfirmState,\n      }}\n    >\n      {children}\n    </BasicContext.Provider>\n  )\n}\n","import { createContext, FC, useState } from 'react'\nimport { OptionsState } from '../../state'\n\nconst preferenceOptions = [\n  'showIndices',\n  'showOrders',\n  'emphasizeLastMove',\n  'showForbiddens',\n  'showPropertyRows',\n  'showPropertyEyes',\n  'advancedMode',\n  'colorBase',\n  'pathEveryOther',\n] as const\nexport type PreferenceOption = typeof preferenceOptions[number]\nexport const PreferenceOption: Record<PreferenceOption, PreferenceOption> = {\n  showIndices: 'showIndices',\n  showOrders: 'showOrders',\n  emphasizeLastMove: 'emphasizeLastMove',\n  showForbiddens: 'showForbiddens',\n  showPropertyRows: 'showPropertyRows',\n  showPropertyEyes: 'showPropertyEyes',\n  advancedMode: 'advancedMode',\n  colorBase: 'colorBase',\n  pathEveryOther: 'pathEveryOther',\n}\n\nexport type Preference = OptionsState<PreferenceOption>\n\nexport type PreferenceContext = {\n  preference: Preference\n  setPreference: (p: Preference) => void\n}\n\nexport const PreferenceContext = createContext<PreferenceContext>({\n  preference: new OptionsState<PreferenceOption>(),\n  setPreference: () => {},\n})\n\nexport const PreferenceContextProvider: FC = ({ children }) => {\n  const [preference, setPreferenceState] = useState<Preference>(\n    () => decode(localStorage.getItem('preference') || '{}') ?? new OptionsState<PreferenceOption>()\n  )\n  const setPreference = (p: Preference) => {\n    setPreferenceState(p)\n    localStorage.setItem('preference', encode(p))\n  }\n  return (\n    <PreferenceContext.Provider value={{ preference, setPreference }}>\n      {children}\n    </PreferenceContext.Provider>\n  )\n}\n\nconst encode = (p: Preference): string => {\n  return JSON.stringify(p.map)\n}\n\nconst decode = (code: string): Preference | undefined => {\n  try {\n    const init = JSON.parse(code) as Partial<Record<PreferenceOption, boolean>>\n    return new OptionsState<PreferenceOption>(init)\n  } catch (e) {\n    return undefined\n  }\n}\n","import { ButtonProps } from '@chakra-ui/react'\nimport { createContext, FC, useMemo } from 'react'\nimport { BOARD_SIZE, Point } from 'renjukit'\n\nexport type BoardWidth = 640 | 360 | 320\n\nexport type BoardCoordinate = [number, number]\n\nexport class System {\n  readonly W: BoardWidth\n  readonly C: number // cell size\n  readonly P: number // padding\n\n  constructor(windowInnerWidth: number) {\n    if (windowInnerWidth >= 640) {\n      this.W = 640\n      this.C = 40\n      this.P = 40\n    } else if (windowInnerWidth >= 360) {\n      this.W = 360\n      this.C = 24\n      this.P = 12\n    } else {\n      this.W = 320\n      this.C = 20\n      this.P = 20\n    }\n  }\n\n  cx(x: number): number {\n    return this.P + x * this.C\n  }\n\n  cy(y: number): number {\n    return this.P + (BOARD_SIZE - 1 - y) * this.C\n  }\n\n  c([x, y]: Point): BoardCoordinate {\n    return [this.cx(x), this.cy(y)]\n  }\n\n  p([bx, by]: [number, number]): Point {\n    return [adjust((bx - this.P) / this.C), adjust((this.W - by - this.P) / this.C)]\n  }\n\n  get indices(): number[] {\n    return new Array(BOARD_SIZE).fill(null).map((_, i) => i)\n  }\n\n  get buttonSize(): ButtonProps['size'] {\n    switch (this.W) {\n      case 320:\n        return 'sm'\n      case 360:\n        return 'sm'\n      case 640:\n        return 'lg'\n    }\n  }\n\n  get rulerStrokeWidth(): number {\n    switch (this.W) {\n      case 320:\n        return 1\n      case 360:\n        return 1\n      case 640:\n        return 2\n    }\n  }\n\n  get stoneStrokeWidth(): number {\n    switch (this.W) {\n      case 320:\n        return 1.5\n      case 360:\n        return 1.5\n      case 640:\n        return 2\n    }\n  }\n\n  get indexFontSize(): string {\n    switch (this.W) {\n      case 320:\n        return '8px'\n      case 360:\n        return '8px'\n      case 640:\n        return '16px'\n    }\n  }\n\n  get indexPadding(): number {\n    switch (this.W) {\n      case 320:\n        return 1\n      case 360:\n        return 1\n      case 640:\n        return 2\n    }\n  }\n\n  get orderFontSize(): string {\n    switch (this.W) {\n      case 320:\n        return '12px'\n      case 360:\n        return '12px'\n      case 640:\n        return '16px'\n    }\n  }\n\n  get markerFontSize(): string {\n    switch (this.W) {\n      case 320:\n        return '12px'\n      case 360:\n        return '12px'\n      case 640:\n        return '20px'\n    }\n  }\n\n  get propertyRowStrokeWidth(): number {\n    switch (this.W) {\n      case 320:\n        return 3\n      case 360:\n        return 3\n      case 640:\n        return 4\n    }\n  }\n\n  get propertyRowStrokeDasharray(): string {\n    switch (this.W) {\n      case 320:\n        return '1 4'\n      case 360:\n        return '1 4'\n      case 640:\n        return '3 5'\n    }\n  }\n}\n\nexport const SystemContext = createContext<System>(new System(640))\n\nexport const SystemContextProvider: FC = ({ children }) => {\n  const system = useMemo(() => new System(window.innerWidth), [])\n  return <SystemContext.Provider value={system}>{children}</SystemContext.Provider>\n}\n\nconst adjust = (n: number): number => Math.min(Math.max(0, Math.round(n)), BOARD_SIZE - 1)\n","import { Flex, Icon } from '@chakra-ui/react'\nimport { FC } from 'react'\nimport { RiCheckboxCircleFill, RiCloseLine, RiSubtractFill } from 'react-icons/ri'\n\nexport const WonIcon: FC<{ won: boolean | null }> = ({ won }) => {\n  switch (won) {\n    case true:\n      return (\n        <Flex justify=\"center\">\n          <Icon as={RiCheckboxCircleFill} boxSize=\"small\" color=\"green.500\" />\n        </Flex>\n      )\n    case false:\n      return (\n        <Flex justify=\"center\">\n          <Icon as={RiCloseLine} boxSize=\"small\" color=\"gray.500\" />\n        </Flex>\n      )\n    case null:\n      return (\n        <Flex justify=\"center\">\n          <Icon as={RiSubtractFill} boxSize=\"small\" color=\"gray.500\" />\n        </Flex>\n      )\n    default:\n      return <></>\n  }\n}\n","import {\n  Box,\n  Button,\n  Center,\n  Heading,\n  Link,\n  Stack,\n  Table,\n  Tbody,\n  Td,\n  Text,\n  Th,\n  Tr,\n  Wrap,\n  WrapItem,\n} from '@chakra-ui/react'\nimport { FC, useContext, useEffect, useMemo, useState } from 'react'\nimport { GameView, RIFCity, RIFCountry, RIFDatabase, RIFPlayer } from '../../../database'\nimport { TabName } from '../../../state'\nimport { AdvancedContext, BasicContext } from '../../contexts'\nimport { WonIcon } from '../common'\n\nconst Default: FC = () => {\n  const db = useMemo(() => new RIFDatabase(), [])\n  const [countriesMap, setCountriesMap] = useState<Map<RIFCountry['id'], RIFCountry>>(new Map())\n  const [citiesMap, setCitiesMap] = useState<Map<RIFCity['id'], RIFCity>>(new Map())\n  useEffect(() => {\n    ;(async () => {\n      setCountriesMap(await db.getCountriesMap())\n      setCitiesMap(await db.getCitiesMap())\n    })()\n  }, [])\n\n  const { boardState } = useContext(BasicContext)\n  const gid = boardState.game.gameid\n  const [gameView, setGameView] = useState<GameView>()\n  useEffect(() => {\n    if (gid === undefined) {\n      setGameView(undefined)\n      return\n    }\n    ;(async () => {\n      const result = await db.getGameViews([gid])\n      if (result.length > 0) setGameView(result[0])\n    })()\n  }, [gid])\n\n  if (gameView === undefined) {\n    return (\n      <Center>\n        <Text color=\"gray.600\" my=\"1rem\">\n          No game is selected\n        </Text>\n      </Center>\n    )\n  }\n  const { black, white, tournament, rule, publisher } = gameView\n  const url = `https://www.renju.net/media/games.php?gameid=${gameView.id}`\n  return (\n    <Stack fontFamily=\"Noto Serif\">\n      <Heading as=\"h2\" size=\"sm\">\n        Game\n      </Heading>\n      <Wrap pl=\"1rem\">\n        <WrapItem width=\"25%\" minWidth=\"120px\">\n          <Table size=\"rjn-info\" variant=\"rjn-info\">\n            <colgroup span={1} style={{ width: '25%' }} />\n            <colgroup span={1} style={{ width: '25%' }} />\n            <colgroup span={1} style={{ width: '50%' }} />\n            <Tbody>\n              <Tr>\n                <Th>Black</Th>\n                <Td>\n                  <WonIcon won={gameView.blackWon} />\n                </Td>\n                <Td isNumeric>{gameView.btime || '?'} min</Td>\n              </Tr>\n              <Tr>\n                <Th>White</Th>\n                <Td>\n                  <WonIcon won={gameView.whiteWon} />\n                </Td>\n                <Td isNumeric>{gameView.wtime || '?'} min</Td>\n              </Tr>\n            </Tbody>\n          </Table>\n        </WrapItem>\n        <WrapItem width=\"20%\" minWidth=\"120px\">\n          <Table size=\"rjn-info\" variant=\"rjn-info\">\n            <colgroup span={1} style={{ width: '25%' }} />\n            <colgroup span={1} style={{ width: '75%' }} />\n            <Tbody>\n              <Tr>\n                <Th>Rule</Th>\n                <Td isNumeric>{rule.name}</Td>\n              </Tr>\n              <Tr>\n                <Th>Swap</Th>\n                <Td isNumeric>{gameView.swap}</Td>\n              </Tr>\n            </Tbody>\n          </Table>\n        </WrapItem>\n        <WrapItem width=\"30%\" minWidth=\"240px\">\n          <Table size=\"rjn-info\" variant=\"rjn-info\">\n            <colgroup span={1} style={{ width: '15%' }} />\n            <colgroup span={1} style={{ width: '85%' }} />\n            <Tbody>\n              <Tr>\n                <Th>Alt</Th>\n                <Td isNumeric>{gameView.alt}</Td>\n              </Tr>\n              <Tr>\n                <Th>Info</Th>\n                <Td isNumeric>{gameView.info}</Td>\n              </Tr>\n            </Tbody>\n          </Table>\n        </WrapItem>\n      </Wrap>\n\n      <Heading as=\"h2\" size=\"sm\">\n        Black Player\n      </Heading>\n      <Box pl=\"1rem\">\n        <Player player={black} countriesMap={countriesMap} />\n      </Box>\n\n      <Heading as=\"h2\" size=\"sm\">\n        White Player\n      </Heading>\n      <Box pl=\"1rem\">\n        <Player player={white} countriesMap={countriesMap} />\n      </Box>\n\n      <Heading as=\"h2\" size=\"sm\">\n        Tournament\n      </Heading>\n      <Box pl=\"1rem\">\n        <Text>\n          {!tournament.rated && '(Unrated)'} {`${tournament.name.trim()}`}\n          <br />\n          {`${tournament.start} - ${tournament.end}`}\n          &emsp;\n          {citiesMap.get(tournament.city)?.name}, {countriesMap.get(tournament.country)?.name}\n          <br />\n          Round {gameView.round}\n        </Text>\n      </Box>\n\n      <Heading as=\"h2\" size=\"sm\">\n        Publisher\n      </Heading>\n      <Box pl=\"1rem\">\n        <Player player={publisher} countriesMap={countriesMap} />\n      </Box>\n\n      <Heading as=\"h2\" size=\"sm\">\n        Generated Link\n      </Heading>\n      <Box pl=\"1rem\">\n        <Link href={url} isExternal color=\"teal.500\" fontFamily=\"Roboto\">\n          {url}\n        </Link>\n      </Box>\n    </Stack>\n  )\n}\n\nconst Player: FC<{ player: RIFPlayer; countriesMap: Map<number, RIFCountry> }> = ({\n  player,\n  countriesMap,\n}) => {\n  const { searchQueryState, setSearchQueryState, tabsState, setTabsState } =\n    useContext(AdvancedContext)\n  const onClick = () => {\n    setSearchQueryState(searchQueryState.setPlayerId(player.id))\n    setTabsState(tabsState.setCurrent(TabName.search))\n  }\n  return (\n    <Text>\n      <Button\n        variant=\"link\"\n        onClick={onClick}\n      >{`${player.name.trim()} ${player.surname.trim()}`}</Button>\n      <br />\n      {countriesMap.get(player.country)?.name}\n    </Text>\n  )\n}\n\nexport default Default\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/gomocup.worker.40696c30.worker.js\");\n}\n","import React, { useState, useContext, useCallback, useEffect, useRef } from 'react';\nimport {\n  Box,\n  Button,\n  VStack,\n  HStack,\n  Text,\n  Table,\n  Thead,\n  Tbody,\n  Tr,\n  Th,\n  Td,\n  Switch,\n  Alert,\n  AlertIcon,\n} from '@chakra-ui/react';\nimport { Point } from 'renjukit';\nimport { BasicContext } from '../../contexts';\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport GomocupWorker from 'worker-loader!../../../workers/gomocup.worker.ts';\n\n// WebAssembly \ninterface EngineMove {\n  x: number;\n  y: number;\n  score: number;\n}\n\ninterface EngineResult {\n  bestMove?: EngineMove;\n  depth: number;\n  nodes: number;\n  eval: number;\n  pv: EngineMove[];\n  candidates: EngineMove[];\n}\n\n// WASM is loaded inside WebWorker; no direct loading here.\n\nexport const EngineTab: React.FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [result, setResult] = useState<EngineResult | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  // const [progress, setProgress] = useState(0);\n  const [autoAnalyze, setAutoAnalyze] = useState(true);\n  const lastKeyRef = useRef<string>('');\n  const mountedRef = useRef<boolean>(true);\n  const lastEvalRef = useRef<number>(0);\n  // const progressTimerRef = useRef<number | null>(null);\n  const workerRef = useRef<Worker | null>(null);\n  const workerReadyRef = useRef<boolean>(false);\n\n  //  WebAssembly \n  const convertBoardToWasm = useCallback(() => {\n    const blacks: number[] = [];\n    const whites: number[] = [];\n\n    boardState.game.blacks.forEach(point => {\n      blacks.push(point[0] * 15 + point[1]);\n    });\n\n    boardState.game.whites.forEach(point => {\n      whites.push(point[0] * 15 + point[1]);\n    });\n\n    return { blacks: new Uint8Array(blacks), whites: new Uint8Array(whites) };\n  }, [boardState]);\n\n  // \n  const startAnalysis = useCallback(async () => {\n    try {\n      if (!mountedRef.current) return;\n      setIsAnalyzing(true);\n      setError(null);\n      // reset progress\n\n      const moves = boardState.game.current.moves;\n      const inverted = boardState.game.current.inverted;\n\n      // \n\n      if (!workerRef.current) {\n        const w: Worker = new (GomocupWorker as any)();\n        workerRef.current = w;\n        workerReadyRef.current = false;\n        w.onmessage = (ev: MessageEvent) => {\n          const msg: any = ev.data;\n          if (msg.type === 'ready') {\n            workerReadyRef.current = true;\n          } else if (msg.type === 'log') {\n            const text: string = msg.text || '';\n            if (text.startsWith('MESSAGE')) {\n              const mDepth = /depth=(\\d+)/.exec(text);\n              const mNodes = /nodes=(\\d+)/.exec(text);\n              const mVal = /val=(-?\\d+)/.exec(text);\n              if (mVal) lastEvalRef.current = parseInt(mVal[1], 10);\n              const pvMatches = Array.from(text.matchAll(/\\[(\\d+),(\\d+)\\]/g));\n              const pv: EngineMove[] = pvMatches.map((m) => ({ x: parseInt(m[1], 10), y: parseInt(m[2], 10), score: 0 }));\n              const bestFromPv = pv.length > 0 ? { x: pv[0].x, y: pv[0].y, score: mVal ? parseInt(mVal[1], 10) : 0 } : undefined;\n              setResult(prev => ({\n                bestMove: bestFromPv || prev?.bestMove,\n                depth: mDepth ? parseInt(mDepth[1], 10) : prev?.depth || 0,\n                nodes: mNodes ? parseInt(mNodes[1], 10) : prev?.nodes || 0,\n                eval: mVal ? parseInt(mVal[1], 10) : prev?.eval || 0,\n                pv,\n                candidates: prev?.candidates || [],\n              }));\n            } else if (text.startsWith('CANDS')) {\n              const candMatches = Array.from(text.matchAll(/\\[(\\d+),(\\d+),(-?\\d+)\\]/g));\n              const candidates: EngineMove[] = candMatches.map((m) => ({\n                x: parseInt(m[1], 10),\n                y: parseInt(m[2], 10),\n                score: parseInt(m[3], 10),\n              }));\n              setResult(prev => ({\n                bestMove: prev?.bestMove,\n                depth: prev?.depth || 0,\n                nodes: prev?.nodes || 0,\n                eval: prev?.eval || 0,\n                pv: prev?.pv || [],\n                candidates,\n              }));\n            }\n          } else if (msg.type === 'result') {\n            const resp: string = msg.response;\n            if (resp && resp.includes(',')) {\n              const [sx, sy] = resp.split(',');\n              const x = parseInt(sx, 10);\n              const y = parseInt(sy, 10);\n              const engineResult: EngineResult = {\n                bestMove: { x, y, score: lastEvalRef.current },\n                depth: 0,\n                nodes: 0,\n                eval: lastEvalRef.current,\n                pv: [],\n                candidates: [],\n              };\n              setResult(engineResult);\n            }\n            setIsAnalyzing(false);\n          } else if (msg.type === 'error') {\n            setError(String(msg.message || ''));\n          }\n        };\n        w.postMessage({ type: 'init' });\n      }\n      if (moves.length === 0) {\n        workerRef.current?.postMessage({ type: 'command', payload: 'BEGIN' });\n      } else {\n        const lines = moves.map((p, i) => {\n          const black = inverted ? i % 2 === 1 : i % 2 === 0;\n          const c = black ? 1 : 2;\n          return `${p[0]},${p[1]},${c}`;\n        });\n        const payload = `BOARD\\n${lines.join('\\n')}\\nDONE`;\n        workerRef.current?.postMessage({ type: 'command', payload });\n      }\n\n    } catch (err) {\n      if (mountedRef.current) setError(`: ${err instanceof Error ? err.message : String(err)}`);\n    } finally {\n      // isAnalyzing  worker  result \n    }\n  }, [boardState, convertBoardToWasm]);\n\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n      if (workerRef.current) {\n        workerRef.current.terminate();\n        workerRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!autoAnalyze) return;\n    const moves = boardState.game.current.moves;\n    const inv = boardState.game.current.inverted;\n    const key = JSON.stringify(moves) + `:${inv}`;\n    if (key !== lastKeyRef.current && !isAnalyzing) {\n      lastKeyRef.current = key;\n      // \n      if (workerRef.current) {\n        workerRef.current.postMessage({ type: 'stop' });\n      }\n      startAnalysis();\n    }\n  }, [boardState, autoAnalyze, isAnalyzing, startAnalysis]);\n\n  // \n  // const stopAnalysis = useCallback(() => {\n  //   setIsAnalyzing(false);\n  //   setProgress(0);\n  //   if (workerRef.current) {\n  //     workerRef.current.terminate();\n  //     workerRef.current = null;\n  //     workerReadyRef.current = false;\n  //   }\n  // }, []);\n\n  // \n  const applyMove = useCallback((move: EngineMove) => {\n    const point: Point = [move.x, move.y];\n    setBoardState(boardState.edit(point));\n  }, [boardState, setBoardState]);\n\n  // \n  useEffect(() => {\n    if (!result || !result.bestMove) return;\n    const m = result.bestMove;\n    const evals = [{ x: m.x, y: m.y, score: m.score }];\n    setBoardState(boardState.setEvals(evals));\n    return () => {\n      setBoardState(boardState.setEvals([]));\n    };\n  }, [result?.bestMove]);\n\n  // \n  const formatScore = (score: number) => {\n    if (Math.abs(score) >= 50000) {\n      return score > 0 ? '+' : '-';\n    }\n    return score > 0 ? `+${score}` : `${score}`;\n  };\n\n  // \n  // const formatTime = (ms: number) => {\n  //   if (ms < 1000) return `${ms}ms`;\n  //   return `${(ms / 1000).toFixed(1)}s`;\n  // };\n\n  // \n  const formatNodes = (nodes: number) => {\n    if (nodes >= 1000000) return `${(nodes / 1000000).toFixed(1)}M`;\n    if (nodes >= 1000) return `${(nodes / 1000).toFixed(1)}K`;\n    return nodes.toString();\n  };\n\n  return (\n    <VStack spacing={4} align=\"stretch\">\n      {/*  */}\n      <Box p={4} borderWidth={1} borderRadius=\"md\">\n        <VStack spacing={3} align=\"stretch\">\n          <Text fontSize=\"lg\" fontWeight=\"bold\"></Text>\n          \n          <HStack spacing={4}>\n            <Box>\n              <Text fontSize=\"sm\" mb={1}></Text>\n              <Switch isChecked={autoAnalyze} onChange={e => setAutoAnalyze(e.target.checked)} size=\"md\" />\n            </Box>\n          </HStack>\n        </VStack>\n      </Box>\n\n      {/*  */}\n      {error && (\n        <Alert status=\"error\">\n          <AlertIcon />\n          {error}\n        </Alert>\n      )}\n\n      {/*  */}\n      {result && (\n        <Box p={4} borderWidth={1} borderRadius=\"md\">\n          <VStack spacing={3} align=\"stretch\">\n            <Text fontSize=\"lg\" fontWeight=\"bold\"></Text>\n            \n            {/*  */}\n            <HStack spacing={6}>\n              <Text fontSize=\"sm\">\n                <strong>:</strong> {result.depth}\n              </Text>\n              <Text fontSize=\"sm\">\n                <strong>:</strong> {formatNodes(result.nodes)}\n              </Text>\n              <Text fontSize=\"sm\">\n                <strong>:</strong> {result.eval}\n              </Text>\n            </HStack>\n\n            {/*  */}\n            {result.bestMove && (\n              <Box p={3} bg=\"blue.50\" borderRadius=\"md\">\n                <HStack justify=\"space-between\">\n                  <VStack align=\"start\" spacing={1}>\n                    <Text fontSize=\"sm\" fontWeight=\"bold\"></Text>\n                    <Text fontSize=\"lg\">\n                      {String.fromCharCode(65 + result.bestMove.x)}{result.bestMove.y + 1}\n                    </Text>\n                    <Text fontSize=\"sm\" color=\"gray.600\">\n                      : {formatScore(result.bestMove.score)}\n                    </Text>\n                  </VStack>\n                  <Button\n                    colorScheme=\"blue\"\n                    size=\"sm\"\n                    onClick={() => applyMove(result.bestMove!)}\n                  >\n                    \n                  </Button>\n                </HStack>\n              </Box>\n            )}\n\n            {/*  PV  */}\n            {result.pv.length > 0 && (\n              <Box>\n                <Text fontSize=\"md\" fontWeight=\"bold\" mb={2}></Text>\n                <Text fontSize=\"sm\" color=\"gray.700\">\n                  {result.pv.map((m, i) => (\n                    `${String.fromCharCode(65 + m.x)}${m.y + 1}${i < result.pv.length - 1 ? ' ' : ''}`\n                  )).join('')}\n                </Text>\n              </Box>\n            )}\n\n            {/*  */}\n            {result.candidates.length > 0 && (\n              <Box>\n                <Text fontSize=\"md\" fontWeight=\"bold\" mb={2}></Text>\n                <Table size=\"sm\" variant=\"simple\">\n                  <Thead>\n                    <Tr>\n                      <Th></Th>\n                      <Th></Th>\n                      <Th></Th>\n                      <Th></Th>\n                    </Tr>\n                  </Thead>\n                  <Tbody>\n                    {result.candidates.slice(0, 10).map((move, index) => (\n                      <Tr key={index}>\n                        <Td>{index + 1}</Td>\n                        <Td>{String.fromCharCode(65 + move.x)}{move.y + 1}</Td>\n                        <Td>{formatScore(move.score)}</Td>\n                        <Td>\n                          <Button\n                            size=\"xs\"\n                            colorScheme=\"blue\"\n                            variant=\"outline\"\n                            onClick={() => applyMove(move)}\n                          >\n                            \n                          </Button>\n                        </Td>\n                      </Tr>\n                    ))}\n                  </Tbody>\n                </Table>\n              </Box>\n            )}\n          </VStack>\n        </Box>\n      )}\n    </VStack>\n  );\n};\n","import {\n  Checkbox,\n  CloseButton,\n  Input,\n  InputGroup,\n  InputLeftAddon,\n  InputRightElement,\n  Popover,\n  PopoverArrow,\n  PopoverBody,\n  PopoverContent,\n  PopoverTrigger,\n  SimpleGrid,\n  Table,\n  Tbody,\n  Td,\n  Tr,\n  useDisclosure,\n} from '@chakra-ui/react'\nimport { FC, useContext, useEffect, useMemo, useRef, useState } from 'react'\nimport { RiRadioButtonLine, RiUser3Fill } from 'react-icons/ri'\nimport { RIFDatabase, RIFPlayer } from '../../../database'\nimport { Game } from '../../../rule'\nimport { AdvancedContext } from '../../contexts'\n\nconst Default: FC = () => {\n  return (\n    <SimpleGrid width=\"100%\" columns={2} spacing={1} minChildWidth=\"240px\">\n      <MovesInput />\n      <PlayerInput />\n    </SimpleGrid>\n  )\n}\n\nconst MovesInput: FC = () => {\n  const { searchQueryState, setSearchQueryState } = useContext(AdvancedContext)\n  const encodedMoves = new Game({ moves: searchQueryState.moves }).encode(',')\n  return (\n    <InputGroup size=\"sm\">\n      <InputLeftAddon>\n        <RiRadioButtonLine />\n      </InputLeftAddon>\n      <Input type=\"string\" placeholder=\"put moves on board\" isReadOnly value={encodedMoves} />\n      <InputRightElement>\n        <Checkbox\n          isChecked={searchQueryState.useMoves}\n          onChange={e => setSearchQueryState(searchQueryState.setUseMoves(e.target.checked))}\n        />\n      </InputRightElement>\n    </InputGroup>\n  )\n}\n\nconst PlayerInput: FC = () => {\n  const { searchQueryState, setSearchQueryState } = useContext(AdvancedContext)\n  const rifDB = useMemo(() => new RIFDatabase(), [])\n\n  const [value, setValue] = useState<string>('')\n  const [players, setPlayers] = useState<RIFPlayer[]>([])\n  const popoverDisclosure = useDisclosure()\n  const onChange = (value: string) => {\n    setValue(value)\n    ;(async () => {\n      const keywords = value.trim().split(/\\s+/)\n      setPlayers(await rifDB.searchPlayers(keywords))\n    })()\n  }\n  const onSetPlayer = (player: RIFPlayer) => {\n    setSearchQueryState(searchQueryState.setPlayerId(player.id))\n    popoverDisclosure.onClose()\n  }\n  const onUnsetPlayer = () => {\n    setSearchQueryState(searchQueryState.setPlayerId(undefined))\n    setValue('')\n    popoverDisclosure.onClose()\n  }\n\n  const playerId = searchQueryState.playerId\n  useEffect(() => {\n    if (typeof playerId !== 'number') return\n    ;(async () => {\n      const player = await rifDB.getPlayer(playerId)\n      const playerName = player ? `${player.name.trim()} ${player.surname.trim()}` : ''\n      setValue(playerName)\n    })()\n  }, [playerId])\n\n  const playerInputRef = useRef(null)\n  return (\n    <Popover initialFocusRef={playerInputRef} isOpen={popoverDisclosure.isOpen}>\n      <PopoverTrigger>\n        <InputGroup size=\"sm\">\n          <InputLeftAddon>\n            <RiUser3Fill />\n          </InputLeftAddon>\n          <Input\n            ref={playerInputRef}\n            type=\"string\"\n            placeholder=\"select player\"\n            value={value}\n            onClick={popoverDisclosure.onOpen}\n            onChange={e => onChange(e.target.value)}\n          />\n          <InputRightElement>\n            <CloseButton\n              size=\"sm\"\n              onClick={onUnsetPlayer}\n              disabled={searchQueryState.playerId === undefined && !popoverDisclosure.isOpen}\n            />\n          </InputRightElement>\n        </InputGroup>\n      </PopoverTrigger>\n      <PopoverContent>\n        <PopoverArrow />\n        <PopoverBody>\n          <Table variant=\"unstyled\" size=\"sm\">\n            <Tbody>\n              {players.map((p, i) => (\n                <Tr key={i} onClick={() => onSetPlayer(p)} _hover={{ bg: 'gray.100' }}>\n                  <Td>{`${p.name.trim()} ${p.surname.trim()}`}</Td>\n                </Tr>\n              ))}\n            </Tbody>\n          </Table>\n        </PopoverBody>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default Default\n","import {\n  Button,\n  ButtonGroup,\n  Center,\n  IconButton,\n  Table,\n  Tbody,\n  Td,\n  Th,\n  Thead,\n  Tr,\n} from '@chakra-ui/react'\nimport { FC, useContext, useEffect, useMemo, useState } from 'react'\nimport { FiChevronLeft, FiChevronRight, FiChevronsLeft, FiChevronsRight } from 'react-icons/fi'\nimport { GameView, playerShortName, RIFDatabase, ruleShortName } from '../../../database'\nimport { Game } from '../../../rule'\nimport {\n  BoardMode,\n  BoardState,\n  ConfirmOption,\n  ConfirmState,\n  GameState,\n  PagerState,\n} from '../../../state'\nimport { AdvancedContext, BasicContext } from '../../contexts'\nimport { WonIcon } from '../common'\n\nconst Default: FC = () => {\n  const { searchResultState } = useContext(AdvancedContext)\n  const [pager, setPager] = useState<PagerState>(new PagerState())\n  useEffect(() => {\n    setPager(new PagerState({ hit: searchResultState.gameIds.length }))\n  }, [searchResultState.gameIds])\n  const gameIds = searchResultState.gameIds.slice(pager.pageStart, pager.pageEnd)\n  return (\n    <>\n      <PagerController pager={pager} setPager={setPager} />\n      <GamesTable gameIds={gameIds} />\n    </>\n  )\n}\n\nconst PagerController: FC<{ pager: PagerState; setPager: (p: PagerState) => void }> = ({\n  pager,\n  setPager,\n}) => {\n  return (\n    <Center>\n      <ButtonGroup spacing={1} size=\"sm\" variant=\"ghost\">\n        <IconButton\n          aria-label=\"first\"\n          icon={<FiChevronsLeft />}\n          isDisabled={pager.isFirst}\n          onClick={() => setPager(pager.toFirst())}\n        />\n        <IconButton\n          aria-label=\"prev\"\n          icon={<FiChevronLeft />}\n          isDisabled={pager.isFirst}\n          onClick={() => setPager(pager.prev())}\n        />\n        <Button isDisabled width=\"8rem\">\n          {pager.toString()}\n        </Button>\n        <IconButton\n          aria-label=\"next\"\n          icon={<FiChevronRight />}\n          isDisabled={pager.isLast}\n          onClick={() => setPager(pager.next())}\n        />\n        <IconButton\n          aria-label=\"last\"\n          icon={<FiChevronsRight />}\n          isDisabled={pager.isLast}\n          onClick={() => setPager(pager.toLast())}\n        />\n      </ButtonGroup>\n    </Center>\n  )\n}\n\nconst GamesTable: FC<{ gameIds: number[] }> = ({ gameIds }) => {\n  const db = useMemo(() => new RIFDatabase(), [])\n  const [games, setGames] = useState<GameView[]>([])\n  useEffect(() => {\n    ;(async () => setGames(await db.getGameViews(gameIds)))()\n  }, [gameIds])\n  const { boardState, setBoardState, setConfirmState } = useContext(BasicContext)\n  const isPreviewMode = boardState.mode === BoardMode.preview\n  const [hiddenGame, setHiddenGame] = useState<GameState>()\n  const onClick = (g: GameView) => {\n    const originalGame = hiddenGame ?? boardState.game\n    const previewGame = new GameState({\n      main: new Game({ moves: g.moves }),\n      gameid: g.id,\n      cursor: boardState.game.current.size,\n    })\n    if (!isPreviewMode) {\n      setHiddenGame(boardState.game)\n    }\n    setBoardState(boardState.setGame(previewGame).setMode(BoardMode.preview))\n\n    const onOpen = () => {\n      setBoardState(new BoardState({ game: previewGame }))\n      setHiddenGame(undefined)\n      setConfirmState(undefined)\n    }\n    const onCancel = () => {\n      setBoardState(boardState.setGame(originalGame).setMode(BoardMode.game))\n      setHiddenGame(undefined)\n      setConfirmState(undefined)\n    }\n    const confirmState = new ConfirmState({\n      ok: new ConfirmOption({ text: 'Open', colorScheme: 'blue', onClick: onOpen }),\n      cancel: new ConfirmOption({ text: 'Cancel', onClick: onCancel }),\n    })\n    setConfirmState(confirmState)\n  }\n  return (\n    <Table width=\"100%\" size=\"rjn-info\" variant=\"rjn-info\">\n      <Thead>\n        <Tr>\n          <Th>Date</Th>\n          <Th>Black</Th>\n          <Th colSpan={3}>Result</Th>\n          <Th>White</Th>\n          <Th>Rule</Th>\n          <Th>Op.</Th>\n        </Tr>\n      </Thead>\n      <colgroup span={1} style={{ width: '20%' }} />\n      <colgroup span={1} style={{ width: '25%' }} />\n      <colgroup span={1} style={{ width: '2.5%' }} />\n      <colgroup span={1} style={{ width: '5%' }} />\n      <colgroup span={1} style={{ width: '2.5%' }} />\n      <colgroup span={1} style={{ width: '25%' }} />\n      <colgroup span={1} style={{ width: '10%' }} />\n      <colgroup span={1} style={{ width: '10%' }} />\n      <Tbody>\n        {games.map((g, key) => {\n          const mgid = isPreviewMode ? hiddenGame?.gameid : boardState.game.gameid\n          const pgid = isPreviewMode ? boardState.game.gameid : undefined\n          return (\n            <Tr\n              key={key}\n              onClick={() => onClick(g)}\n              bg={g.id === mgid ? 'green.100' : g.id === pgid ? 'purple.100' : undefined}\n              _hover={{ bg: 'gray.100' }}\n            >\n              <Td isNumeric>{g.tournament.start}</Td>\n              <Td>{playerShortName(g.black)}</Td>\n              <Td>\n                <WonIcon won={g.blackWon} />\n              </Td>\n              <Td>{g.moves.length.toString()}</Td>\n              <Td>\n                <WonIcon won={g.whiteWon} />\n              </Td>\n              <Td>{playerShortName(g.white)}</Td>\n              <Td isNumeric>{ruleShortName(g.rule.name)}</Td>\n              <Td isNumeric>{g.opening.abbr.toUpperCase()}</Td>\n            </Tr>\n          )\n        })}\n      </Tbody>\n    </Table>\n  )\n}\n\nexport default Default\n","import { Stack, Text } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport { AdvancedContext } from '../../contexts'\nimport SearchController from '../common/SearchController'\nimport GamesSelector from './Selector'\n\nconst Default: FC = () => {\n  const { searchResultState } = useContext(AdvancedContext)\n  return (\n    <Stack width=\"100%\" align=\"center\">\n      <SearchController />\n      {searchResultState.error && (\n        <Text color=\"gray.600\" py=\"1rem\">\n          {searchResultState.error}\n        </Text>\n      )}\n      {searchResultState.gameIds.length > 0 && <GamesSelector />}\n    </Stack>\n  )\n}\n\nexport default Default\n","import {\n  Box,\n  Button,\n  Heading,\n  Input,\n  InputGroup,\n  InputLeftAddon,\n  Link,\n  ListItem,\n  Modal,\n  ModalBody,\n  ModalContent,\n  ModalFooter,\n  ModalHeader,\n  ModalOverlay,\n  Progress,\n  Stack,\n  UnorderedList,\n  useDisclosure,\n} from '@chakra-ui/react'\nimport { FC, useState } from 'react'\nimport { RiFileLine } from 'react-icons/ri'\nimport { AnalyzedDatabase, RIFDatabase } from '../../../database'\n\nconst Default: FC = () => {\n  const [fileIsInvalid, setFileIsInvalid] = useState<boolean>(false)\n  const [parsingProgress, setParsingProgress] = useState<number>(0)\n  const [analyzingProgress, setAnalyzingProgress] = useState<number>(0)\n  const [completed, setCompleted] = useState<boolean>(false)\n  const analyzingDisclosure = useDisclosure()\n\n  const onLoadFile = async () => {\n    const elem = document.getElementById('rif-file') as HTMLInputElement\n    const files = elem?.files\n    if (files === null || files.length === 0) {\n      setFileIsInvalid(true)\n      return\n    }\n    analyzingDisclosure.onOpen()\n\n    RIFDatabase.reset()\n    const rifDB = new RIFDatabase()\n    await rifDB.loadFromFile(files[0], p => setParsingProgress(p))\n\n    AnalyzedDatabase.reset()\n    const analyzedDB = new AnalyzedDatabase()\n    await analyzedDB.loadFromRIFDatabase(p => setAnalyzingProgress(p))\n\n    setCompleted(true)\n  }\n  return (\n    <>\n      <Stack>\n        <Heading as=\"h2\" size=\"sm\">\n          Load RIF database\n        </Heading>\n        <Stack isInline>\n          <InputGroup size=\"sm\">\n            <InputLeftAddon width=\"5rem\">\n              <RiFileLine /> &nbsp; .rif\n            </InputLeftAddon>\n            <Input\n              id=\"rif-file\"\n              type=\"file\"\n              isInvalid={fileIsInvalid}\n              onChange={() => setFileIsInvalid(false)}\n            />\n          </InputGroup>\n          <Button size=\"sm\" colorScheme=\"blue\" onClick={onLoadFile}>\n            Load\n          </Button>\n        </Stack>\n        <Heading as=\"h3\" size=\"sm\">\n          Remarks\n        </Heading>\n        <Box>\n          <UnorderedList>\n            <ListItem>\n              The data loaded from file will be stored only in your browser&apos;s storage and{' '}\n              <b>never</b> uploaded to anywhere. Keep in mind that, once the storage was resetted by\n              an action like deleting histories, your data will be also deleted as well.\n            </ListItem>\n            <ListItem>\n              RIF&apos;s official dataset can be downloaded from{' '}\n              <Link href=\"//www.renju.net/game/\" color=\"teal.500\" isExternal>\n                RenjuNet (XML format)\n              </Link>\n              . Be sure to follow rules presented on the site.\n            </ListItem>\n          </UnorderedList>\n        </Box>\n      </Stack>\n      <Modal\n        isOpen={analyzingDisclosure.isOpen}\n        onClose={analyzingDisclosure.onClose}\n        isCentered\n        closeOnOverlayClick={false}\n      >\n        <ModalOverlay />\n        <ModalContent>\n          <ModalHeader as=\"h1\">{completed ? 'Completed!' : 'Loading...'}</ModalHeader>\n          <ModalBody>\n            <Stack spacing=\"1rem\">\n              <Heading as=\"h2\" size=\"sm\" mb=\"1rem\">\n                Parsing content...\n              </Heading>\n              <Progress value={parsingProgress} />\n              <Heading as=\"h2\" size=\"sm\" mb=\"1rem\">\n                Analyzing games...\n              </Heading>\n              <Progress value={analyzingProgress} />\n            </Stack>\n          </ModalBody>\n          <ModalFooter>\n            <Button onClick={() => window.location.reload()} isDisabled={!completed}>\n              Reload App\n            </Button>\n          </ModalFooter>\n        </ModalContent>\n      </Modal>\n    </>\n  )\n}\n\nexport default Default\n","import {\n  Center,\n  Divider,\n  Flex,\n  SimpleGrid,\n  Stack,\n  Stat,\n  StatHelpText,\n  StatLabel,\n  StatNumber,\n  Table,\n  Tbody,\n  Td,\n  Th,\n  Thead,\n  Tr,\n} from '@chakra-ui/react'\nimport { FC, useContext, useEffect, useMemo, useState } from 'react'\nimport { Point, wrapPoint } from 'renjukit'\nimport { calcStat, calcStatByNextMove, GamesStat } from '../../../analysis'\nimport { GameView, RIFDatabase } from '../../../database'\nimport { BoardMode } from '../../../state'\nimport { AdvancedContext, BasicContext } from '../../contexts'\n\nconst Default: FC = () => {\n  const db = useMemo(() => new RIFDatabase(), [])\n  const { searchQueryState, searchResultState } = useContext(AdvancedContext)\n  const [games, setGames] = useState<GameView[]>([])\n  useEffect(() => {\n    ;(async () => setGames(await db.getGameViews(searchResultState.gameIds)))()\n  }, [searchResultState.gameIds])\n  const { moves, playerId } = searchQueryState.query\n  if (moves !== undefined && playerId !== undefined) {\n    return <StatsWithMovesAndPlayer games={games} moves={moves} playerId={playerId} />\n  } else if (moves !== undefined && playerId === undefined) {\n    return <StatsWithMoves games={games} moves={moves} />\n  } else if (moves === undefined && playerId !== undefined) {\n    return <StatsWithPlayer games={games} playerId={playerId} />\n  } else {\n    return <></>\n  }\n}\n\nconst StatsWithMovesAndPlayer: FC<{ games: GameView[]; moves: Point[]; playerId: number }> = ({\n  games,\n  moves,\n  playerId,\n}) => {\n  const blackGames = games.filter(g => g.black.id === playerId)\n  const whiteGames = games.filter(g => g.white.id === playerId)\n  const blackStat = calcStat(blackGames)\n  const whiteStat = calcStat(whiteGames)\n  const blackStats = calcStatByNextMove(blackGames, moves).slice(0, 5)\n  const whiteStats = calcStatByNextMove(whiteGames, moves).slice(0, 5)\n  const denominator = Math.max(\n    ...blackStats.map(([_, s]) => Math.max(s.blackWon, s.whiteWon, s.draw)),\n    ...whiteStats.map(([_, s]) => Math.max(s.blackWon, s.whiteWon, s.draw))\n  )\n  return (\n    <Stack width=\"100%\" spacing=\"1rem\" my=\"1rem\">\n      <StatComponent\n        total={{ label: 'Play black', count: blackStat.all }}\n        won={{ label: 'Won', count: blackStat.blackWon, color: 'blue.700' }}\n        lost={{ label: 'Lost', count: blackStat.whiteWon, color: 'green.700' }}\n        draw={{ label: 'Draw', count: blackStat.draw, color: 'gray.700' }}\n      />\n      <StatByNextMoveTable stats={blackStats} denominator={denominator} />\n      <Divider />\n      <StatComponent\n        total={{ label: 'Play white', count: whiteStat.all }}\n        won={{ label: 'Won', count: whiteStat.whiteWon, color: 'green.700' }}\n        lost={{ label: 'Lost', count: whiteStat.blackWon, color: 'blue.700' }}\n        draw={{ label: 'Draw', count: whiteStat.draw, color: 'gray.700' }}\n      />\n      <StatByNextMoveTable stats={whiteStats} denominator={denominator} isBlackRight />\n    </Stack>\n  )\n}\n\nconst StatsWithMoves: FC<{ games: GameView[]; moves: Point[] }> = ({ games, moves }) => {\n  const stat = calcStat(games)\n  const stats = calcStatByNextMove(games, moves).slice(0, 10)\n  const denominator = Math.max(...stats.map(([_, s]) => Math.max(s.blackWon, s.whiteWon, s.draw)))\n  return (\n    <Stack width=\"100%\" spacing=\"1rem\" my=\"1rem\">\n      <StatComponent\n        total={{ label: 'All', count: stat.all }}\n        won={{ label: 'Black won', count: stat.blackWon, color: 'blue.700' }}\n        lost={{ label: 'White won', count: stat.whiteWon, color: 'green.700' }}\n        draw={{ label: 'Draw', count: stat.draw, color: 'gray.700' }}\n      />\n      <StatByNextMoveTable stats={stats} denominator={denominator} />\n    </Stack>\n  )\n}\n\nconst StatsWithPlayer: FC<{ games: GameView[]; playerId: number }> = ({ games, playerId }) => {\n  const blackGames = games.filter(g => g.black.id === playerId)\n  const whiteGames = games.filter(g => g.white.id === playerId)\n  const blackStat = calcStat(blackGames)\n  const whiteStat = calcStat(whiteGames)\n  return (\n    <Stack width=\"100%\" spacing=\"1rem\" my=\"1rem\">\n      <StatComponent\n        total={{ label: 'Play black', count: blackStat.all }}\n        won={{ label: 'Won', count: blackStat.blackWon, color: 'blue.700' }}\n        lost={{ label: 'Lost', count: blackStat.whiteWon, color: 'green.700' }}\n        draw={{ label: 'Draw', count: blackStat.draw, color: 'gray.700' }}\n      />\n      <Divider />\n      <StatComponent\n        total={{ label: 'Play white', count: whiteStat.all }}\n        won={{ label: 'Won', count: whiteStat.whiteWon, color: 'green.700' }}\n        lost={{ label: 'Lost', count: whiteStat.blackWon, color: 'blue.700' }}\n        draw={{ label: 'Draw', count: whiteStat.draw, color: 'gray.700' }}\n      />\n    </Stack>\n  )\n}\n\ntype StatItemProps = {\n  count: number\n  label: string\n  color?: string\n}\n\ntype StatProps = {\n  total: StatItemProps\n  won: StatItemProps\n  lost: StatItemProps\n  draw: StatItemProps\n}\n\nconst StatComponent: FC<StatProps> = ({ total, won, lost, draw }) => {\n  return (\n    <SimpleGrid columns={4} width=\"100%\" textAlign=\"center\">\n      <Stat textColor={total.color}>\n        <StatLabel>{total.label}</StatLabel>\n        <StatNumber>{total.count}</StatNumber>\n      </Stat>\n      <Stat textColor={won.color}>\n        <StatLabel>{won.label}</StatLabel>\n        <StatNumber>{won.count}</StatNumber>\n        <StatHelpText>{((100 * won.count) / total.count).toFixed(1)}%</StatHelpText>\n      </Stat>\n      <Stat textColor={lost.color}>\n        <StatLabel>{lost.label}</StatLabel>\n        <StatNumber>{lost.count}</StatNumber>\n        <StatHelpText>{((100 * lost.count) / total.count).toFixed(1)}%</StatHelpText>\n      </Stat>\n      <Stat textColor={draw.color}>\n        <StatLabel>{draw.label}</StatLabel>\n        <StatNumber>{draw.count}</StatNumber>\n        <StatHelpText>{((100 * draw.count) / total.count).toFixed(1)}%</StatHelpText>\n      </Stat>\n    </SimpleGrid>\n  )\n}\n\nconst StatByNextMoveTable: FC<{\n  stats: [Point, GamesStat][]\n  denominator: number\n  isBlackRight?: boolean\n}> = ({ stats, denominator, isBlackRight }) => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  const onClick = (p: Point) => setBoardState(boardState.setMode(BoardMode.game).edit(p))\n  return (\n    <Table width=\"100%\" size=\"rjn-info\" variant=\"rjn-info\">\n      <Thead>\n        <Tr>\n          <Th>Move</Th>\n          <Th>All</Th>\n          <Th>{isBlackRight ? 'W. won' : 'B. won'}</Th>\n          <Th>{isBlackRight ? 'B. won' : 'W. won'}</Th>\n          <Th>Draw</Th>\n        </Tr>\n      </Thead>\n      <colgroup span={1} style={{ width: '10%' }} />\n      <colgroup span={1} style={{ width: '15%' }} />\n      <colgroup span={1} style={{ width: '25%' }} />\n      <colgroup span={1} style={{ width: '25%' }} />\n      <colgroup span={1} style={{ width: '25%' }} />\n      <Tbody>\n        {stats.map(([p, s], key) => {\n          const black = { color: 'blue.200', count: s.blackWon }\n          const white = { color: 'green.200', count: s.whiteWon }\n          const [won, lost] = isBlackRight ? [white, black] : [black, white]\n          return (\n            <Tr key={key} _hover={{ bg: 'gray.100' }} onClick={() => onClick(p)}>\n              <Td isNumeric>{wrapPoint(p).toString()}</Td>\n              <Td isNumeric>{s.all}</Td>\n              <Td isNumeric>\n                {won.count !== 0 && (\n                  <PercentileBar color={won.color} count={won.count} denominator={denominator} />\n                )}\n              </Td>\n              <Td isNumeric>\n                {lost.count !== 0 && (\n                  <PercentileBar color={lost.color} count={lost.count} denominator={denominator} />\n                )}\n              </Td>\n              <Td isNumeric>\n                {s.draw !== 0 && (\n                  <PercentileBar color=\"gray.200\" count={s.draw} denominator={denominator} />\n                )}\n              </Td>\n            </Tr>\n          )\n        })}\n      </Tbody>\n    </Table>\n  )\n}\n\nconst PercentileBar: FC<{ color: string; count: number; denominator: number }> = ({\n  color,\n  count,\n  denominator,\n}) => {\n  return (\n    <Center>\n      <Flex\n        backgroundColor={color}\n        width={`${((100 * count) / denominator).toFixed()}%`}\n        justify=\"center\"\n        overflowWrap=\"normal\"\n      >\n        {count}\n      </Flex>\n    </Center>\n  )\n}\n\nexport default Default\n","import { Stack, Text } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport { AdvancedContext } from '../../contexts'\nimport SearchController from '../common/SearchController'\nimport Stats from './Stats'\n\nconst Default: FC = () => {\n  const { searchResultState } = useContext(AdvancedContext)\n  return (\n    <Stack width=\"100%\" align=\"center\">\n      <SearchController />\n      {searchResultState.error && (\n        <Text color=\"gray.600\" py=\"1rem\">\n          {searchResultState.error}\n        </Text>\n      )}\n      {searchResultState.gameIds.length > 0 && <Stats />}\n    </Stack>\n  )\n}\n\nexport default Default\n","import { Tab, TabList, TabPanel, TabPanels, Tabs } from '@chakra-ui/react'\nimport { FC, useContext, useEffect, useMemo } from 'react'\nimport { AnalyzedDatabase } from '../../database'\nimport { SearchResultState, TabName } from '../../state'\nimport { AdvancedContext, BasicContext } from '../contexts'\nimport DetailTab from './DetailTab'\nimport { EngineTab } from './EngineTab'\nimport SearchTab from './SearchTab'\nimport SetupTab from './SetupTab'\nimport StatsTab from './StatsTab'\n\nconst Default: FC = () => {\n  const db = useMemo(() => new AnalyzedDatabase(), [])\n  const { boardState } = useContext(BasicContext)\n  const { searchQueryState, setSearchQueryState, setSearchResultState } =\n    useContext(AdvancedContext)\n  const boardMoves = boardState.game.current.moves\n  const query = searchQueryState.query\n  useEffect(() => {\n    // TODO: error when game is inverted\n    setSearchQueryState(searchQueryState.setMoves(boardMoves))\n  }, [boardMoves.length])\n  useEffect(() => {\n    ;(async () => {\n      const { hit, ids, error } = await db.search(query)\n      setSearchResultState(new SearchResultState({ hit, gameIds: ids, error }))\n    })()\n  }, [query.moves?.toString(), query.playerId])\n  return <AdvancedTabs />\n}\n\nconst AdvancedTabs: FC = () => {\n  const { tabsState, setTabsState } = useContext(AdvancedContext)\n  return (\n    <Tabs\n      width=\"100%\"\n      index={tabsState.index}\n      onChange={index => setTabsState(tabsState.setIndex(index))}\n    >\n      <TabList>\n        {tabsState.names.map((name, key) => (\n          <Tab key={key}>{upperFirst(name)}</Tab>\n        ))}\n      </TabList>\n      <TabPanels>\n        {tabsState.names.map((name, key) => {\n          switch (name) {\n            case TabName.search:\n              return (\n                <TabPanel key={key} px={0}>\n                  <SearchTab />\n                </TabPanel>\n              )\n            case TabName.stats:\n              return (\n                <TabPanel key={key} px={0}>\n                  <StatsTab />\n                </TabPanel>\n              )\n            case TabName.detail:\n              return (\n                <TabPanel key={key} px={0}>\n                  <DetailTab />\n                </TabPanel>\n              )\n            case TabName.engine:\n              return (\n                <TabPanel key={key} px={0}>\n                  <EngineTab />\n                </TabPanel>\n              )\n            case TabName.setup:\n              return (\n                <TabPanel key={key} px={0}>\n                  <SetupTab />\n                </TabPanel>\n              )\n            default:\n              return <></>\n          }\n        })}\n      </TabPanels>\n    </Tabs>\n  )\n}\n\nconst upperFirst = (s: string): string => s.charAt(0).toUpperCase() + s.slice(1)\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { BOARD_SIZE, pointXToString, pointYToString } from 'renjukit'\nimport { SystemContext } from '../../contexts'\n\ntype Props = {\n  showIndices: boolean\n  showOverlay: boolean\n  colorBase: boolean\n}\n\nconst Default: FC<Props> = ({ showIndices, showOverlay, colorBase }) => {\n  const stroke = colorBase ? 'gray' : 'darkgray'\n  return (\n    <g>\n      {colorBase && <Base />}\n      <Rulers stroke={stroke} />\n      <Stars />\n      {showIndices && <Indices stroke={stroke} />}\n      {showOverlay && <Overlay />}\n    </g>\n  )\n}\n\nconst Base: FC = () => {\n  const system = useContext(SystemContext)\n  return (\n    <rect\n      x={0}\n      y={0}\n      width={system.W}\n      height={system.W}\n      rx={system.C / 4}\n      ry={system.C / 4}\n      stroke=\"none\"\n      fill=\"moccasin\"\n    />\n  )\n}\n\ntype StrokeProps = {\n  stroke: string\n}\n\nconst Rulers: FC<StrokeProps> = ({ stroke }) => {\n  const system = useContext(SystemContext)\n  const verticalLines = system.indices.map((x, key) => (\n    <line\n      key={key}\n      x1={system.cx(x)}\n      y1={system.cy(0)}\n      x2={system.cx(x)}\n      y2={system.cy(BOARD_SIZE - 1)}\n      stroke={stroke}\n      strokeLinecap=\"round\"\n      strokeWidth={system.rulerStrokeWidth}\n    />\n  ))\n  const horizontalLines = system.indices.map((y, key) => (\n    <line\n      key={key}\n      x1={system.cx(0)}\n      y1={system.cy(y)}\n      x2={system.cx(BOARD_SIZE - 1)}\n      y2={system.cy(y)}\n      stroke={stroke}\n      strokeLinecap=\"round\"\n      strokeWidth={system.rulerStrokeWidth}\n    />\n  ))\n  return (\n    <g>\n      {verticalLines}\n      {horizontalLines}\n    </g>\n  )\n}\n\nconst Stars: FC = () => {\n  const system = useContext(SystemContext)\n  const points = [\n    [3, 3],\n    [3, 11],\n    [7, 7],\n    [11, 3],\n    [11, 11],\n  ]\n  return (\n    <g>\n      {points.map(([x, y], key) => (\n        <circle\n          key={key}\n          cx={system.cx(x)}\n          cy={system.cy(y)}\n          r={system.C / 10}\n          stroke=\"none\"\n          fill=\"gray\"\n        />\n      ))}\n    </g>\n  )\n}\n\nconst Indices: FC<StrokeProps> = ({ stroke }) => {\n  const system = useContext(SystemContext)\n  const xIndices = system.indices.map((x, key) => (\n    <text\n      key={key}\n      x={system.cx(x)}\n      y={system.cy(0) + (system.P * 19) / 20 - system.indexPadding}\n      textAnchor=\"middle\"\n      fill={stroke}\n      fontSize={system.indexFontSize}\n      fontFamily=\"Roboto\"\n    >\n      {pointXToString(x)}\n    </text>\n  ))\n  const yIndices = system.indices.map((y, key) => (\n    <text\n      key={key}\n      x={(system.P * 5) / 20 + system.indexPadding}\n      y={system.cy(y)}\n      textAnchor=\"middle\"\n      dominantBaseline=\"central\"\n      fill={stroke}\n      fontSize={system.indexFontSize}\n      fontFamily=\"Roboto\"\n    >\n      {pointYToString(y)}\n    </text>\n  ))\n  return (\n    <g>\n      {xIndices}\n      {yIndices}\n    </g>\n  )\n}\n\nconst Overlay: FC = () => {\n  const system = useContext(SystemContext)\n  return (\n    <rect\n      x={0}\n      y={0}\n      width={system.W}\n      height={system.W}\n      rx={system.C / 4}\n      ry={system.C / 4}\n      fill=\"lavender\"\n      opacity={0.7}\n    />\n  )\n}\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { Point } from 'renjukit'\nimport { SystemContext } from '../../../contexts'\n\nexport const Stone: FC<{ black: boolean; point: Point; label?: string }> = ({\n  black,\n  point,\n  label,\n}) => {\n  const system = useContext(SystemContext)\n  const [cx, cy] = system.c(point)\n  const r = ((system.C / 2) * 9) / 10\n  return (\n    <g>\n      <circle\n        cx={cx}\n        cy={cy}\n        r={r}\n        strokeWidth={system.stoneStrokeWidth}\n        stroke=\"#222222\"\n        strokeOpacity=\"0.7\"\n        fill={black ? '#222222' : 'white'}\n      />\n      {label && (\n        <Text\n          label={label}\n          cx={cx}\n          cy={cy}\n          fontColor={black ? 'whitesmoke' : 'dimgray'}\n          fontSize={system.orderFontSize}\n          fontFamily=\"Noto Serif\"\n        />\n      )}\n    </g>\n  )\n}\n\nexport const SegmentMarker: FC<{\n  start: [number, number]\n  end: [number, number]\n  stroke: string\n  strokeWidth: number\n  strokeDasharray: string\n}> = ({ start, end, stroke, strokeWidth, strokeDasharray }) => {\n  const [x1, y1] = start\n  const [x2, y2] = end\n  const orthogonal = x1 === x2 || y1 === y2\n  return (\n    <g>\n      {orthogonal && (\n        <line\n          x1={x1}\n          y1={y1}\n          x2={x2}\n          y2={y2}\n          stroke=\"white\"\n          strokeWidth={strokeWidth}\n          strokeLinecap=\"butt\"\n          opacity=\"0.6\"\n        />\n      )}\n      <line\n        x1={x1}\n        y1={y1}\n        x2={x2}\n        y2={y2}\n        stroke={stroke}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeDasharray={strokeDasharray}\n        opacity=\"0.4\"\n      />\n    </g>\n  )\n}\n\nexport const PointMarker: FC<ShapeProps & FigureProps & TextProps> = ({\n  shape,\n  cx,\n  cy,\n  r,\n  color,\n  opacity,\n  label,\n  fontSize,\n  fontFamily,\n  fontColor,\n}) => {\n  const figure = (() => {\n    switch (shape) {\n      case 'circle':\n        return <Circle cx={cx} cy={cy} r={r} color={color} opacity={opacity} />\n      case 'diamond':\n        return <Diamond cx={cx} cy={cy} r={r} color={color} opacity={opacity} />\n      case 'cross':\n        return <Cross cx={cx} cy={cy} r={r} color={color} opacity={opacity} />\n    }\n  })()\n  const text = label !== undefined && (\n    <Text\n      label={label}\n      cx={cx}\n      cy={cy}\n      fontColor={fontColor}\n      fontSize={fontSize}\n      fontFamily={fontFamily}\n    />\n  )\n  return (\n    <g>\n      {figure}\n      {text}\n    </g>\n  )\n}\n\ntype ShapeProps = {\n  shape: 'circle' | 'diamond' | 'cross'\n}\n\ntype FigureProps = {\n  cx: number\n  cy: number\n  r: number\n  color: string\n  opacity: number\n}\n\ntype TextProps = {\n  cx: number\n  cy: number\n  label?: string\n  fontSize?: string\n  fontColor?: string\n  fontFamily?: string\n}\n\nconst Circle: FC<FigureProps> = ({ cx, cy, r, color, opacity }) => (\n  <g>\n    <circle cx={cx} cy={cy} r={r} stroke=\"none\" fill={color} fillOpacity={opacity} />\n  </g>\n)\n\nconst Diamond: FC<FigureProps> = ({ cx, cy, r, color, opacity }) => (\n  <g transform={`rotate(45, ${cx}, ${cy})`}>\n    <rect\n      x={cx - r}\n      y={cy - r}\n      width={r * 2}\n      height={r * 2}\n      stroke=\"none\"\n      fill={color}\n      fillOpacity={opacity}\n    />\n  </g>\n)\n\nconst Cross: FC<FigureProps> = ({ cx, cy, r, color, opacity }) => {\n  const [x1, x2, y1, y2] = [cx - r, cx + r, cy + r, cy - r]\n  const strokeWidth = (r * 6) / 10\n  return (\n    <g>\n      <line\n        x1={x1}\n        y1={y1}\n        x2={x2}\n        y2={y2}\n        stroke={color}\n        strokeWidth={strokeWidth}\n        opacity={opacity}\n      />\n      <line\n        x1={x1}\n        y1={y2}\n        x2={x2}\n        y2={y1}\n        stroke={color}\n        strokeWidth={strokeWidth}\n        opacity={opacity}\n      />\n    </g>\n  )\n}\n\nconst Text: FC<TextProps> = ({ label, cx, cy, fontColor, fontSize, fontFamily }) => (\n  <text\n    x={cx}\n    y={cy}\n    textAnchor=\"middle\"\n    dominantBaseline=\"central\"\n    fill={fontColor}\n    fontSize={fontSize}\n    fontFamily={fontFamily}\n  >\n    {label}\n  </text>\n)\n","import { FC, useContext } from 'react'\nimport { PointsState, SegmentsState } from '../../../state'\nimport { SystemContext } from '../../contexts'\nimport { PointMarker, SegmentMarker } from './common'\n\ntype PathAppearance = 'everyOther' | 'eachFromBlack' | 'eachFromWhite'\n\ntype Props = {\n  segments: SegmentsState\n  points: PointsState\n  showPointsLabel: boolean\n  path: PointsState\n  pathAppearance: PathAppearance\n}\n\nconst Default: FC<Props> = ({ segments, points, path, showPointsLabel, pathAppearance }) => (\n  <g>\n    <Segments state={segments} />\n    <Points state={points} showLabel={showPointsLabel} />\n    <Path state={path} appearance={pathAppearance} />\n  </g>\n)\n\nconst Segments: FC<{ state: SegmentsState }> = ({ state }) => {\n  const system = useContext(SystemContext)\n  const segments = state.segments.map(([start, end], key) => (\n    <SegmentMarker\n      key={key}\n      start={system.c(start)}\n      end={system.c(end)}\n      stroke=\"darkviolet\"\n      strokeWidth={system.propertyRowStrokeWidth}\n      strokeDasharray={system.propertyRowStrokeDasharray}\n    />\n  ))\n  const start = (() => {\n    if (state.start === undefined) return undefined\n    const [cx, cy] = system.c(state.start)\n    const r = (system.C / 16) * 3\n    return <PointMarker shape=\"circle\" cx={cx} cy={cy} r={r} color=\"darkviolet\" opacity={0.8} />\n  })()\n  return (\n    <g>\n      {segments}\n      {start}\n    </g>\n  )\n}\n\nconst Points: FC<{ state: PointsState; showLabel: boolean }> = ({ state, showLabel }) => {\n  const system = useContext(SystemContext)\n  const r = (system.C * 3) / 8\n  const markers = state.points.map((p, key) => {\n    const [cx, cy] = system.c(p)\n    const text = showLabel ? 'abcdefghijklmnopqrstuvwxyz'.charAt(key) : undefined\n    return (\n      <PointMarker\n        key={key}\n        shape=\"circle\"\n        cx={cx}\n        cy={cy}\n        r={r}\n        color=\"silver\"\n        opacity={0.8}\n        label={text}\n        fontColor=\"#333333\"\n        fontSize={system.markerFontSize}\n        fontFamily=\"Noto Serif\"\n      />\n    )\n  })\n  return <g>{markers}</g>\n}\n\nconst Path: FC<{ state: PointsState; appearance: PathAppearance }> = ({ state, appearance }) => {\n  const system = useContext(SystemContext)\n  const r = (system.C * 3) / 8\n  const last = state.points.length - 1\n  const markers = state.points.map((p, key) => {\n    const [cx, cy] = system.c(p)\n    const hide = appearance === 'everyOther' && key % 2 === 1\n    const [color, fontColor] = pathPointColor(appearance, key, last)\n    return hide ? (\n      <></>\n    ) : (\n      <PointMarker\n        key={key}\n        shape=\"circle\"\n        cx={cx}\n        cy={cy}\n        r={r}\n        color={color}\n        opacity={0.8}\n        label={`${key + 1}`}\n        fontColor={fontColor}\n        fontSize={system.markerFontSize}\n        fontFamily=\"Roboto\"\n      />\n    )\n  })\n  return <g>{markers}</g>\n}\n\nconst pathPointColor = (\n  appearance: PathAppearance,\n  key: number,\n  last: number\n): [string, string] => {\n  const isFirst = key === 0\n  const isLast = key === last\n  const isStarter = key % 2 === 0\n  switch (appearance) {\n    case 'everyOther':\n      return isFirst || isLast ? ['indigo', 'white'] : ['white', 'indigo']\n    case 'eachFromBlack':\n      return isStarter ? ['black', 'white'] : ['white', 'black']\n    case 'eachFromWhite':\n      return isStarter ? ['white', 'black'] : ['black', 'white']\n  }\n}\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { Board, Player, Point, Row, RowKind, wrapBoard } from 'renjukit'\nimport { wrapRow } from 'renjukit/dist/board/row'\nimport { SystemContext } from '../../contexts'\nimport { PointMarker, SegmentMarker } from './common'\n\ntype Props = {\n  board: Board\n  showRows: boolean\n  showEyes: boolean\n  showForbiddens: boolean\n}\n\nconst Default: FC<Props> = ({ board, showRows, showEyes, showForbiddens }) => {\n  const board_ = wrapBoard(board)\n  return (\n    <g>\n      {showRows && (\n        <>\n          <Rows rows={board_.rows(Player.black, RowKind.two)} black />\n          <Rows rows={board_.rows(Player.black, RowKind.sword)} black />\n          <Rows rows={board_.rows(Player.black, RowKind.three)} black />\n          <Rows rows={board_.rows(Player.black, RowKind.four)} black />\n          <Rows rows={board_.rows(Player.white, RowKind.two)} />\n          <Rows rows={board_.rows(Player.white, RowKind.sword)} />\n          <Rows rows={board_.rows(Player.white, RowKind.three)} />\n          <Rows rows={board_.rows(Player.white, RowKind.four)} />\n        </>\n      )}\n      {showEyes && (\n        <>\n          <Eyes rows={board_.rows(Player.black, RowKind.three)} black />\n          <Eyes rows={board_.rows(Player.black, RowKind.four)} black emphasized />\n          <Eyes rows={board_.rows(Player.white, RowKind.three)} />\n          <Eyes rows={board_.rows(Player.white, RowKind.four)} emphasized />\n        </>\n      )}\n      {showForbiddens && <Forbiddens points={board_.forbiddens().map(([_, p]) => p)} />}\n    </g>\n  )\n}\n\ntype RowsProps = {\n  black?: boolean\n  rows: Row[]\n  emphasized?: boolean\n}\n\nconst Rows: FC<RowsProps> = ({ black, rows }) => {\n  const system = useContext(SystemContext)\n  const stroke = black ? 'blue' : 'darkgreen'\n  const segments = rows.map((row, key) => (\n    <SegmentMarker\n      key={key}\n      start={system.c(row.start)}\n      end={system.c(row.end)}\n      stroke={stroke}\n      strokeWidth={system.propertyRowStrokeWidth}\n      strokeDasharray={system.propertyRowStrokeDasharray}\n    />\n  ))\n  return <g>{segments}</g>\n}\n\nconst Eyes: FC<RowsProps> = ({ black, rows, emphasized }) => {\n  const system = useContext(SystemContext)\n  const r = (system.C * 2) / 10\n  const color = black ? 'blue' : 'darkgreen'\n  const gs = rows.map((row, m) => {\n    const row_ = wrapRow(row)\n    const rects = row_.eyes().map((e, n) => {\n      const [cx, cy] = system.c(e)\n      return emphasized ? (\n        <PointMarker shape=\"diamond\" key={n} cx={cx} cy={cy} r={r} color={color} opacity={0.7} />\n      ) : (\n        <PointMarker key={n} shape=\"circle\" cx={cx} cy={cy} r={r} color={color} opacity={0.4} />\n      )\n    })\n    return <g key={m}>{rects}</g>\n  })\n  return <g>{gs}</g>\n}\n\nconst Forbiddens: FC<{ points: Point[] }> = ({ points }) => {\n  const system = useContext(SystemContext)\n  const r = (system.C * 2) / 10\n  const crosses = points.map((p, key) => {\n    const [cx, cy] = system.c(p)\n    return <PointMarker key={key} shape=\"cross\" cx={cx} cy={cy} r={r} color=\"red\" opacity={0.5} />\n  })\n  return <g>{crosses}</g>\n}\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { Point } from 'renjukit'\nimport { Game } from '../../../rule'\nimport { PointsState } from '../../../state'\nimport { SystemContext } from '../../contexts'\nimport { PointMarker, Stone } from './common'\n\ntype Props = {\n  game: Game\n  showOrders: boolean\n  showLastMove: boolean\n  freeBlacks: PointsState\n  freeWhites: PointsState\n}\n\nconst Default: FC<Props> = ({ game, showOrders, showLastMove, freeBlacks, freeWhites }) => {\n  return (\n    <g>\n      {showLastMove && game.lastMove && <LastMove point={game.lastMove} />}\n      <Moves points={game.moves} inverted={game.inverted} showOrders={showOrders} />\n      <FreeStones points={freeBlacks.points} black={true} />\n      <FreeStones points={freeWhites.points} black={false} />\n    </g>\n  )\n}\n\nconst Moves: FC<{ points: Point[]; inverted: boolean; showOrders: boolean }> = ({\n  points,\n  inverted,\n  showOrders,\n}) => (\n  <g>\n    {points.map((p, key) => {\n      const black = inverted ? key % 2 === 1 : key % 2 === 0\n      return (\n        <Stone key={key} point={p} black={black} label={showOrders ? `${key + 1}` : undefined} />\n      )\n    })}\n  </g>\n)\n\nconst FreeStones: FC<{ points: Point[]; black: boolean }> = ({ points, black }) => (\n  <g>\n    {points.map((p, key) => (\n      <Stone key={key} point={p} black={black} />\n    ))}\n  </g>\n)\n\nconst LastMove: FC<{ point: Point }> = ({ point }) => {\n  const system = useContext(SystemContext)\n  const [cx, cy] = system.c(point)\n  const r = ((system.C / 2) * 21) / 20\n  return <PointMarker shape=\"circle\" cx={cx} cy={cy} r={r} color=\"violet\" opacity={1.0} />\n}\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { SystemContext } from '../../contexts'\n\ntype Eval = { x: number; y: number; score: number }\n\nconst Evals: FC<{ evals: Eval[] }> = ({ evals }) => {\n  const system = useContext(SystemContext)\n  const labels = evals.map((e, key) => {\n    const [cx, cy] = system.c([e.x, e.y])\n    const label = `${e.score}`\n    return (\n      <text\n        key={key}\n        x={cx}\n        y={cy}\n        textAnchor=\"middle\"\n        dominantBaseline=\"central\"\n        fill={e.score >= 0 ? 'darkblue' : 'darkred'}\n        fontSize={system.markerFontSize}\n        fontFamily=\"Roboto\"\n        opacity={0.9}\n      >\n        {label}\n      </text>\n    )\n  })\n  return <g>{labels}</g>\n}\n\nexport default Evals\n","import React, { FC, useContext } from 'react'\nimport { Point } from 'renjukit'\nimport { BoardMode, BoardState } from '../../../state'\nimport { PreferenceContext, PreferenceOption, SystemContext } from '../../contexts'\nimport Base from './Base'\nimport Markers from './Markers'\nimport Properties from './Properties'\nimport Stones from './Stones'\nimport Evals from './Evals'\n\ntype Props = {\n  id: string\n  state: BoardState\n  onClickPoint?: ([x, y]: Point) => void\n}\n\nconst Default: FC<Props> = ({ id, onClickPoint, state }) => {\n  const system = useContext(SystemContext)\n  const { preference } = useContext(PreferenceContext)\n  const game = state.mode === BoardMode.preview ? state.game.main : state.game.current\n  const onClick =\n    onClickPoint &&\n    ((e: React.MouseEvent<SVGElement, MouseEvent>) => {\n      const base = e.currentTarget.getBoundingClientRect()\n      const [bx, by] = [e.clientX - base.x, e.clientY - base.y]\n      onClickPoint(system.p([bx, by]))\n    })\n  const isPreview = state.mode === BoardMode.preview\n  const pathAppearance = preference.has(PreferenceOption.pathEveryOther)\n    ? 'everyOther'\n    : state.pathTurn\n    ? 'eachFromBlack'\n    : 'eachFromWhite'\n  return (\n    <svg id={id} width={system.W} height={system.W} onClick={onClick}>\n      <Base\n        showIndices={preference.has(PreferenceOption.showIndices)}\n        showOverlay={isPreview}\n        colorBase={preference.has(PreferenceOption.colorBase)}\n      />\n      {!isPreview && (\n        <Properties\n          board={state.current}\n          showRows={preference.has(PreferenceOption.showPropertyRows)}\n          showEyes={preference.has(PreferenceOption.showPropertyEyes)}\n          showForbiddens={preference.has(PreferenceOption.showForbiddens)}\n        />\n      )}\n      {!isPreview && (\n        <Markers\n          points={state.markerPoints}\n          segments={state.markerLines}\n          path={state.markerPath}\n          showPointsLabel={preference.has(PreferenceOption.showOrders)}\n          pathAppearance={pathAppearance}\n        />\n      )}\n      <Stones\n        game={game}\n        showOrders={preference.has(PreferenceOption.showOrders)}\n        showLastMove={preference.has(PreferenceOption.emphasizeLastMove)}\n        freeBlacks={state.freeBlacks}\n        freeWhites={state.freeWhites}\n      />\n      {!isPreview && state.evals.length > 0 && <Evals evals={state.evals} />}\n    </svg>\n  )\n}\n\nexport default Default\n","import { FC, useContext } from 'react'\nimport { Point } from 'renjukit'\nimport Board from '../common/Board'\nimport { BasicContext } from '../contexts'\n\nconst MAIN_BOARD_ID = 'main-board'\n\nconst Default: FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  const onClickPoint = (p: Point) => setBoardState(boardState.edit(p))\n  return <Board id={MAIN_BOARD_ID} state={boardState} onClickPoint={onClickPoint} />\n}\n\nexport default Default\n","import { Button, ButtonGroup } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport { BasicContext, SystemContext } from '../../contexts'\n\nconst Default: FC = () => {\n  const system = useContext(SystemContext)\n  const { confirmState } = useContext(BasicContext)\n  if (confirmState === undefined) {\n    return <></>\n  }\n  return (\n    <ButtonGroup\n      width=\"100%\"\n      justifyContent=\"space-evenly\"\n      alignItems=\"center\"\n      size={system.buttonSize}\n    >\n      <Button\n        width=\"25%\"\n        colorScheme={confirmState.ok.colorScheme}\n        onClick={confirmState.ok.onClick}\n      >\n        {confirmState.ok.text}\n      </Button>\n      <Button\n        width=\"25%\"\n        colorScheme={confirmState.cancel.colorScheme}\n        onClick={confirmState.cancel.onClick}\n      >\n        {confirmState.cancel.text}\n      </Button>\n    </ButtonGroup>\n  )\n}\n\nexport default Default\n","import {\n  Flex,\n  Icon,\n  IconButton,\n  Menu,\n  MenuButton,\n  MenuDivider,\n  MenuItem,\n  MenuItemOption,\n  MenuList,\n  MenuOptionGroup,\n  Text,\n} from '@chakra-ui/react'\nimport 'firebase/analytics'\nimport { FC, useContext } from 'react'\nimport {\n  RiAddCircleFill,\n  RiAddCircleLine,\n  RiContrastFill,\n  RiDeleteBinFill,\n  RiEditCircleFill,\n  RiEditLine,\n  RiRadioButtonLine,\n} from 'react-icons/ri'\nimport { BoardMode, BoardState } from '../../../state'\nimport { BasicContext } from '../../contexts'\n\nconst Default: FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  const onSetMode = (value: string | string[]) => {\n    setBoardState(boardState.setMode(value as BoardMode))\n  }\n  const onSetOptions = (value: string | string[]) => {\n    const invertMoves = (value as string[]).includes('invertMoves')\n    const gameState = boardState.game.invertMoves(invertMoves)\n    setBoardState(boardState.setGame(gameState))\n  }\n  const onResetAll = () => {\n    const message = 'All moves, free stones and markers will be cleared. OK?'\n    if (!window.confirm(message)) return\n    setBoardState(new BoardState())\n  }\n  return (\n    <>\n      <Menu autoSelect={false} placement=\"top\" closeOnSelect={false}>\n        <MenuButton as={IconButton} icon={<ModeIcon mode={boardState.mode} />} aria-label=\"edit\" />\n        <MenuList>\n          <MenuOptionGroup type=\"radio\" title=\"Mode\" value={boardState.mode} onChange={onSetMode}>\n            <MenuItemOption value={BoardMode.game}>\n              <Flex alignItems=\"center\">\n                <ModeIcon mode={BoardMode.game} />\n                <Text ml={2}>Move</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={BoardMode.freeBlacks}>\n              <Flex alignItems=\"center\">\n                <ModeIcon mode={BoardMode.freeBlacks} />\n                <Text ml={2}>Add Black Stones</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={BoardMode.freeWhites}>\n              <Flex alignItems=\"center\">\n                <ModeIcon mode={BoardMode.freeWhites} />\n                <Text ml={2}>Add White Stones</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={BoardMode.markerPoints}>\n              <Flex alignItems=\"center\">\n                <ModeIcon mode={BoardMode.markerPoints} />\n                <Text ml={2}>Mark Points</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={BoardMode.markerLines}>\n              <Flex alignItems=\"center\">\n                <ModeIcon mode={BoardMode.markerLines} />\n                <Text ml={2}>Mark Lines</Text>\n              </Flex>\n            </MenuItemOption>\n          </MenuOptionGroup>\n          <MenuOptionGroup\n            type=\"checkbox\"\n            title=\"Option\"\n            value={boardState.game.main.inverted ? ['invertMoves'] : []}\n            onChange={onSetOptions}\n          >\n            <MenuItemOption value=\"invertMoves\">\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiContrastFill} />\n                <Text ml={2}>Invert Moves</Text>\n              </Flex>\n            </MenuItemOption>\n          </MenuOptionGroup>\n          <MenuDivider />\n          <MenuItem onClick={onResetAll}>\n            <Icon boxSize=\"small\" as={RiDeleteBinFill} color=\"red.500\" />\n            <Text ml={2} color=\"red.500\">\n              Reset All\n            </Text>\n          </MenuItem>\n        </MenuList>\n      </Menu>\n    </>\n  )\n}\n\nconst ModeIcon: FC<{ mode: BoardMode }> = ({ mode }) => {\n  switch (mode) {\n    case BoardMode.game:\n      return <Icon boxSize=\"small\" as={RiRadioButtonLine} />\n    case BoardMode.freeBlacks:\n      return <Icon boxSize=\"small\" as={RiAddCircleFill} />\n    case BoardMode.freeWhites:\n      return <Icon boxSize=\"small\" as={RiAddCircleLine} />\n    case BoardMode.markerPoints:\n      return <Icon boxSize=\"small\" as={RiEditCircleFill} />\n    case BoardMode.markerLines:\n      return <Icon boxSize=\"small\" as={RiEditLine} />\n    default:\n      return <Icon boxSize=\"small\" as={RiRadioButtonLine} />\n  }\n}\n\nexport default Default\n","import {\n  Box,\n  Heading,\n  Link,\n  List,\n  ListIcon,\n  ListItem,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalFooter,\n  ModalHeader,\n  ModalOverlay,\n  Stack,\n  UnorderedList,\n} from '@chakra-ui/react'\nimport { FC } from 'react'\nimport { FiGithub, FiTwitter } from 'react-icons/fi'\n\ntype Props = {\n  isOpen: boolean\n  onClose: () => void\n}\n\nconst Default: FC<Props> = ({ isOpen, onClose }) => {\n  return (\n    <Modal isOpen={isOpen} onClose={onClose} isCentered>\n      <ModalOverlay />\n      <ModalContent>\n        <ModalHeader as=\"h1\">About Renju Note</ModalHeader>\n        <ModalCloseButton />\n        <ModalBody>\n          <Stack>\n            <Heading as=\"h2\" size=\"sm\">\n              Links\n            </Heading>\n            <List>\n              <ListItem>\n                <ListIcon as={FiTwitter} />\n                <Link href=\"//twitter.com/yubessy_renju\" color=\"teal.500\" isExternal>\n                  @yubessy_renju\n                </Link>\n                &nbsp;-&nbsp;contact\n              </ListItem>\n              <ListItem>\n                <ListIcon as={FiGithub} />\n                <Link href=\"//github.com/renju-note\" color=\"teal.500\" isExternal>\n                  @renju-note\n                </Link>\n                &nbsp;-&nbsp;source code\n              </ListItem>\n            </List>\n            <Heading as=\"h2\" size=\"sm\">\n              Remarks\n            </Heading>\n            <Box>\n              <UnorderedList>\n                <ListItem>Use on your own responsibility.</ListItem>\n                <ListItem>\n                  Some of your activity logs will be sent to third-party analytics services in order\n                  to improve user experiences.\n                </ListItem>\n              </UnorderedList>\n            </Box>\n          </Stack>\n        </ModalBody>\n        <ModalFooter></ModalFooter>\n      </ModalContent>\n    </Modal>\n  )\n}\n\nexport default Default\n","import { Box } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport Board from '../../../common/Board'\nimport { BasicContext, System, SystemContext } from '../../../contexts'\n\ntype Props = {\n  id: string\n}\n\nconst Default: FC<Props> = ({ id }) => {\n  const { boardState } = useContext(BasicContext)\n  return (\n    <Box hidden>\n      <SystemContext.Provider value={new System(640)}>\n        <Board id={id} state={boardState} />\n      </SystemContext.Provider>\n    </Box>\n  )\n}\n\nexport const onDownload = (id: string) => {\n  const svgElem = document.getElementById(id)! as unknown as SVGSVGElement\n  const svgData = new XMLSerializer().serializeToString(svgElem)\n  const imageElem = new Image()\n  imageElem.src =\n    'data:image/svg+xml;charset=utf-8;base64,' + btoa(unescape(encodeURIComponent(svgData)))\n  const canvasElem = document.createElement('canvas')\n  canvasElem.width = svgElem.width.baseVal.value\n  canvasElem.height = svgElem.height.baseVal.value\n  const ctx = canvasElem.getContext('2d')!\n  ctx.fillStyle = 'white'\n  ctx.fillRect(0, 0, canvasElem.width, canvasElem.height)\n  imageElem.onload = () => {\n    ctx.drawImage(imageElem, 0, 0)\n    const a = document.createElement('a') as HTMLAnchorElement\n    a.href = canvasElem.toDataURL('image/png')\n    a.setAttribute('download', 'renju-note.png')\n    a.dispatchEvent(new MouseEvent('click'))\n  }\n}\n\nexport default Default\n","import {\n  AlertDialog,\n  AlertDialogBody,\n  AlertDialogContent,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogOverlay,\n  Button,\n  Icon,\n  IconButton,\n  Menu,\n  MenuButton,\n  MenuDivider,\n  MenuGroup,\n  MenuItem,\n  MenuList,\n  Text,\n  useClipboard,\n  useDisclosure,\n  useToast,\n} from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport {\n  RiClipboardLine,\n  RiDownload2Line,\n  RiFlaskFill,\n  RiFolderChartLine,\n  RiFolderForbidLine,\n  RiMenuLine,\n  RiQuestionLine,\n} from 'react-icons/ri'\nimport { wrapPoints } from 'renjukit'\nimport { BasicContext, PreferenceContext, PreferenceOption } from '../../../contexts'\nimport AboutModal from './AboutModal'\nimport DownloadHidden, { onDownload } from './DownloadHidden'\n\nconst Default: FC = () => {\n  const toast = useToast()\n\n  // Copy Moves to Clipboard\n  const { boardState } = useContext(BasicContext)\n  const code = wrapPoints(boardState.game.current.moves).toString()\n  const { onCopy, value } = useClipboard(code)\n  const onCopyMovesToClipboard = () => {\n    if (!value) return\n    onCopy()\n    toast({\n      title: 'Copied.',\n      description: `Paste them as you need.`,\n      status: 'success',\n      duration: 5000,\n      isClosable: true,\n    })\n  }\n\n  // Download Board Picture\n  const downloadHiddenId = 'download-hidden'\n  const onDownloadBoardPicture = () => {\n    onDownload(downloadHiddenId)\n    toast({\n      title: 'Downloaded.',\n      description: \"Check your browser's status.\",\n      status: 'success',\n      duration: 5000,\n      isClosable: true,\n    })\n  }\n\n  // Advanced Mode\n  const advancedModeDisclosure = useDisclosure()\n  const { preference, setPreference } = useContext(PreferenceContext)\n  const isAdvanced = preference.has(PreferenceOption.advancedMode)\n  const modeIcon = isAdvanced ? RiFolderForbidLine : RiFolderChartLine\n  const toggleMode = () => {\n    if (isAdvanced) {\n      setPreference(preference.off([PreferenceOption.advancedMode]))\n    } else {\n      advancedModeDisclosure.onOpen()\n      setPreference(preference.on([PreferenceOption.advancedMode]))\n    }\n  }\n\n  const aboutDisclosure = useDisclosure()\n  return (\n    <>\n      <Menu autoSelect={false} placement=\"top-start\">\n        <MenuButton as={IconButton} icon={<RiMenuLine />} />\n        <MenuList>\n          <MenuGroup title=\"Actions\">\n            <MenuItem onClick={onCopyMovesToClipboard}>\n              <Icon boxSize=\"small\" as={RiClipboardLine} />\n              <Text ml={2}>Copy Moves to Clipboard</Text>\n            </MenuItem>\n            <MenuItem onClick={onDownloadBoardPicture}>\n              <Icon boxSize=\"small\" as={RiDownload2Line} />\n              <Text ml={2}>Download Board Picture</Text>\n            </MenuItem>\n          </MenuGroup>\n          <MenuGroup title=\"Advanced\">\n            <MenuItem onClick={toggleMode}>\n              <Icon boxSize=\"small\" as={modeIcon} />\n              <Text ml={2} mr={1}>\n                {isAdvanced ? 'Basic Mode' : 'Advanced Mode'}\n              </Text>\n              {!isAdvanced && <Icon boxSize=\"small\" as={RiFlaskFill} />}\n            </MenuItem>\n          </MenuGroup>\n          <MenuDivider />\n          <MenuItem onClick={aboutDisclosure.onOpen}>\n            <Icon boxSize=\"small\" as={RiQuestionLine} />\n            <Text ml={2}>About Renju Note</Text>\n          </MenuItem>\n        </MenuList>\n      </Menu>\n      <DownloadHidden id={downloadHiddenId} />\n      <AdvancedModeAlertDialog\n        isOpen={advancedModeDisclosure.isOpen}\n        onClose={advancedModeDisclosure.onClose}\n      />\n      <AboutModal isOpen={aboutDisclosure.isOpen} onClose={aboutDisclosure.onClose} />\n    </>\n  )\n}\n\nconst AdvancedModeAlertDialog: FC<{ isOpen: boolean; onClose: () => void }> = ({\n  isOpen,\n  onClose,\n}) => {\n  return (\n    <AlertDialog isOpen={isOpen} onClose={onClose} leastDestructiveRef={undefined} isCentered>\n      <AlertDialogOverlay>\n        <AlertDialogContent>\n          <AlertDialogHeader as=\"h1\">Now you&apos;re in advanced mode!</AlertDialogHeader>\n          <AlertDialogBody>\n            All features in advanced mode are <b>EXPERIMENTAL</b>. There is no guarantee for their\n            behaviour on your device.\n          </AlertDialogBody>\n          <AlertDialogFooter>\n            <Button colorScheme=\"blue\" onClick={onClose}>\n              OK\n            </Button>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialogOverlay>\n    </AlertDialog>\n  )\n}\n\nexport default Default\n","import {\n  Button,\n  ButtonGroup,\n  Icon,\n  IconButton,\n  Menu,\n  MenuButton,\n  MenuDivider,\n  MenuItem,\n  MenuList,\n  Text,\n} from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport {\n  FiChevronLeft,\n  FiChevronRight,\n  FiChevronsLeft,\n  FiChevronsRight,\n  FiGitBranch,\n} from 'react-icons/fi'\nimport { RiDeleteBack2Line, RiRefreshLine } from 'react-icons/ri'\nimport { GameState } from '../../../state'\nimport { BasicContext, SystemContext } from '../../contexts'\n\nconst Default: FC = () => {\n  const system = useContext(SystemContext)\n  const [game, setGame] = useGameContext()\n  return (\n    <ButtonGroup spacing={1} variant=\"ghost\" size={system.buttonSize}>\n      <IconButton\n        onClick={() => setGame(game.toStart())}\n        icon={<FiChevronsLeft />}\n        aria-label=\"to start\"\n        isDisabled={!game.canBackward}\n      />\n      <IconButton\n        onClick={() => setGame(game.backward())}\n        icon={<FiChevronLeft />}\n        aria-label=\"backward\"\n        isDisabled={!game.canBackward}\n      />\n      {game.isBranching ? (\n        <BranchingMenu />\n      ) : (\n        <Button\n          width={6} // do not resize according to text\n          fontFamily=\"Noto Serif\"\n          fontWeight=\"normal\"\n          isDisabled={true}\n        >\n          {game.cursor}\n        </Button>\n      )}\n      <IconButton\n        onClick={() => setGame(game.forward())}\n        icon={<FiChevronRight />}\n        aria-label=\"forward\"\n        isDisabled={!game.canForward}\n      />\n      <IconButton\n        onClick={() => setGame(game.toLast())}\n        icon={<FiChevronsRight />}\n        aria-label=\"to last\"\n        isDisabled={!game.canForward}\n      />\n    </ButtonGroup>\n  )\n}\n\nconst BranchingMenu: FC = () => {\n  const [game, setGame] = useGameContext()\n  return (\n    <Menu autoSelect={false} placement=\"top\">\n      <MenuButton as={IconButton} icon={<FiGitBranch />} colorScheme=\"purple\" />\n      <MenuList>\n        <MenuItem onClick={() => setGame(game.clearBranch())}>\n          <Icon boxSize=\"small\" as={RiDeleteBack2Line} />\n          <Text ml={2} mr={1}>\n            Clear Branch\n          </Text>\n        </MenuItem>\n        <MenuDivider />\n        <MenuItem onClick={() => setGame(game.newFromBranch())}>\n          <Icon boxSize=\"small\" as={RiRefreshLine} />\n          <Text ml={2} mr={1}>\n            Set Branch as Main\n          </Text>\n        </MenuItem>\n      </MenuList>\n    </Menu>\n  )\n}\n\nconst useGameContext = (): [GameState, (game: GameState) => void] => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  return [boardState.game, game => setBoardState(boardState.setGame(game))]\n}\n\nexport default Default\n","import {\n  Flex,\n  Icon,\n  IconButton,\n  Menu,\n  MenuButton,\n  MenuItemOption,\n  MenuList,\n  MenuOptionGroup,\n  Text,\n} from '@chakra-ui/react'\nimport 'firebase/analytics'\nimport { FC, useContext } from 'react'\nimport {\n  RiCloseLine,\n  RiFocus2Fill,\n  RiGitCommitFill,\n  RiGridLine,\n  RiInformationLine,\n  RiMicrosoftFill,\n  RiSettings2Line,\n  RiStopMiniFill,\n} from 'react-icons/ri'\nimport { PreferenceContext, PreferenceOption } from '../../contexts'\n\nconst Default: FC = () => {\n  const { preference, setPreference } = useContext(PreferenceContext)\n  const boardAndMovesPreferences = [\n    PreferenceOption.colorBase,\n    PreferenceOption.showIndices,\n    PreferenceOption.showOrders,\n    PreferenceOption.emphasizeLastMove,\n  ]\n  const visualizationPreferences = [\n    PreferenceOption.showForbiddens,\n    PreferenceOption.showPropertyEyes,\n    PreferenceOption.showPropertyRows,\n  ]\n  return (\n    <>\n      <Menu placement=\"top-end\" autoSelect={false} closeOnSelect={false}>\n        <MenuButton as={IconButton} icon={<RiSettings2Line />} aria-label=\"more\" />\n        <MenuList>\n          <MenuOptionGroup\n            title=\"Board and Moves\"\n            type=\"checkbox\"\n            defaultValue={preference.values}\n            onChange={(values: any) =>\n              setPreference(\n                preference.change(boardAndMovesPreferences, values as PreferenceOption[])\n              )\n            }\n          >\n            <MenuItemOption value={PreferenceOption.colorBase}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiMicrosoftFill} />\n                <Text ml={2}>Color Board</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={PreferenceOption.showIndices}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiGridLine} />\n                <Text ml={2}>Line Indices</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={PreferenceOption.showOrders}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiInformationLine} />\n                <Text ml={2}>Move Orders</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={PreferenceOption.emphasizeLastMove}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiFocus2Fill} />\n                <Text ml={2}>Last Move</Text>\n              </Flex>\n            </MenuItemOption>\n          </MenuOptionGroup>\n          <MenuOptionGroup\n            title=\"Properties\"\n            type=\"checkbox\"\n            defaultValue={preference.values}\n            onChange={(values: any) =>\n              setPreference(\n                preference.change(visualizationPreferences, values as PreferenceOption[])\n              )\n            }\n          >\n            <MenuItemOption value={PreferenceOption.showForbiddens}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiCloseLine} />\n                <Text ml={2}>Forbidden Points</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value={PreferenceOption.showPropertyEyes}>\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiStopMiniFill} style={{ transform: 'rotate(45deg)' }} />\n                <Text ml={2}>Threes and Fours</Text>\n              </Flex>\n            </MenuItemOption>\n            <MenuItemOption value=\"showPropertyRows\">\n              <Flex alignItems=\"center\">\n                <Icon boxSize=\"small\" as={RiGitCommitFill} />\n                <Text ml={2}>Potential Lines</Text>\n              </Flex>\n            </MenuItemOption>\n          </MenuOptionGroup>\n        </MenuList>\n      </Menu>\n    </>\n  )\n}\n\nexport default Default\n","import { Icon, IconButton, Menu, MenuButton, MenuItem, MenuList, Text } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport { FiXSquare } from 'react-icons/fi'\nimport {\n  RiCloseCircleLine,\n  RiDeleteBack2Line,\n  RiEraserFill,\n  RiEraserLine,\n  RiIndeterminateCircleFill,\n  RiIndeterminateCircleLine,\n} from 'react-icons/ri'\nimport { BoardMode, GameState } from '../../../state'\nimport { BasicContext } from '../../contexts'\n\nconst Default: FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  if (boardState.canClearRestOfMoves) return <ClearRestOfMovesMenu />\n  if (boardState.canClearMainGame) return <ClearMainGameMenu />\n  return (\n    <IconButton\n      onClick={() => setBoardState(boardState.undo())}\n      onTouchStart={e => e.preventDefault()}\n      icon={<UndoIcon mode={boardState.mode} />}\n      aria-label=\"undo\"\n      colorScheme={boardState.game.isBranching ? 'purple' : undefined}\n      isDisabled={!boardState.canUndo}\n    />\n  )\n}\n\nconst UndoIcon: FC<{ mode: BoardMode }> = ({ mode }) => {\n  switch (mode) {\n    case BoardMode.game:\n      return <RiCloseCircleLine />\n    case BoardMode.freeBlacks:\n      return <RiIndeterminateCircleFill />\n    case BoardMode.freeWhites:\n      return <RiIndeterminateCircleLine />\n    case BoardMode.markerPoints:\n      return <RiEraserFill />\n    case BoardMode.markerLines:\n      return <RiEraserLine />\n    default:\n      return <RiCloseCircleLine />\n  }\n}\n\nconst ClearRestOfMovesMenu: FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  return (\n    <Menu autoSelect={false} placement=\"top\">\n      <MenuButton\n        as={IconButton}\n        icon={<RiDeleteBack2Line style={{ transform: 'rotate(180deg)' }} />}\n      />\n      <MenuList>\n        <MenuItem onClick={() => setBoardState(boardState.setGame(boardState.game.clearRest()))}>\n          <Icon boxSize=\"small\" as={RiDeleteBack2Line} style={{ transform: 'rotate(180deg)' }} />\n          <Text ml={2} mr={1}>\n            Clear Rest of Moves\n          </Text>\n        </MenuItem>\n      </MenuList>\n    </Menu>\n  )\n}\n\nconst ClearMainGameMenu: FC = () => {\n  const { boardState, setBoardState } = useContext(BasicContext)\n  return (\n    <Menu autoSelect={false} placement=\"top\">\n      <MenuButton as={IconButton} icon={<FiXSquare />} />\n      <MenuList>\n        <MenuItem onClick={() => setBoardState(boardState.setGame(new GameState()))}>\n          <Icon boxSize=\"small\" as={FiXSquare} />\n          <Text ml={2} mr={1}>\n            Clear Game\n          </Text>\n        </MenuItem>\n      </MenuList>\n    </Menu>\n  )\n}\n\nexport default Default\n","import { ButtonGroup } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport { BasicContext, SystemContext } from '../../contexts'\nimport ConfirmBar from './ConfirmBar'\nimport EditMenu from './EditMenu'\nimport MainMenu from './MainMenu'\nimport Navigator from './Navigator'\nimport SettingsMenu from './SettingsMenu'\nimport UndoButton from './UndoButton'\n\nconst Default: FC = () => {\n  const { confirmState } = useContext(BasicContext)\n  return <>{confirmState !== undefined ? <ConfirmBar /> : <DefaultBar />}</>\n}\n\nconst DefaultBar: FC = () => {\n  const system = useContext(SystemContext)\n  return (\n    <ButtonGroup\n      width=\"100%\"\n      variant=\"ghost\"\n      justifyContent=\"space-around\"\n      alignItems=\"center\"\n      size={system.buttonSize}\n    >\n      <MainMenu />\n      <EditMenu />\n      <Navigator />\n      <UndoButton />\n      <SettingsMenu />\n    </ButtonGroup>\n  )\n}\n\nexport default Default\n","import { Stack } from '@chakra-ui/react'\nimport { FC } from 'react'\nimport Board from './Board'\nimport Controller from './Controller'\n\nconst Default: FC = () => {\n  return (\n    <Stack spacing=\"1rem\">\n      <Board />\n      <Controller />\n    </Stack>\n  )\n}\n\nexport default Default\n","import { extendTheme } from '@chakra-ui/react'\n\nconst numericStyles = {\n  '&[data-is-numeric=true]': {\n    fontFamily: 'Courier Prime',\n  },\n}\nconst theme = extendTheme({\n  components: {\n    Table: {\n      parts: ['td', 'th', 'tr'],\n      sizes: {\n        'rjn-info': {\n          th: {\n            fontSize: 'xs',\n            px: 0,\n            py: 1,\n            lineHeight: 1.2,\n          },\n          td: {\n            fontSize: 'md',\n            px: 0,\n            py: 1,\n            lineHeight: 1.2,\n          },\n        },\n      },\n      variants: {\n        'rjn-info': {\n          th: {\n            textAlign: 'center',\n          },\n          td: {\n            textAlign: 'center',\n            fontFamily: 'Noto Serif',\n            ...numericStyles,\n          },\n        },\n      },\n    },\n  },\n})\n\nexport default theme\n","import { Center, ChakraProvider, Wrap, WrapItem } from '@chakra-ui/react'\nimport { FC, useContext } from 'react'\nimport Advanced from './Advanced'\nimport './App.css'\nimport Basic from './Basic'\nimport {\n  AdvancedContextProvider,\n  BasicContextProvider,\n  PreferenceContext,\n  PreferenceContextProvider,\n  PreferenceOption,\n  SystemContext,\n  SystemContextProvider,\n} from './contexts'\nimport theme from './theme'\n\nconst Default: FC = () => {\n  return (\n    <ChakraProvider theme={theme}>\n      <SystemContextProvider>\n        <PreferenceContextProvider>\n          <Main />\n        </PreferenceContextProvider>\n      </SystemContextProvider>\n    </ChakraProvider>\n  )\n}\n\nconst Main: FC = () => {\n  const system = useContext(SystemContext)\n  const { preference } = useContext(PreferenceContext)\n  return (\n    <BasicContextProvider>\n      <Center my=\"0.5rem\">\n        <Wrap justify=\"center\">\n          <WrapItem w={system.W}>\n            <Basic />\n          </WrapItem>\n          {preference.has(PreferenceOption.advancedMode) && (\n            <WrapItem w={system.W}>\n              <AdvancedContextProvider>\n                <Advanced />\n              </AdvancedContextProvider>\n            </WrapItem>\n          )}\n        </Wrap>\n      </Center>\n    </BasicContextProvider>\n  )\n}\n\nexport default Default\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.')\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","import 'firebase/analytics'\nimport firebase from 'firebase/app'\nimport { StrictMode } from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './components/App'\nimport './index.css'\nimport * as serviceWorker from './serviceWorker'\n\nfetch('/__/firebase/init.json')\n  .then(async response => {\n    if (!response.ok) return\n    const data = await response.json().catch(() => null)\n    if (!data) return\n    firebase.initializeApp(data)\n    try { firebase.analytics() } catch {}\n  })\n  .catch(() => {})\n\nReactDOM.render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}